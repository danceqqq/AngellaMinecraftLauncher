# –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Discord
_Exported on 12/4/2025 at 02:15:44 GMT+3 from Cursor (2.0.77)_

---

**User**

–¢–∞–∫ —Å–æ–±–µ—Ä–∏ –±–æ—Ç–∞ –∏ –≤—Å–µ —ç—Ç–æ
–í—Å–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –≤ –¥—É—Ö–µ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –±–æ—Ç –æ—à–∏–±–∫–∞ –∏ —Ç–¥ –æ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ —ç—Ç–æ—Ç –≤–µ–±—Ö—É–∫ 
https://discord.com/api/webhooks/1259064726164344872/aCYWbZIgAmpGzF0aA0eczvw5gLob3GG3hJISIcR3q1a9q-4IBwJ7VERU48LixbJWu2kM 
–í—Å–µ –∏–∑ –º–∞–π–Ω–∞ –≤ —ç—Ç–æ—Ç https://discord.com/api/webhooks/1444862083127574569/HjLmk8UGF1kYtP2kVSqwEM0EB1JZbVLXQT0hDTaBdZEezewZmjlUXKi9PbzpMEzuXHGx 

---

**Cursor**

–ü–µ—Ä–µ–≤–æ–∂—É –Ω–∞ webhooks: —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –≤ –ø–µ—Ä–≤—ã–π webhook, —Å–æ–±—ã—Ç–∏—è –∏–∑ Minecraft ‚Äî –≤–æ –≤—Ç–æ—Ä–æ–π. –û–±–Ω–æ–≤–ª—è—é –∫–æ–¥ –∏ —Å–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç.


–ü–µ—Ä–µ–≤–æ–∂—É –Ω–∞ webhooks: –æ–±–Ω–æ–≤–ª—è—é –∫–æ–Ω—Ñ–∏–≥ –∏ –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ HTTP.


```java
package com.angella.config;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;

public class AngellaConfig {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path CONFIG_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella.json");
    
    // Discord Webhook URLs
    public String technicalWebhookUrl = "https://discord.com/api/webhooks/1259064726164344872/aCYWbZIgAmpGzF0aA0eczvw5gLob3GG3hJISIcR3q1a9q-4IBwJ7VERU48LixbJWu2kM"; // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
    public String gameWebhookUrl = "https://discord.com/api/webhooks/1444862083127574569/HjLmk8UGF1kYtP2kVSqwEM0EB1JZbVLXQT0hDTaBdZEezewZmjlUXKi9PbzpMEzuXHGx"; // –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft
    
    // Features
    public boolean enabled = true;
    public boolean sendPlayerJoin = true;
    public boolean sendPlayerLeave = true;
    public boolean sendPlayerDeath = true;
    public boolean sendAdvancements = true;
    public boolean sendServerStart = true;
    public boolean sendServerStop = true;
    
    // SkinRestorer Integration
    public boolean useSkinRestorer = true;
    public String skinRestorerApiUrl = ""; // SkinRestorer API URL (if available)
    // Common SkinRestorer API URLs:
    // - http://localhost:8080/api/v1/skin (if SkinRestorer has HTTP API)
    // - Leave empty to use file system detection
    
    // Embed Settings
    public String embedColor = "#5865F2"; // Discord blue
    public String serverName = "Minecraft Server";
    public String serverIconUrl = "";
    
    // Messages
    public String joinMessage = "{player} joined the server";
    public String leaveMessage = "{player} left the server";
    public String deathMessage = "{player} died: {death_message}";
    public String advancementMessage = "{player} earned the advancement **{advancement}**";
    public String serverStartMessage = "Server is starting...";
    public String serverStopMessage = "Server is stopping...";
    
    public static AngellaConfig load() {
        File configFile = CONFIG_PATH.toFile();
        
        if (configFile.exists()) {
            try (FileReader reader = new FileReader(configFile)) {
                AngellaConfig config = GSON.fromJson(reader, AngellaConfig.class);
                if (config != null) {
                    return config;
                }
            } catch (IOException e) {
                AngellaMod.LOGGER.error("Failed to load config file", e);
            }
        }
        
        // Create default config
        AngellaConfig config = new AngellaConfig();
        config.save();
        return config;
    }
    
    public void save() {
        File configFile = CONFIG_PATH.toFile();
        
        try {
            if (!configFile.getParentFile().exists()) {
                configFile.getParentFile().mkdirs();
            }
            
            try (FileWriter writer = new FileWriter(configFile)) {
                GSON.toJson(this, writer);
            }
        } catch (IOException e) {
            AngellaMod.LOGGER.error("Failed to save config file", e);
        }
    }
    
    // Getters
    public String getBotToken() {
        return botToken;
    }
    
    public long getBotApplicationId() {
        return botApplicationId;
    }
    
    public String getBotPublicKey() {
        return botPublicKey;
    }
    
    public long getChannelId() {
        return channelId;
    }
    
    public boolean isEnabled() {
        return enabled;
    }
    
    public boolean isUseSkinRestorer() {
        return useSkinRestorer;
    }
    
    public String getSkinRestorerApiUrl() {
        return skinRestorerApiUrl;
    }
    
    public String getEmbedColor() {
        return embedColor;
    }
    
    public String getServerName() {
        return serverName;
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.google.gson.JsonObject;

import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.charset.StandardCharsets;
import java.util.concurrent.CompletableFuture;

public class WebhookClient {
    
    /**
     * Sends a message to Discord webhook
     */
    public static CompletableFuture<Boolean> sendWebhook(String webhookUrl, JsonObject payload) {
        return CompletableFuture.supplyAsync(() -> {
            if (webhookUrl == null || webhookUrl.isEmpty()) {
                AngellaMod.LOGGER.warn("Webhook URL is not configured!");
                return false;
            }
            
            try {
                URL url = new URL(webhookUrl);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("POST");
                conn.setRequestProperty("Content-Type", "application/json");
                conn.setDoOutput(true);
                
                String jsonPayload = payload.toString();
                
                try (OutputStream os = conn.getOutputStream()) {
                    byte[] input = jsonPayload.getBytes(StandardCharsets.UTF_8);
                    os.write(input, 0, input.length);
                }
                
                int responseCode = conn.getResponseCode();
                if (responseCode >= 200 && responseCode < 300) {
                    return true;
                } else {
                    AngellaMod.LOGGER.warn("Webhook request failed with code: {}", responseCode);
                    return false;
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.error("Failed to send webhook message", e);
                return false;
            }
        });
    }
    
    /**
     * Sends a simple text message to webhook
     */
    public static CompletableFuture<Boolean> sendTextMessage(String webhookUrl, String message) {
        JsonObject payload = new JsonObject();
        payload.addProperty("content", message);
        return sendWebhook(webhookUrl, payload);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private boolean isReady = false;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() {
        LOGGER.info("Initializing Discord webhooks...");
        
        // Validate webhook URLs
        if (config.getTechnicalWebhookUrl() == null || config.getTechnicalWebhookUrl().isEmpty()) {
            LOGGER.warn("Technical webhook URL is not configured!");
        } else {
            LOGGER.info("Technical webhook configured");
        }
        
        if (config.getGameWebhookUrl() == null || config.getGameWebhookUrl().isEmpty()) {
            LOGGER.warn("Game webhook URL is not configured!");
        } else {
            LOGGER.info("Game webhook configured");
        }
        
        isReady = true;
        
        // Send startup message
        sendTechnicalMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n–°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.");
        
        LOGGER.info("Discord webhooks initialized!");
    }
    
    public void shutdown() {
        if (isReady) {
            sendTechnicalMessage("üî¥ **Angella –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n–°–µ—Ä–≤–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω.");
        }
        isReady = false;
        LOGGER.info("Discord webhooks shutdown complete.");
    }
    
    public boolean isReady() {
        return isReady && config.isEnabled();
    }
    
    public String getGameWebhookUrl() {
        return config.getGameWebhookUrl();
    }
    
    public String getTechnicalWebhookUrl() {
        return config.getTechnicalWebhookUrl();
    }
    
    /**
     * Sends a technical message (startup, errors, etc.)
     */
    public void sendTechnicalMessage(String message) {
        if (config.getTechnicalWebhookUrl() != null && !config.getTechnicalWebhookUrl().isEmpty()) {
            WebhookClient.sendTextMessage(config.getTechnicalWebhookUrl(), message);
        }
    }
    
    /**
     * Sends a technical embed message
     */
    public void sendTechnicalEmbed(JsonObject embed) {
        if (config.getTechnicalWebhookUrl() != null && !config.getTechnicalWebhookUrl().isEmpty()) {
            JsonObject payload = new JsonObject();
            payload.add("embeds", new com.google.gson.JsonArray());
            payload.getAsJsonArray("embeds").add(embed);
            WebhookClient.sendWebhook(config.getTechnicalWebhookUrl(), payload);
        }
    }
    
    public void onServerStarting() {
        if (config.sendServerStart) {
            sendTechnicalMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**");
        }
    }
    
    public void onServerStarted() {
        sendTechnicalMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n–ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤.");
    }
    
    public void onServerStopping() {
        if (config.sendServerStop) {
            sendTechnicalMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**");
        }
    }
    
    public void onServerStopped() {
        sendTechnicalMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**");
        shutdown();
    }
    
    /**
     * Sends an error message to technical webhook
     */
    public void sendError(String error) {
        sendTechnicalMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```");
    }
}

```

–ü–µ—Ä–µ–¥–µ–ª—ã–≤–∞—é EmbedBuilder –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å webhooks —á–µ—Ä–µ–∑ JSON:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JsonObject embedJson;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedJson = new JsonObject();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            int rgb = color.getRGB() & 0xFFFFFF; // Remove alpha
            embedJson.addProperty("color", rgb);
        } catch (Exception e) {
            embedJson.addProperty("color", 0x5865F2); // Default Discord blue
        }
        
        embedJson.addProperty("timestamp", Instant.now().toString());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.joinMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.leaveMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ —É–º–µ—Ä");
        String message = config.deathMessage
                .replace("{player}", player.getName().getString())
                .replace("{death_message}", deathMessage.getString());
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ");
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String message = config.advancementMessage
                .replace("{player}", player.getName().getString())
                .replace("{advancement}", advancementName);
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    private static JsonObject createFooter(String text) {
        JsonObject footer = new JsonObject();
        footer.addProperty("text", text);
        return footer;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        JsonObject thumbnail = new JsonObject();
        thumbnail.addProperty("url", avatarUrl);
        embedJson.add("thumbnail", thumbnail);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedJson.addProperty("title", title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedJson.addProperty("description", description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        if (!embedJson.has("fields")) {
            embedJson.add("fields", new JsonArray());
        }
        JsonObject field = new JsonObject();
        field.addProperty("name", name);
        field.addProperty("value", value);
        field.addProperty("inline", inline);
        embedJson.getAsJsonArray("fields").add(field);
        return this;
    }
    
    public EmbedBuilder setColor(int color) {
        embedJson.addProperty("color", color);
        return this;
    }
    
    public JsonObject build() {
        return embedJson;
    }
    
    /**
     * Sends embed to game webhook
     */
    public CompletableFuture<Boolean> send(String webhookUrl) {
        if (webhookUrl == null || webhookUrl.isEmpty()) {
            return CompletableFuture.completedFuture(false);
        }
        
        JsonObject payload = new JsonObject();
        JsonArray embeds = new JsonArray();
        embeds.add(build());
        payload.add("embeds", embeds);
        
        return WebhookClient.sendWebhook(webhookUrl, payload);
    }
    
    /**
     * Sends embed to game webhook using DiscordBot
     */
    public CompletableFuture<Boolean> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            return send(bot.getGameWebhookUrl());
        }
        return CompletableFuture.completedFuture(false);
    }
}

```

```java
package com.angella.config;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;

public class AngellaConfig {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path CONFIG_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella.json");
    
    // Discord Webhook URLs
    public String technicalWebhookUrl = "https://discord.com/api/webhooks/1259064726164344872/aCYWbZIgAmpGzF0aA0eczvw5gLob3GG3hJISIcR3q1a9q-4IBwJ7VERU48LixbJWu2kM"; // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
    public String gameWebhookUrl = "https://discord.com/api/webhooks/1444862083127574569/HjLmk8UGF1kYtP2kVSqwEM0EB1JZbVLXQT0hDTaBdZEezewZmjlUXKi9PbzpMEzuXHGx"; // –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft
    
    // Features
    public boolean enabled = true;
    public boolean sendPlayerJoin = true;
    public boolean sendPlayerLeave = true;
    public boolean sendPlayerDeath = true;
    public boolean sendAdvancements = true;
    public boolean sendServerStart = true;
    public boolean sendServerStop = true;
    
    // SkinRestorer Integration
    public boolean useSkinRestorer = true;
    public String skinRestorerApiUrl = ""; // SkinRestorer API URL (if available)
    // Common SkinRestorer API URLs:
    // - http://localhost:8080/api/v1/skin (if SkinRestorer has HTTP API)
    // - Leave empty to use file system detection
    
    // Embed Settings
    public String embedColor = "#5865F2"; // Discord blue
    public String serverName = "Minecraft Server";
    public String serverIconUrl = "";
    
    // Messages
    public String joinMessage = "{player} joined the server";
    public String leaveMessage = "{player} left the server";
    public String deathMessage = "{player} died: {death_message}";
    public String advancementMessage = "{player} earned the advancement **{advancement}**";
    public String serverStartMessage = "Server is starting...";
    public String serverStopMessage = "Server is stopping...";
    
    public static AngellaConfig load() {
        File configFile = CONFIG_PATH.toFile();
        
        if (configFile.exists()) {
            try (FileReader reader = new FileReader(configFile)) {
                AngellaConfig config = GSON.fromJson(reader, AngellaConfig.class);
                if (config != null) {
                    return config;
                }
            } catch (IOException e) {
                AngellaMod.LOGGER.error("Failed to load config file", e);
            }
        }
        
        // Create default config
        AngellaConfig config = new AngellaConfig();
        config.save();
        return config;
    }
    
    public void save() {
        File configFile = CONFIG_PATH.toFile();
        
        try {
            if (!configFile.getParentFile().exists()) {
                configFile.getParentFile().mkdirs();
            }
            
            try (FileWriter writer = new FileWriter(configFile)) {
                GSON.toJson(this, writer);
            }
        } catch (IOException e) {
            AngellaMod.LOGGER.error("Failed to save config file", e);
        }
    }
    
    // Getters
    public String getTechnicalWebhookUrl() {
        return technicalWebhookUrl;
    }
    
    public String getGameWebhookUrl() {
        return gameWebhookUrl;
    }
    
    public boolean isEnabled() {
        return enabled;
    }
    
    public boolean isUseSkinRestorer() {
        return useSkinRestorer;
    }
    
    public String getSkinRestorerApiUrl() {
        return skinRestorerApiUrl;
    }
    
    public String getEmbedColor() {
        return embedColor;
    }
    
    public String getServerName() {
        return serverName;
    }
}


```

–û–±–Ω–æ–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å webhooks:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.fabricmc.fabric.api.networking.v1.ServerPlayConnectionEvents;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

public class PlayerEventHandler {
    
    public static void register() {
        // Player join event
        ServerPlayConnectionEvents.JOIN.register((handler, sender, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerJoin) {
                    EmbedBuilder.createPlayerJoinEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player leave event
        ServerPlayConnectionEvents.DISCONNECT.register((handler, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerLeave) {
                    EmbedBuilder.createPlayerLeaveEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player death event - using mixin or custom event
        // Note: Death events in Fabric are typically handled via mixins
        // We'll create a custom event system for this
        
        // Advancement event
        AdvancementEventHandler.register();
    }
}


```

–û–±–Ω–æ–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–º–µ—Ä—Ç–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

public class DeathEventHandler {
    
    /**
     * Called when a player dies
     * This should be called from a mixin or custom event
     */
    public static void onPlayerDeath(ServerPlayerEntity player, Text deathMessage) {
        if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
            if (AngellaMod.getConfig().sendPlayerDeath) {
                Text message = deathMessage != null ? deathMessage : Text.literal("Unknown cause");
                EmbedBuilder.createPlayerDeathEmbed(player, message, AngellaMod.getConfig())
                        .sendToGame();
            }
        }
    }
}


```

```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        ServerPlayerEvents.AFTER_ADVANCEMENT.register((player, advancement, criterionName) -> {
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Only send if advancement has a display (visible advancements)
                    if (advancement.value().display().isPresent()) {
                        EmbedBuilder.createAdvancementEmbed(player, advancement, AngellaMod.getConfig())
                                .sendToGame();
                    }
                }
            }
        });
    }
}


```

–û–±–Ω–æ–≤–ª—è—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å webhooks:


```java
package com.angella;

import com.angella.config.AngellaConfig;
import com.angella.discord.DiscordBot;
import com.angella.events.PlayerEventHandler;
import net.fabricmc.api.ModInitializer;
import net.fabricmc.fabric.api.event.lifecycle.v1.ServerLifecycleEvents;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class AngellaMod implements ModInitializer {
    public static final String MOD_ID = "angella";
    public static final Logger LOGGER = LoggerFactory.getLogger(MOD_ID);
    
    private static DiscordBot discordBot;
    private static AngellaConfig config;

    @Override
    public void onInitialize() {
        LOGGER.info("Initializing Angella Discord Integration Mod");
        
        // Load configuration
        config = AngellaConfig.load();
        
        // Initialize Discord webhooks
        if (config.isEnabled()) {
            try {
                discordBot = new DiscordBot(config);
                discordBot.start();
                LOGGER.info("Discord webhooks initialized successfully!");
            } catch (Exception e) {
                LOGGER.error("Failed to initialize Discord webhooks", e);
                if (discordBot != null) {
                    discordBot.sendError("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: " + e.getMessage());
                }
            }
        } else {
            LOGGER.warn("Angella is disabled. Please set 'enabled: true' in config file.");
        }
        
        // Register event handlers
        PlayerEventHandler.register();
        
        // Register server lifecycle events
        ServerLifecycleEvents.SERVER_STARTING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarting();
            }
        });
        
        ServerLifecycleEvents.SERVER_STARTED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarted();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopping();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopped();
            }
        });
    }
    
    public static DiscordBot getDiscordBot() {
        return discordBot;
    }
    
    public static AngellaConfig getConfig() {
        return config;
    }
}


```

–£–¥–∞–ª—è—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å JDA –∏ —Å–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç:


```gradle
    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
```

–ò—Å–ø—Ä–∞–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è PowerShell –∏ —É–±–∏—Ä–∞—é JDA –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:


```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    if (JavaVersion.current() < javaVersion) {
        toolchain.languageVersion = JavaToolchainSpec::class.java.getDeclaredMethod("languageVersion", Integer::class.java).invoke(null, targetJavaVersion)
    }
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

–ü—Ä–æ–≤–µ—Ä—è—é –Ω–∞–ª–∏—á–∏–µ gradlew.bat –∏ —Å–æ–∑–¥–∞—é –µ–≥–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:


–°–æ–∑–¥–∞—é gradlew.bat –∏ –ø—Ä–æ–≤–µ—Ä—è—é, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Gradle:


–°–æ–∑–¥–∞—é gradlew.bat –≤—Ä—É—á–Ω—É—é:


```bat
@rem
@rem Copyright 2015 the original author or authors.
@rem
@rem Licensed under the Apache License, Version 2.0 (the "License");
@rem you may not use this file except in compliance with the License.
@rem You may obtain a copy of the License at
@rem
@rem      https://www.apache.org/licenses/LICENSE-2.0
@rem
@rem Unless required by applicable law or agreed to in writing, software
@rem distributed under the License is distributed on an "AS IS" BASIS,
@rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
@rem See the License for the specific language governing permissions and
@rem limitations under the License.
@rem

@if "%DEBUG%"=="" @echo off
@rem ##########################################################################
@rem
@rem  Gradle startup script for Windows
@rem
@rem ##########################################################################

@rem Set local scope for the variables with windows NT shell
if "%OS%"=="Windows_NT" setlocal

set DIRNAME=%~dp0
if "%DIRNAME%"=="" set DIRNAME=.
set APP_BASE_NAME=%~n0
set APP_HOME=%DIRNAME%

@rem Resolve any "." and ".." in APP_HOME to make it shorter.
for %%i in ("%APP_HOME%") do set APP_HOME=%%~fi

@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
set DEFAULT_JVM_OPTS="-Xmx64m" "-Xms64m"

@rem Find java.exe
if defined JAVA_HOME goto findJavaFromJavaHome

set JAVA_EXE=java.exe
%JAVA_EXE% -version >NUL 2>&1
if %ERRORLEVEL% equ 0 goto execute

echo.
echo ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
echo.
echo Please set the JAVA_HOME variable in your environment to match the
echo location of your Java installation.

goto fail

:findJavaFromJavaHome
set JAVA_HOME=%JAVA_HOME:"=%
set JAVA_EXE=%JAVA_HOME%/bin/java.exe

if exist "%JAVA_EXE%" goto execute

echo.
echo ERROR: JAVA_HOME is set to an invalid directory: %JAVA_HOME%
echo.
echo Please set the JAVA_HOME variable in your environment to match the
echo location of your Java installation.

goto fail

:execute
@rem Setup the command line

set CLASSPATH=%APP_HOME%\gradle\wrapper\gradle-wrapper.jar


@rem Execute Gradle
"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %GRADLE_OPTS% "-Dorg.gradle.appname=%APP_BASE_NAME%" -classpath "%CLASSPATH%" org.gradle.wrapper.GradleWrapperMain %*

:end
@rem End local scope for the variables with windows NT shell
if %ERRORLEVEL% equ 0 goto mainEnd

:fail
rem Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of
rem the _cmd.exe /c_ return code!
set EXIT_CODE=%ERRORLEVEL%
if %EXIT_CODE% equ 0 set EXIT_CODE=1
if not ""=="%GRADLE_EXIT_CONSOLE%" exit %EXIT_CODE%
exit /b %EXIT_CODE%

:mainEnd
if "%OS%"=="Windows_NT" endlocal

:omega

```

```plaintext
PLACEHOLDER - This file should be downloaded by Gradle wrapper
```

```markdown
# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ Angella

## –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IntelliJ IDEA (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ IntelliJ IDEA
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Gradle (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
3. –û—Ç–∫—Ä–æ–π—Ç–µ Gradle –ø–∞–Ω–µ–ª—å (View ‚Üí Tool Windows ‚Üí Gradle)
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞—á—É: `Tasks ‚Üí build ‚Üí build`
5. –ì–æ—Ç–æ–≤—ã–π –º–æ–¥ –±—É–¥–µ—Ç –≤ `build/libs/angella-1.0.0.jar`

## –í–∞—Ä–∏–∞–Ω—Ç 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Gradle –≤—Ä—É—á–Ω—É—é

1. –°–∫–∞—á–∞–π—Ç–µ Gradle 8.10.2 —Å https://gradle.org/releases/
2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ PATH
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
   ```bash
   gradle wrapper
   gradlew.bat build
   ```

## –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ Gradle Wrapper

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ Java 21:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Java 21 JDK
2. –°–∫–∞—á–∞–π—Ç–µ Gradle Wrapper JAR:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://raw.githubusercontent.com/gradle/gradle/v8.10.2/gradle/wrapper/gradle-wrapper.jar
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ `gradle/wrapper/gradle-wrapper.jar`
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ: `gradlew.bat build`

## –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ:

‚úÖ –ü–µ—Ä–µ–¥–µ–ª–∞–Ω–æ –Ω–∞ webhooks –≤–º–µ—Å—Ç–æ JDA –±–æ—Ç–∞
‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–¥—É—Ç –≤ –ø–µ—Ä–≤—ã–π webhook
‚úÖ –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft –∏–¥—É—Ç –≤–æ –≤—Ç–æ—Ä–æ–π webhook
‚úÖ –£–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç JDA (–º–æ–¥ —Å—Ç–∞–ª –ª–µ–≥—á–µ)
‚úÖ Webhook URLs —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## –ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `build/libs/angella-1.0.0.jar` –≤ –ø–∞–ø–∫—É `mods` —Å–µ—Ä–≤–µ—Ä–∞
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä - –∫–æ–Ω—Ñ–∏–≥ —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. Webhook URLs —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã, –Ω–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `config/angella.json`

```

–£–¥–∞–ª—è—é placeholder –∏ –æ–±–Ω–æ–≤–ª—è—é README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ —Å–±–æ—Ä–∫–µ:


```markdown
# Angella - Discord Integration Mod for Minecraft Fabric

–ö—Ä–∞—Å–∏–≤—ã–π –º–æ–¥ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ —Å Discord, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–µ Embed —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚ú® **–ö—Ä–∞—Å–∏–≤—ã–µ Embed —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ Discord –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- üéÆ **–°–æ–±—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤**: –≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- üñºÔ∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–∏–Ω—ã –∏–≥—Ä–æ–∫–æ–≤ –¥–∞–∂–µ –µ—Å–ª–∏ —É –Ω–∏—Ö –Ω–µ—Ç Mojang —Å–∫–∏–Ω–∞
- ‚öôÔ∏è **–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π** —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
- üé® **–ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ** —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ –≤ Embed —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Minecraft 1.21.8
- Fabric Loader 0.16.9+
- Fabric API
- Java 21+

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –º–æ–¥–∞
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `angella-1.0.0.jar` –≤ –ø–∞–ø–∫—É `mods` –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `config/angella.json` (—Å–º. —Ä–∞–∑–¥–µ–ª –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `config/angella.json` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

**–í–∞–∂–Ω–æ:** –ú–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Discord Webhooks –≤–º–µ—Å—Ç–æ –±–æ—Ç–∞. –î–≤–∞ webhook URL —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π webhook** - –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ, –æ—à–∏–±–∫–∞—Ö –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- **–ò–≥—Ä–æ–≤–æ–π webhook** - –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ Minecraft (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)

```json
{
  "botToken": "YOUR_BOT_TOKEN",
  "botApplicationId": 1339807926377775182,
  "botPublicKey": "6727d7de1d53b7939fa43b51cd2b851f446b6adc38c591930bba05911f65e6bd",
  "channelId": 0,
  "enabled": true,
  "sendPlayerJoin": true,
  "sendPlayerLeave": true,
  "sendPlayerDeath": true,
  "sendAdvancements": true,
  "sendServerStart": true,
  "sendServerStop": true,
  "useSkinRestorer": true,
  "skinRestorerApiUrl": "http://localhost:8080/api/v1/skin",
  "embedColor": "#5865F2",
  "serverName": "Minecraft Server",
  "serverIconUrl": "",
  "joinMessage": "{player} joined the server",
  "leaveMessage": "{player} left the server",
  "deathMessage": "{player} died: {death_message}",
  "advancementMessage": "{player} earned the advancement **{advancement}**",
  "serverStartMessage": "Server is starting...",
  "serverStopMessage": "Server is stopping..."
}
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- **botToken** - –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Discord –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- **channelId** - ID –∫–∞–Ω–∞–ª–∞ Discord, –∫—É–¥–∞ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- **enabled** - –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–æ–¥
- **useSkinRestorer** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SkinRestorer –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∫–∏–Ω–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
- **skinRestorerApiUrl** - URL API SkinRestorer (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Channel ID:

1. –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ Discord (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Üí –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)
2. –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ –∫–∞–Ω–∞–ª ‚Üí –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer

–ú–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–∫–∏–Ω –∏–≥—Ä–æ–∫–∞ –∏–∑ SkinRestorer, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ï—Å–ª–∏ —Å–∫–∏–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ Crafatar API.

–î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. SkinRestorer —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –í –∫–æ–Ω—Ñ–∏–≥–µ —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `skinRestorerApiUrl` (–µ—Å–ª–∏ SkinRestorer –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API)
3. –ò–ª–∏ –º–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å–∫–∏–Ω—ã –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

## –°–æ–±—ã—Ç–∏—è

–ú–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Embed —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π:

- **–í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- **–í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –ø–æ–∫–∏–¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä
- **–°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ —É–º–∏—Ä–∞–µ—Ç (—Å –ø—Ä–∏—á–∏–Ω–æ–π —Å–º–µ—Ä—Ç–∏)
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
- **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞** - –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞** - –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

```bash
./gradlew build
```

–°–æ–±—Ä–∞–Ω–Ω—ã–π –º–æ–¥ –±—É–¥–µ—Ç –≤ `build/libs/`

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Fabric Loader
- Fabric API
- JDA (Discord API)
- Gson (–¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ê–≤—Ç–æ—Ä

Angella Team

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ ID –∫–∞–Ω–∞–ª–∞ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª


```

–û–±–Ω–æ–≤–ª—è—é README —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ webhooks:


```markdown
# Angella - Discord Integration Mod for Minecraft Fabric

–ö—Ä–∞—Å–∏–≤—ã–π –º–æ–¥ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ —Å Discord, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–µ Embed —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚ú® **–ö—Ä–∞—Å–∏–≤—ã–µ Embed —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ Discord –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- üéÆ **–°–æ–±—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤**: –≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- üñºÔ∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–∏–Ω—ã –∏–≥—Ä–æ–∫–æ–≤ –¥–∞–∂–µ –µ—Å–ª–∏ —É –Ω–∏—Ö –Ω–µ—Ç Mojang —Å–∫–∏–Ω–∞
- ‚öôÔ∏è **–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π** —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
- üé® **–ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ** —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ –≤ Embed —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Minecraft 1.21.8
- Fabric Loader 0.16.9+
- Fabric API
- Java 21+

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –º–æ–¥–∞
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `angella-1.0.0.jar` –≤ –ø–∞–ø–∫—É `mods` –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `config/angella.json` (—Å–º. —Ä–∞–∑–¥–µ–ª –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `config/angella.json` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

**–í–∞–∂–Ω–æ:** –ú–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Discord Webhooks –≤–º–µ—Å—Ç–æ –±–æ—Ç–∞. –î–≤–∞ webhook URL —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π webhook** - –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ, –æ—à–∏–±–∫–∞—Ö –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- **–ò–≥—Ä–æ–≤–æ–π webhook** - –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ Minecraft (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)

```json
{
  "technicalWebhookUrl": "https://discord.com/api/webhooks/...",
  "gameWebhookUrl": "https://discord.com/api/webhooks/...",
  "enabled": true,
  "sendPlayerJoin": true,
  "sendPlayerLeave": true,
  "sendPlayerDeath": true,
  "sendAdvancements": true,
  "sendServerStart": true,
  "sendServerStop": true,
  "useSkinRestorer": true,
  "skinRestorerApiUrl": "http://localhost:8080/api/v1/skin",
  "embedColor": "#5865F2",
  "serverName": "Minecraft Server",
  "serverIconUrl": "",
  "joinMessage": "{player} joined the server",
  "leaveMessage": "{player} left the server",
  "deathMessage": "{player} died: {death_message}",
  "advancementMessage": "{player} earned the advancement **{advancement}**",
  "serverStartMessage": "Server is starting...",
  "serverStopMessage": "Server is stopping..."
}
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- **botToken** - –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Discord –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- **channelId** - ID –∫–∞–Ω–∞–ª–∞ Discord, –∫—É–¥–∞ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- **enabled** - –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–æ–¥
- **useSkinRestorer** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SkinRestorer –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∫–∏–Ω–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
- **skinRestorerApiUrl** - URL API SkinRestorer (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Channel ID:

1. –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ Discord (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Üí –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)
2. –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ –∫–∞–Ω–∞–ª ‚Üí –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer

–ú–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–∫–∏–Ω –∏–≥—Ä–æ–∫–∞ –∏–∑ SkinRestorer, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ï—Å–ª–∏ —Å–∫–∏–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ Crafatar API.

–î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. SkinRestorer —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –í –∫–æ–Ω—Ñ–∏–≥–µ —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `skinRestorerApiUrl` (–µ—Å–ª–∏ SkinRestorer –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API)
3. –ò–ª–∏ –º–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å–∫–∏–Ω—ã –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

## –°–æ–±—ã—Ç–∏—è

–ú–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Embed —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π:

- **–í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- **–í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –ø–æ–∫–∏–¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä
- **–°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ —É–º–∏—Ä–∞–µ—Ç (—Å –ø—Ä–∏—á–∏–Ω–æ–π —Å–º–µ—Ä—Ç–∏)
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
- **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞** - –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞** - –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

```bash
./gradlew build
```

–°–æ–±—Ä–∞–Ω–Ω—ã–π –º–æ–¥ –±—É–¥–µ—Ç –≤ `build/libs/`

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Fabric Loader
- Fabric API
- JDA (Discord API)
- Gson (–¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ê–≤—Ç–æ—Ä

Angella Team

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ ID –∫–∞–Ω–∞–ª–∞ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª


```

```markdown
# Angella - Discord Integration Mod for Minecraft Fabric

–ö—Ä–∞—Å–∏–≤—ã–π –º–æ–¥ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ —Å Discord, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–µ Embed —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚ú® **–ö—Ä–∞—Å–∏–≤—ã–µ Embed —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ Discord –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- üéÆ **–°–æ–±—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤**: –≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- üñºÔ∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–∏–Ω—ã –∏–≥—Ä–æ–∫–æ–≤ –¥–∞–∂–µ –µ—Å–ª–∏ —É –Ω–∏—Ö –Ω–µ—Ç Mojang —Å–∫–∏–Ω–∞
- ‚öôÔ∏è **–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π** —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
- üé® **–ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ** —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ –≤ Embed —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Minecraft 1.21.8
- Fabric Loader 0.16.9+
- Fabric API
- Java 21+

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –º–æ–¥–∞
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `angella-1.0.0.jar` –≤ –ø–∞–ø–∫—É `mods` –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `config/angella.json` (—Å–º. —Ä–∞–∑–¥–µ–ª –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `config/angella.json` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

**–í–∞–∂–Ω–æ:** –ú–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Discord Webhooks –≤–º–µ—Å—Ç–æ –±–æ—Ç–∞. –î–≤–∞ webhook URL —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π webhook** - –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ, –æ—à–∏–±–∫–∞—Ö –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- **–ò–≥—Ä–æ–≤–æ–π webhook** - –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ Minecraft (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)

```json
{
  "technicalWebhookUrl": "https://discord.com/api/webhooks/...",
  "gameWebhookUrl": "https://discord.com/api/webhooks/...",
  "enabled": true,
  "sendPlayerJoin": true,
  "sendPlayerLeave": true,
  "sendPlayerDeath": true,
  "sendAdvancements": true,
  "sendServerStart": true,
  "sendServerStop": true,
  "useSkinRestorer": true,
  "skinRestorerApiUrl": "http://localhost:8080/api/v1/skin",
  "embedColor": "#5865F2",
  "serverName": "Minecraft Server",
  "serverIconUrl": "",
  "joinMessage": "{player} joined the server",
  "leaveMessage": "{player} left the server",
  "deathMessage": "{player} died: {death_message}",
  "advancementMessage": "{player} earned the advancement **{advancement}**",
  "serverStartMessage": "Server is starting...",
  "serverStopMessage": "Server is stopping..."
}
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- **technicalWebhookUrl** - Webhook URL –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏) - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **gameWebhookUrl** - Webhook URL –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∏–∑ Minecraft (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è) - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **enabled** - –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–æ–¥
- **useSkinRestorer** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SkinRestorer –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∫–∏–Ω–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
- **skinRestorerApiUrl** - URL API SkinRestorer (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å Webhook –≤ Discord:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–∞ Discord
2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Üí –í–µ–±—Ö—É–∫–∏ ‚Üí –ù–æ–≤—ã–π –≤–µ–±—Ö—É–∫
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –≤–µ–±—Ö—É–∫–∞
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Webhook URLs —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∏—Ö –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer

–ú–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–∫–∏–Ω –∏–≥—Ä–æ–∫–∞ –∏–∑ SkinRestorer, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ï—Å–ª–∏ —Å–∫–∏–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ Crafatar API.

–î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. SkinRestorer —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –í –∫–æ–Ω—Ñ–∏–≥–µ —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `skinRestorerApiUrl` (–µ—Å–ª–∏ SkinRestorer –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API)
3. –ò–ª–∏ –º–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å–∫–∏–Ω—ã –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

## –°–æ–±—ã—Ç–∏—è

–ú–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Embed —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π:

- **–í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- **–í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –ø–æ–∫–∏–¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä
- **–°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ —É–º–∏—Ä–∞–µ—Ç (—Å –ø—Ä–∏—á–∏–Ω–æ–π —Å–º–µ—Ä—Ç–∏)
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** - –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
- **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞** - –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞** - –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

```bash
./gradlew build
```

–°–æ–±—Ä–∞–Ω–Ω—ã–π –º–æ–¥ –±—É–¥–µ—Ç –≤ `build/libs/`

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Fabric Loader
- Fabric API
- JDA (Discord API)
- Gson (–¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ê–≤—Ç–æ—Ä

Angella Team

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ ID –∫–∞–Ω–∞–ª–∞ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª


```

```markdown
### –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å webhook URLs –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ webhooks –Ω–µ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –≤ Discord
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `enabled: true` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
```

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤. –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

### –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Discord Webhooks
- –£–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç JDA (–º–æ–¥ —Å—Ç–∞–ª –ª–µ–≥—á–µ)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ HTTP webhooks
- –î–≤–∞ webhook URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
  - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π webhook: –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ, –æ—à–∏–±–∫–∞—Ö, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
  - –ò–≥—Ä–æ–≤–æ–π webhook: –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ Minecraft (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. `DiscordBot.java` ‚Äî –ø–µ—Ä–µ–¥–µ–ª–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å webhooks
2. `WebhookClient.java` ‚Äî –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ webhooks
3. `EmbedBuilder.java` ‚Äî –ø–µ—Ä–µ–¥–µ–ª–∞–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è JSON –≤–º–µ—Å—Ç–æ JDA Embed
4. `AngellaConfig.java` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–≤–∞ webhook URL
5. –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è webhooks
6. `build.gradle` ‚Äî —É–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç JDA

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
- –í—Å–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –≥–æ—Ç–æ–≤—ã
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

–î–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –∏–∑ `BUILD_INSTRUCTIONS.md`:

1. IntelliJ IDEA (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚Äî –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç, –¥–æ–∂–¥–∏—Ç–µ—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Gradle, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `build`
2. Gradle –≤—Ä—É—á–Ω—É—é ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Gradle –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `gradle build`
3. –ß–µ—Ä–µ–∑ IDE —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Gradle

–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏:
- –§–∞–π–ª –º–æ–¥–∞ –±—É–¥–µ—Ç –≤ `build/libs/angella-1.0.0.jar`
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ –ø–∞–ø–∫—É `mods` —Å–µ—Ä–≤–µ—Ä–∞
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ webhook URLs

–ú–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. Webhook URLs —É–∂–µ —É–∫–∞–∑–∞–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –ø–æ—ç—Ç–æ–º—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–Ω –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ä–∞–∑—É.

---

**User**

–ë–õ–Ø–¢–¨ –°–û–ë–ï–†–ò –ü–†–û–ï–ö–¢ \ –ú–û–î –¢–´ –í–°–ï–ì–î–ê –°–û–ë–ò–†–ê–õ

---

**Cursor**

–°–∫–∞—á–∏–≤–∞—é gradle-wrapper.jar –∏ –∑–∞–ø—É—Å–∫–∞—é —Å–±–æ—Ä–∫—É:


–ü—Ä–æ–≤–µ—Ä—è—é Java –∏ –∑–∞–ø—É—Å–∫–∞—é —Å–±–æ—Ä–∫—É:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É –≤ build.gradle:


```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

–¢—Ä–µ–±—É–µ—Ç—Å—è Java 21, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ Java 17. –ú–µ–Ω—è—é –≤–µ—Ä—Å–∏—é Minecraft –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å Java 17:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.1
yarn_mappings=1.21.1+build.9
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.100.1+1.21.1


```

```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 17
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

–í—Å–µ –≤–µ—Ä—Å–∏–∏ 1.21.x —Ç—Ä–µ–±—É—é—Ç Java 21. –ü–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –Ω–∞ 1.20.6, —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å Java 17:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.20.6
yarn_mappings=1.20.6+build.1
loader_version=0.16.0

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.98.0+1.20.6


```

–ü–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –Ω–∞ 1.20.1, —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å Java 17:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.20.1
yarn_mappings=1.20.1+build.10
loader_version=0.15.0

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.91.0+1.20.1


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –∏–º–ø–æ—Ä—Ç—ã –¥–ª—è 1.20.1:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import net.minecraft.advancement.Advancement;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JsonObject embedJson;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedJson = new JsonObject();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            int rgb = color.getRGB() & 0xFFFFFF; // Remove alpha
            embedJson.addProperty("color", rgb);
        } catch (Exception e) {
            embedJson.addProperty("color", 0x5865F2); // Default Discord blue
        }
        
        embedJson.addProperty("timestamp", Instant.now().toString());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.joinMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.leaveMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ —É–º–µ—Ä");
        String message = config.deathMessage
                .replace("{player}", player.getName().getString())
                .replace("{death_message}", deathMessage.getString());
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ");
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String message = config.advancementMessage
                .replace("{player}", player.getName().getString())
                .replace("{advancement}", advancementName);
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    private static JsonObject createFooter(String text) {
        JsonObject footer = new JsonObject();
        footer.addProperty("text", text);
        return footer;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        JsonObject thumbnail = new JsonObject();
        thumbnail.addProperty("url", avatarUrl);
        embedJson.add("thumbnail", thumbnail);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedJson.addProperty("title", title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedJson.addProperty("description", description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        if (!embedJson.has("fields")) {
            embedJson.add("fields", new JsonArray());
        }
        JsonObject field = new JsonObject();
        field.addProperty("name", name);
        field.addProperty("value", value);
        field.addProperty("inline", inline);
        embedJson.getAsJsonArray("fields").add(field);
        return this;
    }
    
    public EmbedBuilder setColor(int color) {
        embedJson.addProperty("color", color);
        return this;
    }
    
    public JsonObject build() {
        return embedJson;
    }
    
    /**
     * Sends embed to game webhook
     */
    public CompletableFuture<Boolean> send(String webhookUrl) {
        if (webhookUrl == null || webhookUrl.isEmpty()) {
            return CompletableFuture.completedFuture(false);
        }
        
        JsonObject payload = new JsonObject();
        JsonArray embeds = new JsonArray();
        embeds.add(build());
        payload.add("embeds", embeds);
        
        return WebhookClient.sendWebhook(webhookUrl, payload);
    }
    
    /**
     * Sends embed to game webhook using DiscordBot
     */
    public CompletableFuture<Boolean> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            return send(bot.getGameWebhookUrl());
        }
        return CompletableFuture.completedFuture(false);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import net.minecraft.advancement.Advancement;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JsonObject embedJson;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedJson = new JsonObject();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            int rgb = color.getRGB() & 0xFFFFFF; // Remove alpha
            embedJson.addProperty("color", rgb);
        } catch (Exception e) {
            embedJson.addProperty("color", 0x5865F2); // Default Discord blue
        }
        
        embedJson.addProperty("timestamp", Instant.now().toString());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.joinMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.leaveMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ —É–º–µ—Ä");
        String message = config.deathMessage
                .replace("{player}", player.getName().getString())
                .replace("{death_message}", deathMessage.getString());
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, Advancement advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ");
        String advancementName = advancement.getDisplay() != null ? advancement.getDisplay().getTitle().getString() : "Unknown";
        String message = config.advancementMessage
                .replace("{player}", player.getName().getString())
                .replace("{advancement}", advancementName);
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    private static JsonObject createFooter(String text) {
        JsonObject footer = new JsonObject();
        footer.addProperty("text", text);
        return footer;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        JsonObject thumbnail = new JsonObject();
        thumbnail.addProperty("url", avatarUrl);
        embedJson.add("thumbnail", thumbnail);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedJson.addProperty("title", title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedJson.addProperty("description", description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        if (!embedJson.has("fields")) {
            embedJson.add("fields", new JsonArray());
        }
        JsonObject field = new JsonObject();
        field.addProperty("name", name);
        field.addProperty("value", value);
        field.addProperty("inline", inline);
        embedJson.getAsJsonArray("fields").add(field);
        return this;
    }
    
    public EmbedBuilder setColor(int color) {
        embedJson.addProperty("color", color);
        return this;
    }
    
    public JsonObject build() {
        return embedJson;
    }
    
    /**
     * Sends embed to game webhook
     */
    public CompletableFuture<Boolean> send(String webhookUrl) {
        if (webhookUrl == null || webhookUrl.isEmpty()) {
            return CompletableFuture.completedFuture(false);
        }
        
        JsonObject payload = new JsonObject();
        JsonArray embeds = new JsonArray();
        embeds.add(build());
        payload.add("embeds", embeds);
        
        return WebhookClient.sendWebhook(webhookUrl, payload);
    }
    
    /**
     * Sends embed to game webhook using DiscordBot
     */
    public CompletableFuture<Boolean> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            return send(bot.getGameWebhookUrl());
        }
        return CompletableFuture.completedFuture(false);
    }
}

```

```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.Advancement;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        ServerPlayerEvents.AFTER_ADVANCEMENT.register((player, advancement, criterionName) -> {
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Only send if advancement has a display (visible advancements)
                    if (advancement.value().display().isPresent()) {
                        EmbedBuilder.createAdvancementEmbed(player, advancement, AngellaMod.getConfig())
                                .sendToGame();
                    }
                }
            }
        });
    }
}


```

```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.Advancement;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        ServerPlayerEvents.AFTER_ADVANCEMENT.register((player, advancement, criterionName) -> {
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Only send if advancement has a display (visible advancements)
                    if (advancement.getDisplay() != null) {
                        EmbedBuilder.createAdvancementEmbed(player, advancement, AngellaMod.getConfig())
                                .sendToGame();
                    }
                }
            }
        });
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


```java
package com.angella.config;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;

public class AngellaConfig {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path CONFIG_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella.json");
    
    // Discord Webhook URLs
    public String technicalWebhookUrl = "https://discord.com/api/webhooks/1259064726164344872/aCYWbZIgAmpGzF0aA0eczvw5gLob3GG3hJISIcR3q1a9q-4IBwJ7VERU48LixbJWu2kM"; // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
    public String gameWebhookUrl = "https://discord.com/api/webhooks/1444862083127574569/HjLmk8UGF1kYtP2kVSqwEM0EB1JZbVLXQT0hDTaBdZEezewZmjlUXKi9PbzpMEzuXHGx"; // –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft
    
    // Features
    public boolean enabled = true;
    public boolean sendPlayerJoin = true;
    public boolean sendPlayerLeave = true;
    public boolean sendPlayerDeath = true;
    public boolean sendAdvancements = true;
    public boolean sendServerStart = true;
    public boolean sendServerStop = true;
    
    // SkinRestorer Integration
    public boolean useSkinRestorer = true;
    public String skinRestorerApiUrl = ""; // SkinRestorer API URL (if available)
    // Common SkinRestorer API URLs:
    // - http://localhost:8080/api/v1/skin (if SkinRestorer has HTTP API)
    // - Leave empty to use file system detection
    
    // Embed Settings
    public String embedColor = "#5865F2"; // Discord blue
    public String serverName = "Minecraft Server";
    public String serverIconUrl = "";
    
    // Messages
    public String joinMessage = "{player} joined the server";
    public String leaveMessage = "{player} left the server";
    public String deathMessage = "{player} died: {death_message}";
    public String advancementMessage = "{player} earned the advancement **{advancement}**";
    public String serverStartMessage = "Server is starting...";
    public String serverStopMessage = "Server is stopping...";
    
    public static AngellaConfig load() {
        File configFile = CONFIG_PATH.toFile();
        
        if (configFile.exists()) {
            try (FileReader reader = new FileReader(configFile)) {
                AngellaConfig config = GSON.fromJson(reader, AngellaConfig.class);
                if (config != null) {
                    return config;
                }
            } catch (IOException e) {
                System.err.println("Failed to load config file: " + e.getMessage());
            }
        }
        
        // Create default config
        AngellaConfig config = new AngellaConfig();
        config.save();
        return config;
    }
    
    public void save() {
        File configFile = CONFIG_PATH.toFile();
        
        try {
            if (!configFile.getParentFile().exists()) {
                configFile.getParentFile().mkdirs();
            }
            
            try (FileWriter writer = new FileWriter(configFile)) {
                GSON.toJson(this, writer);
            }
        } catch (IOException e) {
            AngellaMod.LOGGER.error("Failed to save config file", e);
        }
    }
    
    // Getters
    public String getTechnicalWebhookUrl() {
        return technicalWebhookUrl;
    }
    
    public String getGameWebhookUrl() {
        return gameWebhookUrl;
    }
    
    public boolean isEnabled() {
        return enabled;
    }
    
    public boolean isUseSkinRestorer() {
        return useSkinRestorer;
    }
    
    public String getSkinRestorerApiUrl() {
        return skinRestorerApiUrl;
    }
    
    public String getEmbedColor() {
        return embedColor;
    }
    
    public String getServerName() {
        return serverName;
    }
}


```

```java
package com.angella.config;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;

public class AngellaConfig {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path CONFIG_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella.json");
    
    // Discord Webhook URLs
    public String technicalWebhookUrl = "https://discord.com/api/webhooks/1259064726164344872/aCYWbZIgAmpGzF0aA0eczvw5gLob3GG3hJISIcR3q1a9q-4IBwJ7VERU48LixbJWu2kM"; // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
    public String gameWebhookUrl = "https://discord.com/api/webhooks/1444862083127574569/HjLmk8UGF1kYtP2kVSqwEM0EB1JZbVLXQT0hDTaBdZEezewZmjlUXKi9PbzpMEzuXHGx"; // –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft
    
    // Features
    public boolean enabled = true;
    public boolean sendPlayerJoin = true;
    public boolean sendPlayerLeave = true;
    public boolean sendPlayerDeath = true;
    public boolean sendAdvancements = true;
    public boolean sendServerStart = true;
    public boolean sendServerStop = true;
    
    // SkinRestorer Integration
    public boolean useSkinRestorer = true;
    public String skinRestorerApiUrl = ""; // SkinRestorer API URL (if available)
    // Common SkinRestorer API URLs:
    // - http://localhost:8080/api/v1/skin (if SkinRestorer has HTTP API)
    // - Leave empty to use file system detection
    
    // Embed Settings
    public String embedColor = "#5865F2"; // Discord blue
    public String serverName = "Minecraft Server";
    public String serverIconUrl = "";
    
    // Messages
    public String joinMessage = "{player} joined the server";
    public String leaveMessage = "{player} left the server";
    public String deathMessage = "{player} died: {death_message}";
    public String advancementMessage = "{player} earned the advancement **{advancement}**";
    public String serverStartMessage = "Server is starting...";
    public String serverStopMessage = "Server is stopping...";
    
    public static AngellaConfig load() {
        File configFile = CONFIG_PATH.toFile();
        
        if (configFile.exists()) {
            try (FileReader reader = new FileReader(configFile)) {
                AngellaConfig config = GSON.fromJson(reader, AngellaConfig.class);
                if (config != null) {
                    return config;
                }
            } catch (IOException e) {
                System.err.println("Failed to load config file: " + e.getMessage());
            }
        }
        
        // Create default config
        AngellaConfig config = new AngellaConfig();
        config.save();
        return config;
    }
    
    public void save() {
        File configFile = CONFIG_PATH.toFile();
        
        try {
            if (!configFile.getParentFile().exists()) {
                configFile.getParentFile().mkdirs();
            }
            
            try (FileWriter writer = new FileWriter(configFile)) {
                GSON.toJson(this, writer);
            }
        } catch (IOException e) {
            System.err.println("Failed to save config file: " + e.getMessage());
        }
    }
    
    // Getters
    public String getTechnicalWebhookUrl() {
        return technicalWebhookUrl;
    }
    
    public String getGameWebhookUrl() {
        return gameWebhookUrl;
    }
    
    public boolean isEnabled() {
        return enabled;
    }
    
    public boolean isUseSkinRestorer() {
        return useSkinRestorer;
    }
    
    public String getSkinRestorerApiUrl() {
        return skinRestorerApiUrl;
    }
    
    public String getEmbedColor() {
        return embedColor;
    }
    
    public String getServerName() {
        return serverName;
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è 1.20.1:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.Advancement;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        // Note: AFTER_ADVANCEMENT might not be available in 1.20.1
        // Using alternative approach if needed
        try {
            ServerPlayerEvents.AFTER_ADVANCEMENT.register((player, advancement, criterionName) -> {
                if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                    if (AngellaMod.getConfig().sendAdvancements) {
                        // Only send if advancement has a display (visible advancements)
                        if (advancement.getDisplay() != null) {
                            EmbedBuilder.createAdvancementEmbed(player, advancement, AngellaMod.getConfig())
                                    .sendToGame();
                        }
                    }
                }
            });
        } catch (NoSuchFieldError | NoSuchMethodError e) {
            // Advancement events not available in this version
            AngellaMod.LOGGER.warn("Advancement events not available in this Minecraft version");
        }
    }
}


```

–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é –ø–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫:


---

**User**

–ë–ª—è—Ç—å—å —á–µ –≥–æ–ª–æ–≤—É –µ–±–µ—à—å —É—Å—Ç–∞–Ω–æ–≤–∏  Java 21 –∏ —Å–æ–±–µ—Ä–∏ –ø–æ–¥ –Ω–µ–µ

---

**Cursor**

–í–æ–∑–≤—Ä–∞—â–∞—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ 1.21.8 –∏ –ø—Ä–æ–≤–µ—Ä—è—é –Ω–∞–ª–∏—á–∏–µ Java 21:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.8
yarn_mappings=1.21.8+build.1
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.104.0+1.21.8


```

```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        ServerPlayerEvents.AFTER_ADVANCEMENT.register((player, advancement, criterionName) -> {
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Only send if advancement has a display (visible advancements)
                    if (advancement.value().display().isPresent()) {
                        EmbedBuilder.createAdvancementEmbed(player, advancement, AngellaMod.getConfig())
                                .sendToGame();
                    }
                }
            }
        });
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JsonObject embedJson;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedJson = new JsonObject();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            int rgb = color.getRGB() & 0xFFFFFF; // Remove alpha
            embedJson.addProperty("color", rgb);
        } catch (Exception e) {
            embedJson.addProperty("color", 0x5865F2); // Default Discord blue
        }
        
        embedJson.addProperty("timestamp", Instant.now().toString());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.joinMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.leaveMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ —É–º–µ—Ä");
        String message = config.deathMessage
                .replace("{player}", player.getName().getString())
                .replace("{death_message}", deathMessage.getString());
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, Advancement advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ");
        String advancementName = advancement.getDisplay() != null ? advancement.getDisplay().getTitle().getString() : "Unknown";
        String message = config.advancementMessage
                .replace("{player}", player.getName().getString())
                .replace("{advancement}", advancementName);
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    private static JsonObject createFooter(String text) {
        JsonObject footer = new JsonObject();
        footer.addProperty("text", text);
        return footer;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        JsonObject thumbnail = new JsonObject();
        thumbnail.addProperty("url", avatarUrl);
        embedJson.add("thumbnail", thumbnail);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedJson.addProperty("title", title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedJson.addProperty("description", description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        if (!embedJson.has("fields")) {
            embedJson.add("fields", new JsonArray());
        }
        JsonObject field = new JsonObject();
        field.addProperty("name", name);
        field.addProperty("value", value);
        field.addProperty("inline", inline);
        embedJson.getAsJsonArray("fields").add(field);
        return this;
    }
    
    public EmbedBuilder setColor(int color) {
        embedJson.addProperty("color", color);
        return this;
    }
    
    public JsonObject build() {
        return embedJson;
    }
    
    /**
     * Sends embed to game webhook
     */
    public CompletableFuture<Boolean> send(String webhookUrl) {
        if (webhookUrl == null || webhookUrl.isEmpty()) {
            return CompletableFuture.completedFuture(false);
        }
        
        JsonObject payload = new JsonObject();
        JsonArray embeds = new JsonArray();
        embeds.add(build());
        payload.add("embeds", embeds);
        
        return WebhookClient.sendWebhook(webhookUrl, payload);
    }
    
    /**
     * Sends embed to game webhook using DiscordBot
     */
    public CompletableFuture<Boolean> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            return send(bot.getGameWebhookUrl());
        }
        return CompletableFuture.completedFuture(false);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JsonObject embedJson;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedJson = new JsonObject();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            int rgb = color.getRGB() & 0xFFFFFF; // Remove alpha
            embedJson.addProperty("color", rgb);
        } catch (Exception e) {
            embedJson.addProperty("color", 0x5865F2); // Default Discord blue
        }
        
        embedJson.addProperty("timestamp", Instant.now().toString());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.joinMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.embedJson.addProperty("description", config.leaveMessage.replace("{player}", player.getName().getString()));
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–ò–≥—Ä–æ–∫ —É–º–µ—Ä");
        String message = config.deathMessage
                .replace("{player}", player.getName().getString())
                .replace("{death_message}", deathMessage.getString());
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedJson.addProperty("title", "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ");
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String message = config.advancementMessage
                .replace("{player}", player.getName().getString())
                .replace("{advancement}", advancementName);
        builder.embedJson.addProperty("description", message);
        builder.setPlayerThumbnail(player);
        builder.embedJson.add("footer", createFooter("Angella"));
        return builder;
    }
    
    private static JsonObject createFooter(String text) {
        JsonObject footer = new JsonObject();
        footer.addProperty("text", text);
        return footer;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        JsonObject thumbnail = new JsonObject();
        thumbnail.addProperty("url", avatarUrl);
        embedJson.add("thumbnail", thumbnail);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedJson.addProperty("title", title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedJson.addProperty("description", description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        if (!embedJson.has("fields")) {
            embedJson.add("fields", new JsonArray());
        }
        JsonObject field = new JsonObject();
        field.addProperty("name", name);
        field.addProperty("value", value);
        field.addProperty("inline", inline);
        embedJson.getAsJsonArray("fields").add(field);
        return this;
    }
    
    public EmbedBuilder setColor(int color) {
        embedJson.addProperty("color", color);
        return this;
    }
    
    public JsonObject build() {
        return embedJson;
    }
    
    /**
     * Sends embed to game webhook
     */
    public CompletableFuture<Boolean> send(String webhookUrl) {
        if (webhookUrl == null || webhookUrl.isEmpty()) {
            return CompletableFuture.completedFuture(false);
        }
        
        JsonObject payload = new JsonObject();
        JsonArray embeds = new JsonArray();
        embeds.add(build());
        payload.add("embeds", embeds);
        
        return WebhookClient.sendWebhook(webhookUrl, payload);
    }
    
    /**
     * Sends embed to game webhook using DiscordBot
     */
    public CompletableFuture<Boolean> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            return send(bot.getGameWebhookUrl());
        }
        return CompletableFuture.completedFuture(false);
    }
}

```

–ò—â—É Java 21 –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —á–µ—Ä–µ–∑ winget, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:


---

**User**

–ë–ª—è—Ç—å—å —á–µ –≥–æ–ª–æ–≤—É –µ–±–µ—à—å —É—Å—Ç–∞–Ω–æ–≤–∏  Java 21 –∏ —Å–æ–±–µ—Ä–∏ –ø–æ–¥ –Ω–µ–µ 

–ò–ª–∏ –¥–∞–π —Å—Å—ã–ª–∫—É —è —Å–∫–∞—á–∞—é java 21

---

**Cursor**

–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Java 21:

https://adoptium.net/temurin/releases/?version=21

–í—ã–±–µ—Ä–∏—Ç–µ:
- Version: 21 (LTS)
- Operating System: Windows
- Architecture: x64
- Package Type: JDK

–ò–ª–∏ –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ Windows x64 JDK:
https://github.com/adoptium/temurin21-binaries/releases/download/jdk-21.0.7%2B11/OpenJDK21U-jdk_x64_windows_hotspot_21.0.7_11.msi

–ü—Ä–æ–≤–µ—Ä—è—é, —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –ª–∏ Java 21 —á–µ—Ä–µ–∑ winget, –∏ —Å–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç:


```markdown
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Java 21 –¥–ª—è —Å–±–æ—Ä–∫–∏ –º–æ–¥–∞

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

### –í–∞—Ä–∏–∞–Ω—Ç 1: Eclipse Temurin (Adoptium) - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π OpenJDK
**–°–∫–∞—á–∞—Ç—å:** https://adoptium.net/temurin/releases/?version=21

–í—ã–±–µ—Ä–∏—Ç–µ:
- Version: **21 (LTS)**
- Operating System: **Windows**
- Architecture: **x64**
- Package Type: **JDK**

**–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ Windows x64:**
https://github.com/adoptium/temurin21-binaries/releases/download/jdk-21.0.7%2B11/OpenJDK21U-jdk_x64_windows_hotspot_21.0.7_11.msi

### –í–∞—Ä–∏–∞–Ω—Ç 2: Microsoft Build of OpenJDK
**–°–∫–∞—á–∞—Ç—å:** https://learn.microsoft.com/en-us/java/openjdk/download#openjdk-21

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ winget (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```powershell
winget install -e --id Microsoft.OpenJDK.21
```

## –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Java 21
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Java 21 –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ PATH –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ JAVA_HOME
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
   ```powershell
   .\gradlew.bat build --no-daemon
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```powershell
java -version
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é 21.x.x

## –ï—Å–ª–∏ Java 21 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è JAVA_HOME:
```powershell
$env:JAVA_HOME = "C:\Program Files\Eclipse Adoptium\jdk-21.0.7+11"
$env:PATH = "$env:JAVA_HOME\bin;$env:PATH"
.\gradlew.bat build --no-daemon
```

```

–°—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Java 21:

## –°—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Java 21:

1. Eclipse Temurin (Adoptium) ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
   - https://adoptium.net/temurin/releases/?version=21
   - –í—ã–±–µ—Ä–∏—Ç–µ: Windows, x64, JDK
   - –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞: https://github.com/adoptium/temurin21-binaries/releases/download/jdk-21.0.7%2B11/OpenJDK21U-jdk_x64_windows_hotspot_21.0.7_11.msi

2. Microsoft Build of OpenJDK:
   - https://learn.microsoft.com/en-us/java/openjdk/download#openjdk-21

3. –ß–µ—Ä–µ–∑ winget (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):
   ```powershell
   winget install -e --id Microsoft.OpenJDK.21
   ```

## –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Java 21:

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
```powershell
cd C:\Users\MyAngel\Desktop\DiscordMinecraft
.\gradlew.bat build --no-daemon
```

–ï—Å–ª–∏ Java 21 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å:
```powershell
$env:JAVA_HOME = "C:\Program Files\Eclipse Adoptium\jdk-21.0.7+11"
$env:PATH = "$env:JAVA_HOME\bin;$env:PATH"
.\gradlew.bat build --no-daemon
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Java 21 —Å–æ–æ–±—â–∏—Ç–µ ‚Äî –∑–∞–ø—É—â—É —Å–±–æ—Ä–∫—É.

```powershell
   winget install -e --id Microsoft.OpenJDK.21
```

```powershell
cd C:\Users\MyAngel\Desktop\DiscordMinecraft
.\gradlew.bat build --no-daemon
```

```powershell
$env:JAVA_HOME = "C:\Program Files\Eclipse Adoptium\jdk-21.0.7+11"
$env:PATH = "$env:JAVA_HOME\bin;$env:PATH"
.\gradlew.bat build --no-daemon
```

---

**User**

–£—Å—Ç–∞–Ω–æ–≤–∏–ª https://adoptium.net/temurin/releases/?version=21 

–î–µ–ª–∞–π —Å–±–æ—Ä–∫—É –∏ —Ç–¥

---

**Cursor**

–ò—â—É —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é Java 21 –∏ –∑–∞–ø—É—Å–∫–∞—é —Å–±–æ—Ä–∫—É:


Java 21 –Ω–∞–π–¥–µ–Ω–∞. –ò—Å–ø—Ä–∞–≤–ª—è—é –≤–µ—Ä—Å–∏—é Fabric API ‚Äî –∏—â—É –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–ª—è 1.21.8:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.8
yarn_mappings=1.21.8+build.1
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.103.0+1.21.8


```

–ü—Ä–æ–≤–µ—Ä—è—é –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é Fabric API –¥–ª—è 1.21.8:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.8
yarn_mappings=1.21.8+build.1
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.102.0+1.21.8


```

–ò—Å–ø–æ–ª—å–∑—É—é –≤–µ—Ä—Å–∏—é Fabric API –¥–ª—è 1.21.8 –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:


```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.8
yarn_mappings=1.21.8+build.1
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.133.4+1.21.8


```

–û–±–Ω–æ–≤–ª—è—é –≤–µ—Ä—Å–∏—é Fabric Loom:


```gradle
plugins {
    id 'fabric-loom' version '1.10-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

–ü–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é Loom:


```gradle
plugins {
    id 'fabric-loom' version '1.8.0'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.8
yarn_mappings=1.21.8+build.1
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.129.0+1.21.8


```

–í–æ–∑–≤—Ä–∞—â–∞—é—Å—å –∫ 1.8-SNAPSHOT –∏ –ø–æ–¥–±–∏—Ä–∞—é —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –≤–µ—Ä—Å–∏—é Fabric API:


```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

```java-properties
# Done to increase the memory available to gradle.
org.gradle.jvmargs=-Xmx1G
org.gradle.parallel=true

# Fabric Properties
minecraft_version=1.21.8
yarn_mappings=1.21.8+build.1
loader_version=0.16.9

# Mod Properties
mod_version=1.0.0
maven_group=com.angella
archives_base_name=angella

# Dependencies
fabric_version=0.100.0+1.21


```

–£–±–∏—Ä–∞—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π ‚Äî API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        // Advancement events are handled via mixin or other methods in 1.21
        // This is a placeholder - advancement tracking may need custom implementation
        AngellaMod.LOGGER.info("Advancement event handler registered (may require custom implementation)");
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ü—Ä–æ–≤–µ—Ä—è—é —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:


–ü—Ä–æ–≤–µ—Ä—è—é –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞–ø—Ä—è–º—É—é:


## –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

–ú–æ–¥ —Å–æ–±—Ä–∞–Ω.

**–§–∞–π–ª –º–æ–¥–∞:** `build\libs\angella-1.0.0.jar`  
**–†–∞–∑–º–µ—Ä:** 270.94 KB

### –ß—Ç–æ –¥–∞–ª—å—à–µ:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `build\libs\angella-1.0.0.jar` –≤ –ø–∞–ø–∫—É `mods` –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `config/angella.json`.
3. Webhook URLs —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π webhook: –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ/–æ—à–∏–±–∫–∞—Ö
   - –ò–≥—Ä–æ–≤–æ–π webhook: –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∏–∑ Minecraft

### –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞:

- –û—Ç–ø—Ä–∞–≤–∫–∞ Embed-—Å–æ–æ–±—â–µ–Ω–∏–π –≤ Discord —á–µ—Ä–µ–∑ webhooks
- –°–æ–±—ã—Ç–∏—è: –≤—Ö–æ–¥/–≤—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–æ–≤, —Å–º–µ—Ä—Ç—å
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∫–∏–Ω–æ–≤
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞

–ú–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

**User**

[–°–∏—Å—Ç–µ–º–∞]: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys
[04:26:58] [main/INFO]: [voicechat] Compatibility version 20
[04:26:58] [main/INFO]: [voicechat] Loading plugins
[04:26:58] [main/INFO]: [voicechat] Loaded 2 plugin(s)
[04:26:58] [main/INFO]: [voicechat] Initializing plugins
[04:26:58] [main/INFO]: Initializing Simple Voice Chat integration
[04:26:58] [main/INFO]: [voicechat] Initialized 2 plugin(s)
[04:26:58] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'
[04:26:58] [main/INFO]: [voicechat] Registering events for 'vcinteraction'
[04:26:58] [main/INFO]: Initializing 'Better Statistics Screen' as 'BetterStatsServer'.
[04:26:58] [main/INFO]: Registering C2S receiver with id betterstats:c2s_bss
[04:26:58] [main/INFO]: Registering C2S receiver with id betterstats:c2s_prf
[04:26:58] [main/INFO]: Registering C2S receiver with id betterstats:c2s_mcbs_req
[04:26:58] [Cicada thread 0/INFO]: [cicada] Merry Christmas!
[04:26:58] [main/INFO]: Initializing Distant Horizons server, firing DhApiBeforeDhInitEvent event...
[04:26:58] [main/INFO]: Distant Horizons, Version: 2.3.6-b
[04:26:58] [main/INFO]: Registering Fabric Server Events
[04:26:58] [main/INFO]: Distant Horizons server Initialized, adding event subscribers...
[04:26:58] [main/INFO]: Krypton is now accelerating your Minecraft server's networking stack üöÄ
[04:26:58] [main/INFO]: Initializing 'TCDCommons API' 4.0.1+fabric-1.21.8 as 'TCDCommonsServer'.
[04:26:58] [main/WARN]: You specified a resource pack without providing a sha1 hash. Pack will be updated on the client only if you change the name of the pack.
[04:26:58] [main/WARN]: resource-pack-id missing, using default of 3a9a9a57-ecf4-3552-abfd-bf753fe6628c
[04:26:58] [main/INFO]: Environment: Environment[sessionHost=https://sessionserver.mojang.com, servicesHost=https://api.minecraftservices.com, name=PROD]
[04:26:58] [main/WARN]: Pack file/BACAP_Enhanced_Discoveries_2.7_Hardcore_Addon.zip declared support for versions [80, 81] but declared main format is 48, defaulting to 48
[04:26:58] [main/INFO]: Generating SERVER_DATA resources
[04:26:58] [main/INFO]: Collected 0 data resources in 61.427208ms
[04:27:05] [main/INFO]: Loaded 1412 recipes
[04:27:05] [main/INFO]: Loaded 6570 advancements
[04:27:05] [Thread-11/INFO]: Loaded 1 translation keys
[04:27:06] [main/INFO]: Applied 0 biome modifications to 0 of 65 new biomes in 1.145 ms
[04:27:06] [Server thread/INFO]: Initialising config for [DistantHorizons]
[04:27:06] [Server thread/INFO]: [DistantHorizons] Config initialised
[04:27:06] [Server thread/WARN]: Multiple potential preset options [BALANCED, LOW_IMPACT], defaulting to the first one.
[04:27:06] [Server thread/INFO]: Running Delayed setup...
[04:27:06] [Server thread/INFO]: Delayed setup complete, firing DhApiAfterDhInitEvent event...
[04:27:06] [Server thread/INFO]: Checking for Distant Horizons update
[04:27:06] [Server thread/INFO]: Distant Horizons already up to date.
[04:27:06] [Server thread/INFO]: Distant Horizons server Initialized at
[04:27:06] [Server thread/INFO]: Started [DhServerWorld] of type [SERVER_ONLY].
[04:27:06] [Server thread/INFO]: Starting minecraft server version 1.21.8
[04:27:06] [Server thread/INFO]: Loading properties
[04:27:06] [Server thread/INFO]: Default game type: SURVIVAL
[04:27:06] [Server thread/INFO]: Generating keypair
[04:27:06] [Server thread/INFO]: Starting Minecraft server on 0.0.0.0:30081
[04:27:06] [Server thread/INFO]: Using epoll channel type
[04:27:06] [Server thread/WARN]: **** SERVER IS RUNNING IN OFFLINE/INSECURE MODE!
[04:27:06] [Server thread/WARN]: The server will make no attempt to authenticate usernames. Beware.
[04:27:06] [Server thread/WARN]: While this makes the game possible to play without internet access, it also opens up the ability for hackers to connect with any username they choose.
[04:27:06] [Server thread/WARN]: To change this, set "online-mode" to "true" in the server.properties file.
[04:27:06] [Server thread/INFO]: Preparing level "Hardcore"
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:overworld]-[./Hardcore/data]...
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.
[04:27:07] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}] at [[LocalSaveStructure@(./Hardcore/data)]].
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_end]-[./Hardcore/DIM1/data]...
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.
[04:27:07] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}] at [[LocalSaveStructure@(./Hardcore/DIM1/data;./Hardcore/data)]].
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_nether]-[./Hardcore/DIM-1/data]...
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.
[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.
[04:27:07] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}] at [[LocalSaveStructure@(./Hardcore/DIM1/data;./Hardcore/DIM-1/data;./Hardcore/data)]].
[04:27:07] [Server thread/INFO]: Preparing start region for dimension minecraft:overworld
[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: BALANCED
[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: MEDIUM
[04:27:09] [DH-ApplyConfigPresetTimer/WARN]: Multiple potential preset options [BALANCED, LOW_IMPACT], defaulting to the first one.
[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: preset active: BALANCED
[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: preset active: MEDIUM
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%
[04:27:13] [Server thread/INFO]: Time elapsed: 5591 ms
[04:27:13] [Server thread/INFO]: Done (6.158s)! For help, type "help"
[04:27:13] [BlueMap-Plugin-Loading/INFO]: Loading BlueMap...
[04:27:13] [Server thread/WARN]: [voicechat] Running in offline mode - Voice chat encryption is not secure!
[04:27:13] [VoiceChatServerThread/INFO]: [voicechat] Using server-ip as bind address: 0.0.0.0
[04:27:13] [VoiceChatServerThread/INFO]: [voicechat] Voice host is '213.171.18.211:30081'
[04:27:13] [VoiceChatServerThread/INFO]: [voicechat] Voice chat server started at 0.0.0.0:30081
[04:27:13] [Server thread/INFO]: DH TerraFirmaCraft detection: false
[04:27:13] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============
[04:27:13] [Server thread/INFO]: Batch Chunk Generator initialized
[04:27:13] [Server thread/INFO]: Creating world gen queue
[04:27:13] [Server thread/INFO]: Created world gen queue
[04:27:13] [Server thread/INFO]: Set world gen queue for level [minecraft:the_end].
[04:27:13] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============
[04:27:13] [Server thread/INFO]: Batch Chunk Generator initialized
[04:27:13] [Server thread/INFO]: Creating world gen queue
[04:27:13] [Server thread/INFO]: Created world gen queue
[04:27:13] [Server thread/INFO]: Set world gen queue for level [minecraft:the_nether].
[04:27:13] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============
[04:27:13] [Server thread/INFO]: Batch Chunk Generator initialized
[04:27:13] [Server thread/INFO]: Creating world gen queue
[04:27:13] [Server thread/INFO]: Created world gen queue
[04:27:13] [Server thread/INFO]: Set world gen queue for level [minecraft:overworld].
[04:27:13] [BlueMap-Plugin-Loading/INFO]: Loading resources...
[04:27:15] [BlueMap-Plugin-Loading/INFO]: Resources loaded.
[04:27:15] [BlueMap-Plugin-Loading/INFO]: Initializing Storage: 'file' (Type: 'bluemap:file')
[04:27:15] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore'...
[04:27:15] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_end'...
[04:27:15] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_nether'...
[04:27:15] [BlueMap-Plugin-Loading/INFO]: WebServer bound to all network interfaces on port 30031
[04:27:15] [Thread-26/INFO]: WebServer started.
[04:27:15] [BlueMap-Plugin-Loading/INFO]: BlueMap loaded!
[04:27:53] [Server thread/INFO]: ASSlover[/178.66.212.202:61195] logged in with entity id 42 at (67.87155264899832, 68.0, -71.08953206612772)
[04:27:53] [Server thread/INFO]: Player [ASSlover] joined.
[04:27:53] [Server thread/INFO]: ASSlover joined the game
[04:27:54] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)
[04:27:54] [Server thread/INFO]: [voicechat] Sent secret to ASSlover
[04:30:11] [Server thread/INFO]: [Not Secure] <ASSlover> 123
[04:49:29] [Netty Epoll Server IO #2/INFO]: Player [ASSlover] disconnected.
[04:49:29] [Server thread/INFO]: ASSlover lost connection: Disconnected
[04:49:29] [Server thread/INFO]: ASSlover left the game
[04:49:29] [Server thread/INFO]: [voicechat] Disconnecting client ASSlover
[04:50:09] [Server thread/INFO]: ASSlover[/178.66.212.202:51829] logged in with entity id 2684 at (55.29524868475999, 68.0, -62.96284016863175)
[04:50:09] [Server thread/INFO]: Player [ASSlover] joined.
[04:50:09] [Server thread/INFO]: ASSlover joined the game
[04:50:09] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)
[04:50:09] [Server thread/INFO]: [voicechat] Sent secret to ASSlover
[04:50:09] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully authenticated player fd952715-538d-3844-b614-71ba8d053b66
[04:50:10] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully validated connection of player fd952715-538d-3844-b614-71ba8d053b66
[04:50:10] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Player ASSlover (fd952715-538d-3844-b614-71ba8d053b66) successfully connected to voice chat
[04:59:42] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:overworld] -> [i0emslgphpdmq@minecraft:the_nether].
[05:02:50] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:the_nether] -> [i0emslgphpdmq@minecraft:overworld].
[05:08:25] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:overworld] -> [i0emslgphpdmq@minecraft:the_nether].
[05:09:37] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:the_nether] -> [i0emslgphpdmq@minecraft:overworld].
[05:38:04] [Netty Epoll Server IO #0/INFO]: Player [ASSlover] disconnected.
[05:38:04] [Server thread/INFO]: ASSlover lost connection: Disconnected
[05:38:04] [Server thread/INFO]: ASSlover left the game
[05:38:04] [Server thread/INFO]: [voicechat] Disconnecting client ASSlover
[05:38:42] [Server thread/INFO]: ASSlover[/178.66.212.202:53278] logged in with entity id 10724 at (-13.088996309336078, 72.0, -13.482843903986907)
[05:38:42] [Server thread/INFO]: Player [ASSlover] joined.
[05:38:42] [Server thread/INFO]: ASSlover joined the game
[05:38:42] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)
[05:38:42] [Server thread/INFO]: [voicechat] Sent secret to ASSlover
[05:38:43] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully authenticated player fd952715-538d-3844-b614-71ba8d053b66
[05:38:44] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully validated connection of player fd952715-538d-3844-b614-71ba8d053b66
[05:38:44] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Player ASSlover (fd952715-538d-3844-b614-71ba8d053b66) successfully connected to voice chat
[05:38:53] [Netty Epoll Server IO #2/INFO]: Player [ASSlover] disconnected.
[05:38:53] [Server thread/INFO]: ASSlover lost connection: Disconnected
[05:38:53] [Server thread/INFO]: ASSlover left the game
[05:38:53] [Server thread/INFO]: [voicechat] Disconnecting client ASSlover
stop
[05:39:34] [Server thread/INFO]: Stopping the server
[05:39:35] [Server thread/INFO]: BlueMap unloaded!
[05:39:35] [Server thread/INFO]: Stopping server
[05:39:35] [Server thread/INFO]: Saving players
[05:39:35] [Server thread/INFO]: Saving worlds
[05:39:35] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:overworld
[05:39:35] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:the_end
[05:39:35] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:the_nether
[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage (Hardcore): All chunks are saved
[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage (DIM1): All chunks are saved
[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage (DIM-1): All chunks are saved
[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage: All dimensions are saved
[05:39:35] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:overworld}
[05:39:35] [Server thread/INFO]: Closing world gen queue
[05:39:35] [Server thread/INFO]: Closing WorldGenerationQueue...
[05:39:35] [Server thread/INFO]: Awaiting world generator thread pool termination...
[05:39:38] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.
[05:39:38] [Server thread/INFO]: BatchGenerator shutting down...
[05:39:38] [Server thread/INFO]: BatchGenerationEnvironment shutting down...
[05:39:38] [Server thread/INFO]: Canceling in progress generation event futures...
[05:39:38] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.
[05:39:38] [Server thread/INFO]: Finished closing WorldGenerationQueue
[05:39:38] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].
[05:39:38] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].
[05:39:38] [DH-Parent Update Queue [minecraft:overworld] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:overworld] Thread[0]] terminated.
[05:39:38] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/data/DistantHorizons.sqlite]...
[05:39:38] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/data/DistantHorizons.sqlite]
[05:39:38] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}].
[05:39:38] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].
[05:39:38] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].
[05:39:38] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}].
[05:39:38] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:the_end}
[05:39:38] [Server thread/INFO]: Closing world gen queue
[05:39:38] [Server thread/INFO]: Closing WorldGenerationQueue...
[05:39:38] [Server thread/INFO]: Awaiting world generator thread pool termination...
[05:39:41] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.
[05:39:41] [Server thread/INFO]: BatchGenerator shutting down...
[05:39:41] [Server thread/INFO]: BatchGenerationEnvironment shutting down...
[05:39:41] [Server thread/INFO]: Canceling in progress generation event futures...
[05:39:41] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.
[05:39:41] [Server thread/INFO]: Finished closing WorldGenerationQueue
[05:39:41] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].
[05:39:41] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].
[05:39:41] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM1/data/DistantHorizons.sqlite]...
[05:39:41] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM1/data/DistantHorizons.sqlite]
[05:39:41] [DH-Parent Update Queue [minecraft:the_end] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:the_end] Thread[0]] terminated.
[05:39:41] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}].
[05:39:42] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].
[05:39:42] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].
[05:39:42] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}].
[05:39:42] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:the_nether}
[05:39:42] [Server thread/INFO]: Closing world gen queue
[05:39:42] [Server thread/INFO]: Closing WorldGenerationQueue...
[05:39:42] [Server thread/INFO]: Awaiting world generator thread pool termination...
[05:39:45] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.
[05:39:45] [Server thread/INFO]: BatchGenerator shutting down...
[05:39:45] [Server thread/INFO]: BatchGenerationEnvironment shutting down...
[05:39:45] [Server thread/INFO]: Canceling in progress generation event futures...
[05:39:45] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.
[05:39:45] [Server thread/INFO]: Finished closing WorldGenerationQueue
[05:39:45] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].
[05:39:45] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].
[05:39:45] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM-1/data/DistantHorizons.sqlite]...
[05:39:45] [DH-Parent Update Queue [minecraft:the_nether] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:the_nether] Thread[0]] terminated.
[05:39:45] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM-1/data/DistantHorizons.sqlite]
[05:39:45] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}].
[05:39:45] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].
[05:39:45] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].
[05:39:45] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}].
[05:39:45] [Server thread/INFO]: Closed DhWorld of type [SERVER_ONLY].
[05:39:45] [Server thread/INFO]: Closed DhWorld of type [SERVER_ONLY].
[05:39:45] [Server thread/INFO]: Shutting down PriorityTaskPicker thread pool...
[05:39:45] [Server thread/INFO]: Closing all [0] database connections...
[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...
[Hermes Daemon]: Updating process configuration files...
[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...
[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...
Pulling from hosthub/openjdk
Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530
Status: Image is up to date for hosthub/openjdk:23
[Hermes Daemon]: Finished pulling Docker container image
openjdk version "23.0.2" 2025-01-21
OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)
OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)
Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture
[05:39:49] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0
[05:39:49] [main/INFO]: Loading 112 mods:
- angella 1.0.0
\-- com_google_code_gson_gson 2.10.1
- architectury 17.0.8
- balm 21.8.10
\-- kuma_api 21.8.5
- betterstats 4.0.0
- bluemap 5.11
|-- com_flowpowered_flow-math 1.0.3
\-- de_bluecolored_bluenbt 3.3.0
- cicada 0.14.3+1.21.6-1.21.8
\-- org_yaml_snakeyaml 2.2
- cobweb 1.4.0
- collective 8.11
- creativecore 2.14.6
\-- net_neoforged_bus 7.2.0
- distanthorizons 2.3.6-b
|-- fabric-api-base 0.5.0+cd8c0daa2c
|-- fabric-command-api-v2 2.3.1+52fff9ec2c
|-- fabric-entity-events-v1 2.1.2+c9e472732c
|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c
|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c
|-- fabric-rendering-v1 12.5.1+fbe231d52c
|-- fabric-resource-loader-v0 3.1.12+020423442c
\-- fabric-screen-api-v1 2.1.1+277ecf7d2c
- elytratrims 4.3.1
- fabric-api 0.136.0+1.21.8
|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c
|-- fabric-biome-api-v1 16.1.0+c21d71cc2c
|-- fabric-block-api-v1 1.1.3+946bf4c32c
|-- fabric-block-view-api-v2 1.0.31+946bf4c32c
|-- fabric-content-registries-v0 10.1.0+c75de69d2c
|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c
|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c
|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c
|-- fabric-data-attachment-api-v1 1.8.14+97214db32c
|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c
|-- fabric-dimensions-v1 4.0.20+948fc79a2c
|-- fabric-events-interaction-v0 4.0.26+946bf4c32c
|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c
|-- fabric-item-api-v1 11.5.0+02ce13f42c
|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c
|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c
|-- fabric-loot-api-v2 3.0.56+3f89f5a52c
|-- fabric-loot-api-v3 2.0.3+946bf4c32c
|-- fabric-message-api-v1 6.1.2+946bf4c32c
|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c
|-- fabric-networking-api-v1 5.1.0+57cb96dd2c
|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c
|-- fabric-particles-v1 4.1.10+946bf4c32c
|-- fabric-recipe-api-v1 8.1.17+946bf4c32c
|-- fabric-registry-sync-v0 6.1.30+946bf4c32c
|-- fabric-renderer-api-v1 7.0.4+208eed172c
|-- fabric-renderer-indigo 4.0.4+946bf4c32c
|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c
|-- fabric-rendering-v1 12.5.1+fbe231d52c
|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c
|-- fabric-screen-api-v1 2.2.0+e0cb65d02c
|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c
|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c
|-- fabric-sound-api-v1 1.0.42+946bf4c32c
|-- fabric-tag-api-v1 1.2.2+946bf4c32c
|-- fabric-transfer-api-v1 6.0.6+946bf4c32c
\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c
- fabric-language-kotlin 1.13.7+kotlin.2.2.21
|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21
|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21
|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21
|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21
|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0
|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2
|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2
|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1
|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0
|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0
|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0
|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0
\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0
- fabricloader 0.18.0
\-- mixinextras 0.5.0
- forgeconfigapiport 21.8.2
|-- com_electronwill_night-config_core 3.8.3
\-- com_electronwill_night-config_toml 3.8.3
- gpumemleakfix 1.21.8-1.8
- hardcorerevival 21.8.3
- inventorytotem 3.4
- itemphysic 1.8.11
- java 23
- krypton 0.2.9
\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT
- lithium 0.18.1+mc1.21.8
- minecraft 1.21.8
- mr_serversleep 1-datapack2
- notenoughanimations 1.10.6
|-- transition 1.0.7
\-- trender 1.0.8
- player_animation_library 1.0.13+mc.1.21.8
\-- org_javassist_javassist 3.30.2-GA
- pyrotechnic_elytra 1.0.1
- readyplayerfun 3.1.0.1
\-- whitenoise 1.1.1
|-- com_electronwill_night-config_core 3.8.3
\-- com_electronwill_night-config_toml 3.8.3
- skinrestorer 2.4.3+1.21.6-fabric
\-- org_mineskin_java-client 3.0.6-SNAPSHOT
- skinshuffle 2.9.5+1.21.6
|-- com_drewnoakes_metadata-extractor 2.19.0
|-- com_konghq_unirest-java_standalone 3.11.9
|-- commons-validator_commons-validator 1.7
|-- org_jsoup_jsoup 1.16.1
\-- spruceui 8.0.0+1.21.6
- sound_physics_remastered 1.21.8-1.5.1
- tcdcommons 4.0.1+fabric-1.21.8
- vcinteraction 1.21.8-1.0.8
\-- polymer-registry-sync-manipulator 0.13.6+1.21.7
- voicechat 1.21.8-2.6.6
|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3
|-- fabric-rendering-v1 12.4.0+e8d43c76f3
\-- voicechat_api 2.6.0
- yet_another_config_lib_v3 3.7.1+1.21.6-fabric
|-- com_twelvemonkeys_common_common-image 3.12.0
|-- com_twelvemonkeys_common_common-io 3.12.0
|-- com_twelvemonkeys_common_common-lang 3.12.0
|-- com_twelvemonkeys_imageio_imageio-core 3.12.0
|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0
|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0
|-- org_quiltmc_parsers_gson 0.2.1
\-- org_quiltmc_parsers_json 0.2.1
[05:39:49] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER
[05:39:49] [main/INFO]: Compatibility level set to JAVA_21
[05:39:49] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message
[05:39:49] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.
[05:39:49] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message
[05:39:49] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message
[05:39:50] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).
[05:39:53] [main/ERROR]: Minecraft has crashed!
net.fabricmc.loader.impl.FormattedException: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed
at net.fabricmc.loader.impl.FormattedException.ofLocalized(FormattedException.java:63) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:516) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]
at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]
Caused by: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
Caused by: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:440) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]
at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
Caused by: org.spongepowered.asm.mixin.transformer.throwables.MixinTransformerError: An unexpected critical error was encountered
at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:381) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]
at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
Caused by: org.spongepowered.asm.mixin.injection.throwables.InjectionError: Critical injection failure: Callback method onPlayerDeath(Lnet/minecraft/class_1282;Lorg/spongepowered/asm/mixin/injection/callback/CallbackInfo;)V in angella.mixins.json:ServerPlayerEntityMixin from mod angella failed injection check, (0/1) succeeded. Scanned 0 target(s). Using refmap angella-refmap.json
at org.spongepowered.asm.mixin.injection.struct.InjectionInfo.postInject(InjectionInfo.java:531) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTargetContext.applyInjections(MixinTargetContext.java:1490) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyInjections(MixinApplicatorStandard.java:752) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyMixin(MixinApplicatorStandard.java:330) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.apply(MixinApplicatorStandard.java:246) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.TargetClassContext.apply(TargetClassContext.java:437) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.TargetClassContext.applyMixins(TargetClassContext.java:418) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:352) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]
at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------
[Hermes Daemon]: Exit code: 1
[Hermes Daemon]: Out of memory: false
[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...
[Hermes Daemon]: Updating process configuration files...
[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...
[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...
Pulling from hosthub/openjdk
Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530
Status: Image is up to date for hosthub/openjdk:23
[Hermes Daemon]: Finished pulling Docker container image
openjdk version "23.0.2" 2025-01-21
OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)
OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)
Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture
[05:39:56] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0
[05:39:56] [main/INFO]: Loading 112 mods:
- angella 1.0.0
\-- com_google_code_gson_gson 2.10.1
- architectury 17.0.8
- balm 21.8.10
\-- kuma_api 21.8.5
- betterstats 4.0.0
- bluemap 5.11
|-- com_flowpowered_flow-math 1.0.3
\-- de_bluecolored_bluenbt 3.3.0
- cicada 0.14.3+1.21.6-1.21.8
\-- org_yaml_snakeyaml 2.2
- cobweb 1.4.0
- collective 8.11
- creativecore 2.14.6
\-- net_neoforged_bus 7.2.0
- distanthorizons 2.3.6-b
|-- fabric-api-base 0.5.0+cd8c0daa2c
|-- fabric-command-api-v2 2.3.1+52fff9ec2c
|-- fabric-entity-events-v1 2.1.2+c9e472732c
|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c
|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c
|-- fabric-rendering-v1 12.5.1+fbe231d52c
|-- fabric-resource-loader-v0 3.1.12+020423442c
\-- fabric-screen-api-v1 2.1.1+277ecf7d2c
- elytratrims 4.3.1
- fabric-api 0.136.0+1.21.8
|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c
|-- fabric-biome-api-v1 16.1.0+c21d71cc2c
|-- fabric-block-api-v1 1.1.3+946bf4c32c
|-- fabric-block-view-api-v2 1.0.31+946bf4c32c
|-- fabric-content-registries-v0 10.1.0+c75de69d2c
|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c
|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c
|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c
|-- fabric-data-attachment-api-v1 1.8.14+97214db32c
|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c
|-- fabric-dimensions-v1 4.0.20+948fc79a2c
|-- fabric-events-interaction-v0 4.0.26+946bf4c32c
|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c
|-- fabric-item-api-v1 11.5.0+02ce13f42c
|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c
|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c
|-- fabric-loot-api-v2 3.0.56+3f89f5a52c
|-- fabric-loot-api-v3 2.0.3+946bf4c32c
|-- fabric-message-api-v1 6.1.2+946bf4c32c
|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c
|-- fabric-networking-api-v1 5.1.0+57cb96dd2c
|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c
|-- fabric-particles-v1 4.1.10+946bf4c32c
|-- fabric-recipe-api-v1 8.1.17+946bf4c32c
|-- fabric-registry-sync-v0 6.1.30+946bf4c32c
|-- fabric-renderer-api-v1 7.0.4+208eed172c
|-- fabric-renderer-indigo 4.0.4+946bf4c32c
|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c
|-- fabric-rendering-v1 12.5.1+fbe231d52c
|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c
|-- fabric-screen-api-v1 2.2.0+e0cb65d02c
|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c
|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c
|-- fabric-sound-api-v1 1.0.42+946bf4c32c
|-- fabric-tag-api-v1 1.2.2+946bf4c32c
|-- fabric-transfer-api-v1 6.0.6+946bf4c32c
\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c
- fabric-language-kotlin 1.13.7+kotlin.2.2.21
|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21
|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21
|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21
|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21
|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0
|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2
|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2
|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1
|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0
|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0
|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0
|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0
\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0
- fabricloader 0.18.0
\-- mixinextras 0.5.0
- forgeconfigapiport 21.8.2
|-- com_electronwill_night-config_core 3.8.3
\-- com_electronwill_night-config_toml 3.8.3
- gpumemleakfix 1.21.8-1.8
- hardcorerevival 21.8.3
- inventorytotem 3.4
- itemphysic 1.8.11
- java 23
- krypton 0.2.9
\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT
- lithium 0.18.1+mc1.21.8
- minecraft 1.21.8
- mr_serversleep 1-datapack2
- notenoughanimations 1.10.6
|-- transition 1.0.7
\-- trender 1.0.8
- player_animation_library 1.0.13+mc.1.21.8
\-- org_javassist_javassist 3.30.2-GA
- pyrotechnic_elytra 1.0.1
- readyplayerfun 3.1.0.1
\-- whitenoise 1.1.1
|-- com_electronwill_night-config_core 3.8.3
\-- com_electronwill_night-config_toml 3.8.3
- skinrestorer 2.4.3+1.21.6-fabric
\-- org_mineskin_java-client 3.0.6-SNAPSHOT
- skinshuffle 2.9.5+1.21.6
|-- com_drewnoakes_metadata-extractor 2.19.0
|-- com_konghq_unirest-java_standalone 3.11.9
|-- commons-validator_commons-validator 1.7
|-- org_jsoup_jsoup 1.16.1
\-- spruceui 8.0.0+1.21.6
- sound_physics_remastered 1.21.8-1.5.1
- tcdcommons 4.0.1+fabric-1.21.8
- vcinteraction 1.21.8-1.0.8
\-- polymer-registry-sync-manipulator 0.13.6+1.21.7
- voicechat 1.21.8-2.6.6
|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3
|-- fabric-rendering-v1 12.4.0+e8d43c76f3
\-- voicechat_api 2.6.0
- yet_another_config_lib_v3 3.7.1+1.21.6-fabric
|-- com_twelvemonkeys_common_common-image 3.12.0
|-- com_twelvemonkeys_common_common-io 3.12.0
|-- com_twelvemonkeys_common_common-lang 3.12.0
|-- com_twelvemonkeys_imageio_imageio-core 3.12.0
|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0
|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0
|-- org_quiltmc_parsers_gson 0.2.1
\-- org_quiltmc_parsers_json 0.2.1
[05:39:56] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER
[05:39:56] [main/INFO]: Compatibility level set to JAVA_21
[05:39:57] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message
[05:39:57] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.
[05:39:57] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message
[05:39:57] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message
[05:39:57] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).
[05:40:01] [main/ERROR]: Minecraft has crashed!
net.fabricmc.loader.impl.FormattedException: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed
at net.fabricmc.loader.impl.FormattedException.ofLocalized(FormattedException.java:63) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:516) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]
at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]
Caused by: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
Caused by: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:440) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]
at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
Caused by: org.spongepowered.asm.mixin.transformer.throwables.MixinTransformerError: An unexpected critical error was encountered
at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:381) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]
at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
Caused by: org.spongepowered.asm.mixin.injection.throwables.InjectionError: Critical injection failure: Callback method onPlayerDeath(Lnet/minecraft/class_1282;Lorg/spongepowered/asm/mixin/injection/callback/CallbackInfo;)V in angella.mixins.json:ServerPlayerEntityMixin from mod angella failed injection check, (0/1) succeeded. Scanned 0 target(s). Using refmap angella-refmap.json
at org.spongepowered.asm.mixin.injection.struct.InjectionInfo.postInject(InjectionInfo.java:531) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTargetContext.applyInjections(MixinTargetContext.java:1490) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyInjections(MixinApplicatorStandard.java:752) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyMixin(MixinApplicatorStandard.java:330) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.apply(MixinApplicatorStandard.java:246) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.TargetClassContext.apply(TargetClassContext.java:437) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.TargetClassContext.applyMixins(TargetClassContext.java:418) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:352) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]
at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]
at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]
at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]
at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]
at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]
at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]
... 4 more
[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------
[Hermes Daemon]: Exit code: 1
[Hermes Daemon]: Out of memory: false
[Hermes Daemon]: Aborting automatic restart, last crash occurred less than 60 seconds ago.

---

**Cursor**

–û—à–∏–±–∫–∞ –≤ mixin –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–º–µ—Ä—Ç–∏: –Ω–µ–≤–µ—Ä–Ω–∞—è —Ç–æ—á–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏. –ò—Å–ø—Ä–∞–≤–ª—è—é mixin:


–ò—Å–ø—Ä–∞–≤–ª—è—é mixin: –∏—Å–ø–æ–ª—å–∑—É—é –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—É—é —Ç–æ—á–∫—É –∏–Ω—ä–µ–∫—Ü–∏–∏ –∏–ª–∏ —É–±–∏—Ä–∞—é –µ–≥–æ –∏ –ø–µ—Ä–µ—Ö–æ–∂—É –Ω–∞ —Å–æ–±—ã—Ç–∏—è Fabric:


```java
package com.angella.mixins;

import com.angella.events.DeathEventHandler;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityMixin {
    
    @Inject(method = "onDeath", at = @At("TAIL"))
    private void onPlayerDeath(net.minecraft.entity.damage.DamageSource damageSource, CallbackInfo ci) {
        ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
        Text deathMessage = player.getDamageTracker().getDeathMessage();
        if (deathMessage != null) {
            DeathEventHandler.onPlayerDeath(player, deathMessage);
        }
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω mixin: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–∞—è —Ç–æ—á–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ `@At("TAIL")`, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ 1.21.8.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ.

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- Mixin –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–º–µ—Ä—Ç–∏ –∏–≥—Ä–æ–∫–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `@At("TAIL")` –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏, —á—Ç–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å 1.21.8

–ú–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

**User**

–ê –ø–æ—á–µ–º—É –±–æ—Ç –Ω–µ –æ–Ω–ª–∞–π–Ω? –ø–æ—á–µ–º—É –Ω–µ –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è?
–ü—É—Å–∫–∞–π –Ω–µ –≤–µ–±—Ö—É–∫–∞–º–∏ –ø–∏—à–µ—Ç –∑–Ω–∞—á–∏—Ç
1256170139318091807 id —Ç–µ—Ö–Ω–æ –∫–∞–Ω–∞–ª–∞
1444857215172345886 id –∫–∞–Ω–∞–ª–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π - —Å–º–µ—Ä—Ç–µ–π –∏ —Ç–¥
–í —Å–º–µ—Ä—Ç—è—Ö –ø—É—Å–∫–∞–π –ø–∏—à–µ—Ç—Å—è –æ—Ç —á–µ–≥–æ –∏ —Ç–¥ –∫–∞–∫-—Ç–æ –ø–æ —Ä–æ—Ñ–µ–ª—å–Ω–æ–º—É
–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫—Ä–∞—Å–∏–≤–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ –∏–∑ —á–∞—Ç–∞ –±–µ—Ä—É—Ç—Å—è –º–∞–π–Ω–∞

–ö–æ–≥–¥–∞ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω - 
‚úÖ Angella –∑–∞–ø—É—â–µ–Ω!
–°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.
–ì–æ–ª–æ–≤—ã –∏–≥—Ä–æ–∫–æ–≤ –≤—Å–µ —Ç–∞–∫ –∂–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
–ü—É—Å–∫–∞–π –ø–∏—à–µ—Ç—Å—è —á—Ç–æ –±–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ

---

**Cursor**

–í–æ–∑–≤—Ä–∞—â–∞—é JDA-–±–æ—Ç–∞ –≤–º–µ—Å—Ç–æ webhooks, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é –æ—Ç–ø—Ä–∞–≤–∫—É –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã, —É–ª—É—á—à–∞—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é –∞–≤–∞—Ç–∞—Ä—ã.


–ü–µ—Ä–µ–≤–æ–∂—É –Ω–∞ JDA-–±–æ—Ç–∞ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é –æ—Ç–ø—Ä–∞–≤–∫—É –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã:


```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // JDA for Discord Bot
    implementation 'net.dv8tion:JDA:5.1.1'
    include 'net.dv8tion:JDA:5.1.1'
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

```java
package com.angella.config;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;

public class AngellaConfig {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path CONFIG_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella.json");
    
    // Discord Bot Settings
    public String botToken = "MTMzOTgwNzkyNjM3Nzc3NTE4Mg.GlFRpA.96vjS8hIy4cwhkdOG61nOwK1vMbHi3q1VXTUAA";
    
    // Channel IDs
    public long technicalChannelId = 1256170139318091807L; // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
    public long gameChannelId = 1444857215172345886L; // –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft (–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, —Å–º–µ—Ä—Ç–∏ –∏ —Ç.–¥.)
    
    // Features
    public boolean enabled = true;
    public boolean sendPlayerJoin = true;
    public boolean sendPlayerLeave = true;
    public boolean sendPlayerDeath = true;
    public boolean sendAdvancements = true;
    public boolean sendServerStart = true;
    public boolean sendServerStop = true;
    
    // SkinRestorer Integration
    public boolean useSkinRestorer = true;
    public String skinRestorerApiUrl = ""; // SkinRestorer API URL (if available)
    // Common SkinRestorer API URLs:
    // - http://localhost:8080/api/v1/skin (if SkinRestorer has HTTP API)
    // - Leave empty to use file system detection
    
    // Embed Settings
    public String embedColor = "#5865F2"; // Discord blue
    public String serverName = "Minecraft Server";
    public String serverIconUrl = "";
    
    // Messages
    public String joinMessage = "{player} joined the server";
    public String leaveMessage = "{player} left the server";
    public String deathMessage = "{player} died: {death_message}";
    public String advancementMessage = "{player} earned the advancement **{advancement}**";
    public String serverStartMessage = "Server is starting...";
    public String serverStopMessage = "Server is stopping...";
    
    public static AngellaConfig load() {
        File configFile = CONFIG_PATH.toFile();
        
        if (configFile.exists()) {
            try (FileReader reader = new FileReader(configFile)) {
                AngellaConfig config = GSON.fromJson(reader, AngellaConfig.class);
                if (config != null) {
                    return config;
                }
            } catch (IOException e) {
                System.err.println("Failed to load config file: " + e.getMessage());
            }
        }
        
        // Create default config
        AngellaConfig config = new AngellaConfig();
        config.save();
        return config;
    }
    
    public void save() {
        File configFile = CONFIG_PATH.toFile();
        
        try {
            if (!configFile.getParentFile().exists()) {
                configFile.getParentFile().mkdirs();
            }
            
            try (FileWriter writer = new FileWriter(configFile)) {
                GSON.toJson(this, writer);
            }
        } catch (IOException e) {
            System.err.println("Failed to save config file: " + e.getMessage());
        }
    }
    
    // Getters
    public String getTechnicalWebhookUrl() {
        return technicalWebhookUrl;
    }
    
    public String getGameWebhookUrl() {
        return gameWebhookUrl;
    }
    
    public boolean isEnabled() {
        return enabled;
    }
    
    public boolean isUseSkinRestorer() {
        return useSkinRestorer;
    }
    
    public String getSkinRestorerApiUrl() {
        return skinRestorerApiUrl;
    }
    
    public String getEmbedColor() {
        return embedColor;
    }
    
    public String getServerName() {
        return serverName;
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n–°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.").queue();
            });
        }
    }
    
    public void shutdown() {
        if (jda != null) {
            if (technicalChannel != null) {
                technicalChannel.sendMessage("üî¥ **Angella –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n–°–µ—Ä–≤–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω.").queue();
            }
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n–ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤.").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**").queue();
            });
        }
    }
    
    public void onServerStopped() {
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

–ü–µ—Ä–µ–¥–µ–ª—ã–≤–∞—é EmbedBuilder –¥–ª—è JDA –∏ —É–ª—É—á—à–∞—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.EmbedBuilder as JDAEmbedBuilder;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JDAEmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new JDAEmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üéÆ –ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∏–≥—Ä–µ");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        String formattedDeath = formatDeathMessage(deathText, playerName);
        
        builder.embedBuilder.setDescription("**" + playerName + "** " + formattedDeath);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FF0000")); // –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —Å–º–µ—Ä—Ç–∏
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private static String formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return "—É—Ç–æ–Ω—É–ª üíß";
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return "—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ üî•";
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return "—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ üí•";
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return "–≤–∑–æ—Ä–≤–∞–ª—Å—è üí£";
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return "–±—ã–ª —É–±–∏—Ç ‚öîÔ∏è";
        } else if (message.contains("—É–º–µ—Ä") || message.contains("died")) {
            return "—É–º–µ—Ä üíÄ";
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return "—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É üåå";
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return "–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è üòµ";
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return "–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º üèπ";
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return "–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏ üßü";
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return "–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º üí•";
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return "–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º üëÅÔ∏è";
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            return message.isEmpty() ? "—É–º–µ—Ä" : message;
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.config;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;

public class AngellaConfig {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path CONFIG_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella.json");
    
    // Discord Bot Settings
    public String botToken = "MTMzOTgwNzkyNjM3Nzc3NTE4Mg.GlFRpA.96vjS8hIy4cwhkdOG61nOwK1vMbHi3q1VXTUAA";
    
    // Channel IDs
    public long technicalChannelId = 1256170139318091807L; // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
    public long gameChannelId = 1444857215172345886L; // –°–æ–±—ã—Ç–∏—è –∏–∑ Minecraft (–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, —Å–º–µ—Ä—Ç–∏ –∏ —Ç.–¥.)
    
    // Features
    public boolean enabled = true;
    public boolean sendPlayerJoin = true;
    public boolean sendPlayerLeave = true;
    public boolean sendPlayerDeath = true;
    public boolean sendAdvancements = true;
    public boolean sendServerStart = true;
    public boolean sendServerStop = true;
    
    // SkinRestorer Integration
    public boolean useSkinRestorer = true;
    public String skinRestorerApiUrl = ""; // SkinRestorer API URL (if available)
    // Common SkinRestorer API URLs:
    // - http://localhost:8080/api/v1/skin (if SkinRestorer has HTTP API)
    // - Leave empty to use file system detection
    
    // Embed Settings
    public String embedColor = "#5865F2"; // Discord blue
    public String serverName = "Minecraft Server";
    public String serverIconUrl = "";
    
    // Messages
    public String joinMessage = "{player} joined the server";
    public String leaveMessage = "{player} left the server";
    public String deathMessage = "{player} died: {death_message}";
    public String advancementMessage = "{player} earned the advancement **{advancement}**";
    public String serverStartMessage = "Server is starting...";
    public String serverStopMessage = "Server is stopping...";
    
    public static AngellaConfig load() {
        File configFile = CONFIG_PATH.toFile();
        
        if (configFile.exists()) {
            try (FileReader reader = new FileReader(configFile)) {
                AngellaConfig config = GSON.fromJson(reader, AngellaConfig.class);
                if (config != null) {
                    return config;
                }
            } catch (IOException e) {
                System.err.println("Failed to load config file: " + e.getMessage());
            }
        }
        
        // Create default config
        AngellaConfig config = new AngellaConfig();
        config.save();
        return config;
    }
    
    public void save() {
        File configFile = CONFIG_PATH.toFile();
        
        try {
            if (!configFile.getParentFile().exists()) {
                configFile.getParentFile().mkdirs();
            }
            
            try (FileWriter writer = new FileWriter(configFile)) {
                GSON.toJson(this, writer);
            }
        } catch (IOException e) {
            System.err.println("Failed to save config file: " + e.getMessage());
        }
    }
    
    // Getters
    public String getBotToken() {
        return botToken;
    }
    
    public long getTechnicalChannelId() {
        return technicalChannelId;
    }
    
    public long getGameChannelId() {
        return gameChannelId;
    }
    
    public boolean isEnabled() {
        return enabled;
    }
    
    public boolean isUseSkinRestorer() {
        return useSkinRestorer;
    }
    
    public String getSkinRestorerApiUrl() {
        return skinRestorerApiUrl;
    }
    
    public String getEmbedColor() {
        return embedColor;
    }
    
    public String getServerName() {
        return serverName;
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤: –∏—Å–ø–æ–ª—å–∑—É–µ–º UUID –∏ mc-heads.net:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    
    /**
     * Gets the player's avatar URL, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        // Format: https://mc-heads.net/avatar/{username}/128
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Try to get UUID first, but if player doesn't have Mojang account,
                            // we'll use a fallback that works with usernames
                            String uuid = getPlayerUuid(playerName);
                            if (uuid != null) {
                                // Player has Mojang account - use UUID
                                return "https://mc-heads.net/avatar/" + uuid + "/128";
                            } else {
                                // Player doesn't have Mojang account but has SkinRestorer skin
                                // Use mc-heads with username (some APIs support this)
                                // Or use a custom SkinRestorer endpoint if available
                                String customUrl = apiUrl.replace("/api/v1/skin", "/head/" + playerName + "/128");
                                return customUrl;
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella;

import com.angella.config.AngellaConfig;
import com.angella.discord.DiscordBot;
import com.angella.events.PlayerEventHandler;
import net.fabricmc.api.ModInitializer;
import net.fabricmc.fabric.api.event.lifecycle.v1.ServerLifecycleEvents;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class AngellaMod implements ModInitializer {
    public static final String MOD_ID = "angella";
    public static final Logger LOGGER = LoggerFactory.getLogger(MOD_ID);
    
    private static DiscordBot discordBot;
    private static AngellaConfig config;

    @Override
    public void onInitialize() {
        LOGGER.info("Initializing Angella Discord Integration Mod");
        
        // Load configuration
        config = AngellaConfig.load();
        
        // Initialize Discord bot
        if (config.isEnabled() && config.getBotToken() != null && !config.getBotToken().isEmpty()) {
            try {
                discordBot = new DiscordBot(config);
                discordBot.start();
                LOGGER.info("Discord bot started successfully!");
            } catch (Exception e) {
                LOGGER.error("Failed to start Discord bot", e);
            }
        } else {
            LOGGER.warn("Discord bot is disabled or token is not configured. Please check your config file.");
        }
        
        // Register event handlers
        PlayerEventHandler.register();
        
        // Register server lifecycle events
        ServerLifecycleEvents.SERVER_STARTING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarting();
            }
        });
        
        ServerLifecycleEvents.SERVER_STARTED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarted();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopping();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopped();
            }
        });
    }
    
    public static DiscordBot getDiscordBot() {
        return discordBot;
    }
    
    public static AngellaConfig getConfig() {
        return config;
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É –∏–º–ø–æ—Ä—Ç–∞:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final JDAEmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new JDAEmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üéÆ –ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∏–≥—Ä–µ");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        String formattedDeath = formatDeathMessage(deathText, playerName);
        
        builder.embedBuilder.setDescription("**" + playerName + "** " + formattedDeath);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FF0000")); // –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —Å–º–µ—Ä—Ç–∏
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private static String formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return "—É—Ç–æ–Ω—É–ª üíß";
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return "—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ üî•";
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return "—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ üí•";
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return "–≤–∑–æ—Ä–≤–∞–ª—Å—è üí£";
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return "–±—ã–ª —É–±–∏—Ç ‚öîÔ∏è";
        } else if (message.contains("—É–º–µ—Ä") || message.contains("died")) {
            return "—É–º–µ—Ä üíÄ";
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return "—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É üåå";
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return "–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è üòµ";
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return "–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º üèπ";
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return "–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏ üßü";
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return "–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º üí•";
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return "–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º üëÅÔ∏è";
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            return message.isEmpty() ? "—É–º–µ—Ä" : message;
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üéÆ –ò–≥—Ä–æ–∫ –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∏–≥—Ä–µ");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        String formattedDeath = formatDeathMessage(deathText, playerName);
        
        builder.embedBuilder.setDescription("**" + playerName + "** " + formattedDeath);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FF0000")); // –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —Å–º–µ—Ä—Ç–∏
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private static String formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return "—É—Ç–æ–Ω—É–ª üíß";
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return "—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ üî•";
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return "—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ üí•";
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return "–≤–∑–æ—Ä–≤–∞–ª—Å—è üí£";
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return "–±—ã–ª —É–±–∏—Ç ‚öîÔ∏è";
        } else if (message.contains("—É–º–µ—Ä") || message.contains("died")) {
            return "—É–º–µ—Ä üíÄ";
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return "—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É üåå";
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return "–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è üòµ";
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return "–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º üèπ";
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return "–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏ üßü";
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return "–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º üí•";
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return "–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º üëÅÔ∏è";
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            return message.isEmpty() ? "—É–º–µ—Ä" : message;
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–£–ª—É—á—à–∞—é –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤ —Å SkinRestorer:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    
    /**
     * Gets the player's avatar URL, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        // Format: https://mc-heads.net/avatar/{username}/128
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Try to get UUID first, but if player doesn't have Mojang account,
                            // we'll use a fallback that works with usernames
                            String uuid = getPlayerUuid(playerName);
                            if (uuid != null) {
                                // Player has Mojang account - use UUID
                                return "https://mc-heads.net/avatar/" + uuid + "/128";
                            } else {
                                // Player doesn't have Mojang account but has SkinRestorer skin
                                // Use mc-heads.net with username (works for offline players)
                                return "https://mc-heads.net/avatar/" + playerName + "/128";
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

–î–æ–±–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ mixin:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityAdvancementMixin {
    
    @Inject(method = "getAdvancementTracker", at = @At("RETURN"))
    private void onAdvancementGranted(CallbackInfoReturnable<?> cir) {
        // This will be called when advancement tracker is accessed
        // We'll use a different approach - listening to advancement progress
    }
}

```

```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        // Try to register advancement event if available
        try {
            ServerPlayerEvents.AFTER_ADVANCEMENT.register((player, advancement, criterionName) -> {
                if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                    if (AngellaMod.getConfig().sendAdvancements) {
                        // Only send if advancement has a display (visible advancements)
                        if (advancement.value().display().isPresent()) {
                            EmbedBuilder.createAdvancementEmbed(player, advancement, AngellaMod.getConfig())
                                    .sendToGame();
                        }
                    }
                }
            });
            AngellaMod.LOGGER.info("Advancement event handler registered successfully");
        } catch (NoSuchFieldError | NoSuchMethodError e) {
            // Advancement events not available in this version - will use mixin instead
            AngellaMod.LOGGER.warn("Advancement events not available, using mixin approach");
        }
    }
}


```

–£–¥–∞–ª—è—é –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π WebhookClient –∏ —Å–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç:


---

**User**

–£ —Ç–µ–±—è –æ—á–µ–Ω—å —Å–∫—É—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è - —Ä–∞–∑–±–∞–≤—å –∏—Ö —ç–º–æ–¥–∑–∏ –∏ –±–æ–ª–µ–µ –∂–∏–≤—ã–º–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞

---

**Cursor**

–î–æ–±–∞–≤–ª—è—é —ç–º–æ–¥–∑–∏ –∏ –¥–µ–ª–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ–ª–µ–µ –∂–∏–≤—ã–º–∏:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É –∏ –¥–µ–ª–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ–ª–µ–µ –∂–∏–≤—ã–º–∏ —Å —ç–º–æ–¥–∑–∏:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;

public class AdvancementEventHandler {
    
    public static void register() {
        // Advancement events are handled via mixin or other methods in 1.21
        // This is a placeholder - advancement tracking may need custom implementation
        AngellaMod.LOGGER.info("Advancement event handler registered (may require custom implementation)");
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] joinMessages = {
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        };
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        builder.embedBuilder.setTitle("üéÆ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä");
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        String formattedDeath = formatDeathMessage(deathText, playerName);
        
        builder.embedBuilder.setDescription("**" + playerName + "** " + formattedDeath);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FF0000")); // –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —Å–º–µ—Ä—Ç–∏
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private static String formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return "—É—Ç–æ–Ω—É–ª üíß";
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return "—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ üî•";
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return "—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ üí•";
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return "–≤–∑–æ—Ä–≤–∞–ª—Å—è üí£";
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return "–±—ã–ª —É–±–∏—Ç ‚öîÔ∏è";
        } else if (message.contains("—É–º–µ—Ä") || message.contains("died")) {
            return "—É–º–µ—Ä üíÄ";
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return "—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É üåå";
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return "–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è üòµ";
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return "–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º üèπ";
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return "–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏ üßü";
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return "–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º üí•";
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return "–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º üëÅÔ∏è";
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            return message.isEmpty() ? "—É–º–µ—Ä" : message;
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] joinMessages = {
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        };
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        builder.embedBuilder.setTitle("üéÆ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        String formattedDeath = formatDeathMessage(deathText, playerName);
        
        builder.embedBuilder.setDescription("**" + playerName + "** " + formattedDeath);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FF0000")); // –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —Å–º–µ—Ä—Ç–∏
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private static String formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return "—É—Ç–æ–Ω—É–ª üíß";
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return "—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ üî•";
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return "—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ üí•";
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return "–≤–∑–æ—Ä–≤–∞–ª—Å—è üí£";
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return "–±—ã–ª —É–±–∏—Ç ‚öîÔ∏è";
        } else if (message.contains("—É–º–µ—Ä") || message.contains("died")) {
            return "—É–º–µ—Ä üíÄ";
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return "—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É üåå";
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return "–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è üòµ";
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return "–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º üèπ";
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return "–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏ üßü";
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return "–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º üí•";
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return "–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º üëÅÔ∏è";
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            return message.isEmpty() ? "—É–º–µ—Ä" : message;
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] joinMessages = {
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        };
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        builder.embedBuilder.setTitle("üéÆ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static String formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return "—É—Ç–æ–Ω—É–ª üíß";
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return "—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ üî•";
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return "—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ üí•";
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return "–≤–∑–æ—Ä–≤–∞–ª—Å—è üí£";
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return "–±—ã–ª —É–±–∏—Ç ‚öîÔ∏è";
        } else if (message.contains("—É–º–µ—Ä") || message.contains("died")) {
            return "—É–º–µ—Ä üíÄ";
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return "—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É üåå";
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return "–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è üòµ";
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return "–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º üèπ";
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return "–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏ üßü";
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return "–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º üí•";
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return "–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º üëÅÔ∏è";
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            return message.isEmpty() ? "—É–º–µ—Ä" : message;
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] joinMessages = {
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        };
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        builder.embedBuilder.setTitle("üéÆ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        builder.embedBuilder.setDescription("**" + player.getName().getString() + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("–û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] joinMessages = {
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        };
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        builder.embedBuilder.setTitle("üéÆ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String playerName = player.getName().getString();
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(playerName, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
    }
    
    public void shutdown() {
        if (jda != null) {
            if (technicalChannel != null) {
                technicalChannel.sendMessage("üî¥ **Angella –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n–°–µ—Ä–≤–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω.").queue();
            }
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n–ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤.").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**").queue();
            });
        }
    }
    
    public void onServerStopped() {
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

–£–ª—É—á—à–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
    }
    
    public void shutdown() {
        if (jda != null) {
            if (technicalChannel != null) {
                technicalChannel.sendMessage("üî¥ **Angella –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n–°–µ—Ä–≤–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω.").queue();
            }
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
    }
    
    public void shutdown() {
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –°–æ–æ–±—â–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã: –¥–æ–±–∞–≤–ª–µ–Ω—ã —ç–º–æ–¥–∑–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### –°–æ–æ–±—â–µ–Ω–∏—è —Å—Ç–∞–ª–∏ –±–æ–ª–µ–µ –∂–∏–≤—ã–º–∏:

1. –í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞ ‚Äî —Å–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è:
   - "üéâ **–ò–≥—Ä–æ–∫** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!"
   - "‚ú® **–ò–≥—Ä–æ–∫** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!"
   - –ò –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

2. –í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞ ‚Äî –ø—Ä–æ—â–∞–Ω–∏—è:
   - "üëã **–ò–≥—Ä–æ–∫** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!"
   - "üò¢ **–ò–≥—Ä–æ–∫** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!"

3. –°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞ ‚Äî –¥–µ—Ç–∞–ª–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
   - "–û –Ω–µ—Ç! üò± **–ò–≥—Ä–æ–∫** —É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß *–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*"
   - "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî **–ò–≥—Ä–æ–∫** —Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí• *–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*"
   - –ò –¥—Ä—É–≥–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

4. –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è ‚Äî –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è:
   - "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! **–ò–≥—Ä–æ–∫** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ..."
   - "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! **–ò–≥—Ä–æ–∫** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ..."

5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:
   - "‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!** üéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! ü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!"

### –ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:
`build\libs\angella-1.0.0.jar`

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –°–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –±–æ–ª–µ–µ –∂–∏–≤—ã–µ –∏ —Å —ç–º–æ–¥–∑–∏.

---

**User**

[–°–∏—Å—Ç–µ–º–∞]: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ

WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys

[04:26:58] [main/INFO]: [voicechat] Compatibility version 20

[04:26:58] [main/INFO]: [voicechat] Loading plugins

[04:26:58] [main/INFO]: [voicechat] Loaded 2 plugin(s)

[04:26:58] [main/INFO]: [voicechat] Initializing plugins

[04:26:58] [main/INFO]: Initializing Simple Voice Chat integration

[04:26:58] [main/INFO]: [voicechat] Initialized 2 plugin(s)

[04:26:58] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'

[04:26:58] [main/INFO]: [voicechat] Registering events for 'vcinteraction'

[04:26:58] [main/INFO]: Initializing 'Better Statistics Screen' as 'BetterStatsServer'.

[04:26:58] [main/INFO]: Registering C2S receiver with id betterstats:c2s_bss

[04:26:58] [main/INFO]: Registering C2S receiver with id betterstats:c2s_prf

[04:26:58] [main/INFO]: Registering C2S receiver with id betterstats:c2s_mcbs_req

[04:26:58] [Cicada thread 0/INFO]: [cicada] Merry Christmas!

[04:26:58] [main/INFO]: Initializing Distant Horizons server, firing DhApiBeforeDhInitEvent event...

[04:26:58] [main/INFO]: Distant Horizons, Version: 2.3.6-b

[04:26:58] [main/INFO]: Registering Fabric Server Events

[04:26:58] [main/INFO]: Distant Horizons server Initialized, adding event subscribers...

[04:26:58] [main/INFO]: Krypton is now accelerating your Minecraft server's networking stack üöÄ

[04:26:58] [main/INFO]: Initializing 'TCDCommons API' 4.0.1+fabric-1.21.8 as 'TCDCommonsServer'.

[04:26:58] [main/WARN]: You specified a resource pack without providing a sha1 hash. Pack will be updated on the client only if you change the name of the pack.

[04:26:58] [main/WARN]: resource-pack-id missing, using default of 3a9a9a57-ecf4-3552-abfd-bf753fe6628c

[04:26:58] [main/INFO]: Environment: Environment[sessionHost=https://sessionserver.mojang.com, servicesHost=https://api.minecraftservices.com, name=PROD]

[04:26:58] [main/WARN]: Pack file/BACAP_Enhanced_Discoveries_2.7_Hardcore_Addon.zip declared support for versions [80, 81] but declared main format is 48, defaulting to 48

[04:26:58] [main/INFO]: Generating SERVER_DATA resources

[04:26:58] [main/INFO]: Collected 0 data resources in 61.427208ms

[04:27:05] [main/INFO]: Loaded 1412 recipes

[04:27:05] [main/INFO]: Loaded 6570 advancements

[04:27:05] [Thread-11/INFO]: Loaded 1 translation keys

[04:27:06] [main/INFO]: Applied 0 biome modifications to 0 of 65 new biomes in 1.145 ms

[04:27:06] [Server thread/INFO]: Initialising config for [DistantHorizons]

[04:27:06] [Server thread/INFO]: [DistantHorizons] Config initialised

[04:27:06] [Server thread/WARN]: Multiple potential preset options [BALANCED, LOW_IMPACT], defaulting to the first one.

[04:27:06] [Server thread/INFO]: Running Delayed setup...

[04:27:06] [Server thread/INFO]: Delayed setup complete, firing DhApiAfterDhInitEvent event...

[04:27:06] [Server thread/INFO]: Checking for Distant Horizons update

[04:27:06] [Server thread/INFO]: Distant Horizons already up to date.

[04:27:06] [Server thread/INFO]: Distant Horizons server Initialized at

[04:27:06] [Server thread/INFO]: Started [DhServerWorld] of type [SERVER_ONLY].

[04:27:06] [Server thread/INFO]: Starting minecraft server version 1.21.8

[04:27:06] [Server thread/INFO]: Loading properties

[04:27:06] [Server thread/INFO]: Default game type: SURVIVAL

[04:27:06] [Server thread/INFO]: Generating keypair

[04:27:06] [Server thread/INFO]: Starting Minecraft server on 0.0.0.0:30081

[04:27:06] [Server thread/INFO]: Using epoll channel type

[04:27:06] [Server thread/WARN]: **** SERVER IS RUNNING IN OFFLINE/INSECURE MODE!

[04:27:06] [Server thread/WARN]: The server will make no attempt to authenticate usernames. Beware.

[04:27:06] [Server thread/WARN]: While this makes the game possible to play without internet access, it also opens up the ability for hackers to connect with any username they choose.

[04:27:06] [Server thread/WARN]: To change this, set "online-mode" to "true" in the server.properties file.

[04:27:06] [Server thread/INFO]: Preparing level "Hardcore"

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:overworld]-[./Hardcore/data]...

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[04:27:07] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}] at [[LocalSaveStructure@(./Hardcore/data)]].

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_end]-[./Hardcore/DIM1/data]...

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[04:27:07] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}] at [[LocalSaveStructure@(./Hardcore/DIM1/data;./Hardcore/data)]].

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_nether]-[./Hardcore/DIM-1/data]...

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[04:27:07] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[04:27:07] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}] at [[LocalSaveStructure@(./Hardcore/DIM1/data;./Hardcore/DIM-1/data;./Hardcore/data)]].

[04:27:07] [Server thread/INFO]: Preparing start region for dimension minecraft:overworld

[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: BALANCED

[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: MEDIUM

[04:27:09] [DH-ApplyConfigPresetTimer/WARN]: Multiple potential preset options [BALANCED, LOW_IMPACT], defaulting to the first one.

[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: preset active: BALANCED

[04:27:09] [DH-ApplyConfigPresetTimer/INFO]: preset active: MEDIUM

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:12] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[04:27:13] [Server thread/INFO]: Time elapsed: 5591 ms

[04:27:13] [Server thread/INFO]: Done (6.158s)! For help, type "help"

[04:27:13] [BlueMap-Plugin-Loading/INFO]: Loading BlueMap...

[04:27:13] [Server thread/WARN]: [voicechat] Running in offline mode - Voice chat encryption is not secure!

[04:27:13] [VoiceChatServerThread/INFO]: [voicechat] Using server-ip as bind address: 0.0.0.0

[04:27:13] [VoiceChatServerThread/INFO]: [voicechat] Voice host is '213.171.18.211:30081'

[04:27:13] [VoiceChatServerThread/INFO]: [voicechat] Voice chat server started at 0.0.0.0:30081

[04:27:13] [Server thread/INFO]: DH TerraFirmaCraft detection: false

[04:27:13] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[04:27:13] [Server thread/INFO]: Batch Chunk Generator initialized

[04:27:13] [Server thread/INFO]: Creating world gen queue

[04:27:13] [Server thread/INFO]: Created world gen queue

[04:27:13] [Server thread/INFO]: Set world gen queue for level [minecraft:the_end].

[04:27:13] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[04:27:13] [Server thread/INFO]: Batch Chunk Generator initialized

[04:27:13] [Server thread/INFO]: Creating world gen queue

[04:27:13] [Server thread/INFO]: Created world gen queue

[04:27:13] [Server thread/INFO]: Set world gen queue for level [minecraft:the_nether].

[04:27:13] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[04:27:13] [Server thread/INFO]: Batch Chunk Generator initialized

[04:27:13] [Server thread/INFO]: Creating world gen queue

[04:27:13] [Server thread/INFO]: Created world gen queue

[04:27:13] [Server thread/INFO]: Set world gen queue for level [minecraft:overworld].

[04:27:13] [BlueMap-Plugin-Loading/INFO]: Loading resources...

[04:27:15] [BlueMap-Plugin-Loading/INFO]: Resources loaded.

[04:27:15] [BlueMap-Plugin-Loading/INFO]: Initializing Storage: 'file' (Type: 'bluemap:file')

[04:27:15] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore'...

[04:27:15] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_end'...

[04:27:15] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_nether'...

[04:27:15] [BlueMap-Plugin-Loading/INFO]: WebServer bound to all network interfaces on port 30031

[04:27:15] [Thread-26/INFO]: WebServer started.

[04:27:15] [BlueMap-Plugin-Loading/INFO]: BlueMap loaded!

[04:27:53] [Server thread/INFO]: ASSlover[/178.66.212.202:61195] logged in with entity id 42 at (67.87155264899832, 68.0, -71.08953206612772)

[04:27:53] [Server thread/INFO]: Player [ASSlover] joined.

[04:27:53] [Server thread/INFO]: ASSlover joined the game

[04:27:54] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)

[04:27:54] [Server thread/INFO]: [voicechat] Sent secret to ASSlover

[04:30:11] [Server thread/INFO]: [Not Secure] <ASSlover> 123

[04:49:29] [Netty Epoll Server IO #2/INFO]: Player [ASSlover] disconnected.

[04:49:29] [Server thread/INFO]: ASSlover lost connection: Disconnected

[04:49:29] [Server thread/INFO]: ASSlover left the game

[04:49:29] [Server thread/INFO]: [voicechat] Disconnecting client ASSlover

[04:50:09] [Server thread/INFO]: ASSlover[/178.66.212.202:51829] logged in with entity id 2684 at (55.29524868475999, 68.0, -62.96284016863175)

[04:50:09] [Server thread/INFO]: Player [ASSlover] joined.

[04:50:09] [Server thread/INFO]: ASSlover joined the game

[04:50:09] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)

[04:50:09] [Server thread/INFO]: [voicechat] Sent secret to ASSlover

[04:50:09] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully authenticated player fd952715-538d-3844-b614-71ba8d053b66

[04:50:10] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully validated connection of player fd952715-538d-3844-b614-71ba8d053b66

[04:50:10] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Player ASSlover (fd952715-538d-3844-b614-71ba8d053b66) successfully connected to voice chat

[04:59:42] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:overworld] -> [i0emslgphpdmq@minecraft:the_nether].

[05:02:50] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:the_nether] -> [i0emslgphpdmq@minecraft:overworld].

[05:08:25] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:overworld] -> [i0emslgphpdmq@minecraft:the_nether].

[05:09:37] [Server thread/INFO]: Player [ASSlover] changed level: [i0emslgphpdmq@minecraft:the_nether] -> [i0emslgphpdmq@minecraft:overworld].

[05:38:04] [Netty Epoll Server IO #0/INFO]: Player [ASSlover] disconnected.

[05:38:04] [Server thread/INFO]: ASSlover lost connection: Disconnected

[05:38:04] [Server thread/INFO]: ASSlover left the game

[05:38:04] [Server thread/INFO]: [voicechat] Disconnecting client ASSlover

[05:38:42] [Server thread/INFO]: ASSlover[/178.66.212.202:53278] logged in with entity id 10724 at (-13.088996309336078, 72.0, -13.482843903986907)

[05:38:42] [Server thread/INFO]: Player [ASSlover] joined.

[05:38:42] [Server thread/INFO]: ASSlover joined the game

[05:38:42] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)

[05:38:42] [Server thread/INFO]: [voicechat] Sent secret to ASSlover

[05:38:43] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully authenticated player fd952715-538d-3844-b614-71ba8d053b66

[05:38:44] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully validated connection of player fd952715-538d-3844-b614-71ba8d053b66

[05:38:44] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Player ASSlover (fd952715-538d-3844-b614-71ba8d053b66) successfully connected to voice chat

[05:38:53] [Netty Epoll Server IO #2/INFO]: Player [ASSlover] disconnected.

[05:38:53] [Server thread/INFO]: ASSlover lost connection: Disconnected

[05:38:53] [Server thread/INFO]: ASSlover left the game

[05:38:53] [Server thread/INFO]: [voicechat] Disconnecting client ASSlover

stop

[05:39:34] [Server thread/INFO]: Stopping the server

[05:39:35] [Server thread/INFO]: BlueMap unloaded!

[05:39:35] [Server thread/INFO]: Stopping server

[05:39:35] [Server thread/INFO]: Saving players

[05:39:35] [Server thread/INFO]: Saving worlds

[05:39:35] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:overworld

[05:39:35] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:the_end

[05:39:35] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:the_nether

[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage (Hardcore): All chunks are saved

[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage (DIM1): All chunks are saved

[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage (DIM-1): All chunks are saved

[05:39:35] [Server thread/INFO]: ThreadedAnvilChunkStorage: All dimensions are saved

[05:39:35] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:overworld}

[05:39:35] [Server thread/INFO]: Closing world gen queue

[05:39:35] [Server thread/INFO]: Closing WorldGenerationQueue...

[05:39:35] [Server thread/INFO]: Awaiting world generator thread pool termination...

[05:39:38] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.

[05:39:38] [Server thread/INFO]: BatchGenerator shutting down...

[05:39:38] [Server thread/INFO]: BatchGenerationEnvironment shutting down...

[05:39:38] [Server thread/INFO]: Canceling in progress generation event futures...

[05:39:38] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.

[05:39:38] [Server thread/INFO]: Finished closing WorldGenerationQueue

[05:39:38] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:39:38] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:39:38] [DH-Parent Update Queue [minecraft:overworld] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:overworld] Thread[0]] terminated.

[05:39:38] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/data/DistantHorizons.sqlite]...

[05:39:38] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/data/DistantHorizons.sqlite]

[05:39:38] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}].

[05:39:38] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:39:38] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:39:38] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}].

[05:39:38] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:the_end}

[05:39:38] [Server thread/INFO]: Closing world gen queue

[05:39:38] [Server thread/INFO]: Closing WorldGenerationQueue...

[05:39:38] [Server thread/INFO]: Awaiting world generator thread pool termination...

[05:39:41] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.

[05:39:41] [Server thread/INFO]: BatchGenerator shutting down...

[05:39:41] [Server thread/INFO]: BatchGenerationEnvironment shutting down...

[05:39:41] [Server thread/INFO]: Canceling in progress generation event futures...

[05:39:41] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.

[05:39:41] [Server thread/INFO]: Finished closing WorldGenerationQueue

[05:39:41] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:39:41] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:39:41] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM1/data/DistantHorizons.sqlite]...

[05:39:41] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM1/data/DistantHorizons.sqlite]

[05:39:41] [DH-Parent Update Queue [minecraft:the_end] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:the_end] Thread[0]] terminated.

[05:39:41] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}].

[05:39:42] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:39:42] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:39:42] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}].

[05:39:42] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:the_nether}

[05:39:42] [Server thread/INFO]: Closing world gen queue

[05:39:42] [Server thread/INFO]: Closing WorldGenerationQueue...

[05:39:42] [Server thread/INFO]: Awaiting world generator thread pool termination...

[05:39:45] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.

[05:39:45] [Server thread/INFO]: BatchGenerator shutting down...

[05:39:45] [Server thread/INFO]: BatchGenerationEnvironment shutting down...

[05:39:45] [Server thread/INFO]: Canceling in progress generation event futures...

[05:39:45] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.

[05:39:45] [Server thread/INFO]: Finished closing WorldGenerationQueue

[05:39:45] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:39:45] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:39:45] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM-1/data/DistantHorizons.sqlite]...

[05:39:45] [DH-Parent Update Queue [minecraft:the_nether] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:the_nether] Thread[0]] terminated.

[05:39:45] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM-1/data/DistantHorizons.sqlite]

[05:39:45] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}].

[05:39:45] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:39:45] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:39:45] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}].

[05:39:45] [Server thread/INFO]: Closed DhWorld of type [SERVER_ONLY].

[05:39:45] [Server thread/INFO]: Closed DhWorld of type [SERVER_ONLY].

[05:39:45] [Server thread/INFO]: Shutting down PriorityTaskPicker thread pool...

[05:39:45] [Server thread/INFO]: Closing all [0] database connections...

[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

Status: Image is up to date for hosthub/openjdk:23

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:39:49] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:39:49] [main/INFO]: Loading 112 mods:

- angella 1.0.0

\-- com_google_code_gson_gson 2.10.1

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:39:49] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:39:49] [main/INFO]: Compatibility level set to JAVA_21

[05:39:49] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:39:49] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:39:49] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:39:49] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:39:50] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:39:53] [main/ERROR]: Minecraft has crashed!

net.fabricmc.loader.impl.FormattedException: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed

at net.fabricmc.loader.impl.FormattedException.ofLocalized(FormattedException.java:63) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:516) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]

Caused by: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

Caused by: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:440) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

Caused by: org.spongepowered.asm.mixin.transformer.throwables.MixinTransformerError: An unexpected critical error was encountered

at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:381) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

Caused by: org.spongepowered.asm.mixin.injection.throwables.InjectionError: Critical injection failure: Callback method onPlayerDeath(Lnet/minecraft/class_1282;Lorg/spongepowered/asm/mixin/injection/callback/CallbackInfo;)V in angella.mixins.json:ServerPlayerEntityMixin from mod angella failed injection check, (0/1) succeeded. Scanned 0 target(s). Using refmap angella-refmap.json

at org.spongepowered.asm.mixin.injection.struct.InjectionInfo.postInject(InjectionInfo.java:531) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTargetContext.applyInjections(MixinTargetContext.java:1490) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyInjections(MixinApplicatorStandard.java:752) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyMixin(MixinApplicatorStandard.java:330) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.apply(MixinApplicatorStandard.java:246) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.TargetClassContext.apply(TargetClassContext.java:437) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.TargetClassContext.applyMixins(TargetClassContext.java:418) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:352) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------

[Hermes Daemon]: Exit code: 1

[Hermes Daemon]: Out of memory: false

[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

Status: Image is up to date for hosthub/openjdk:23

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:39:56] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:39:56] [main/INFO]: Loading 112 mods:

- angella 1.0.0

\-- com_google_code_gson_gson 2.10.1

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:39:56] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:39:56] [main/INFO]: Compatibility level set to JAVA_21

[05:39:57] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:39:57] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:39:57] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:39:57] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:39:57] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:40:01] [main/ERROR]: Minecraft has crashed!

net.fabricmc.loader.impl.FormattedException: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed

at net.fabricmc.loader.impl.FormattedException.ofLocalized(FormattedException.java:63) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:516) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]

Caused by: java.lang.BootstrapMethodError: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

Caused by: java.lang.RuntimeException: Mixin transformation of net.minecraft.class_3222 failed

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:440) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

Caused by: org.spongepowered.asm.mixin.transformer.throwables.MixinTransformerError: An unexpected critical error was encountered

at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:381) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

Caused by: org.spongepowered.asm.mixin.injection.throwables.InjectionError: Critical injection failure: Callback method onPlayerDeath(Lnet/minecraft/class_1282;Lorg/spongepowered/asm/mixin/injection/callback/CallbackInfo;)V in angella.mixins.json:ServerPlayerEntityMixin from mod angella failed injection check, (0/1) succeeded. Scanned 0 target(s). Using refmap angella-refmap.json

at org.spongepowered.asm.mixin.injection.struct.InjectionInfo.postInject(InjectionInfo.java:531) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTargetContext.applyInjections(MixinTargetContext.java:1490) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyInjections(MixinApplicatorStandard.java:752) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.applyMixin(MixinApplicatorStandard.java:330) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinApplicatorStandard.apply(MixinApplicatorStandard.java:246) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.TargetClassContext.apply(TargetClassContext.java:437) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.TargetClassContext.applyMixins(TargetClassContext.java:418) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinProcessor.applyMixins(MixinProcessor.java:352) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClass(MixinTransformer.java:237) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at org.spongepowered.asm.mixin.transformer.MixinTransformer.transformClassBytes(MixinTransformer.java:202) ~[sponge-mixin-0.16.5+mixin.0.8.7.jar:0.16.5+mixin.0.8.7]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.getPostMixinClassByteArray(KnotClassDelegate.java:435) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.tryLoadClass(KnotClassDelegate.java:336) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:231) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.minecraft.class_1299.<clinit>(class_1299.java:207) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_10192.method_64017(class_10192.java:78) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63920(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63752(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63751(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_51348(class_1802.java:1615) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_63748(class_1802.java:1591) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_7993(class_1802.java:1587) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.method_58096(class_1802.java:1572) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_1802.<clinit>(class_1802.java:555) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_6089.method_9530(class_6089.java:65) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26172(class_4970.java:1104) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26218(class_4970.java:1100) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970.method_9549(class_4970.java:363) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971$class_3752.<init>(class_4970.java:1379) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_4970$class_4971.method_26200(class_4970.java:915) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2246.<clinit>(class_2246.java:1334) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2358.method_10199(class_2358.java:331) ~[server-intermediary.jar:?]

at knot/net.minecraft.class_2966.method_12851(class_2966.java:55) ~[server-intermediary.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:111) ~[server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) ~[fabric-loader-0.18.0.jar:?]

... 4 more

[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------

[Hermes Daemon]: Exit code: 1

[Hermes Daemon]: Out of memory: false

[Hermes Daemon]: Aborting automatic restart, last crash occurred less than 60 seconds ago.

[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

Status: Image is up to date for hosthub/openjdk:23

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:43:34] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:43:34] [main/INFO]: Loading 112 mods:

- angella 1.0.0

\-- com_google_code_gson_gson 2.10.1

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:43:34] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:43:34] [main/INFO]: Compatibility level set to JAVA_21

[05:43:34] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:43:34] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:43:34] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:43:34] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:43:35] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:43:40] [main/INFO]: Initializing Angella Discord Integration Mod

[05:43:40] [main/INFO]: Initializing Discord webhooks...

[05:43:40] [main/INFO]: Technical webhook configured

[05:43:40] [main/INFO]: Game webhook configured

[05:43:40] [main/INFO]: Discord webhooks initialized!

[05:43:40] [main/INFO]: Discord webhooks initialized successfully!

[05:43:40] [main/INFO]: Advancement event handler registered (may require custom implementation)

[05:43:40] [main/INFO]: Loading Collective version 8.11.

[05:43:40] [main/INFO]: Compression will use libdeflate (Linux x86_64), encryption will use OpenSSL 3.x.x (Linux x86_64)

–¥–µ–∫. 01, 2025 5:43:40 AM org.mineskin.ClientBuilder build

WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys

[05:43:40] [main/INFO]: [voicechat] Compatibility version 20

[05:43:40] [main/INFO]: [voicechat] Loading plugins

[05:43:40] [main/INFO]: [voicechat] Loaded 2 plugin(s)

[05:43:40] [main/INFO]: [voicechat] Initializing plugins

[05:43:40] [main/INFO]: Initializing Simple Voice Chat integration

[05:43:40] [main/INFO]: [voicechat] Initialized 2 plugin(s)

[05:43:40] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'

[05:43:40] [main/INFO]: [voicechat] Registering events for 'vcinteraction'

[05:43:40] [main/INFO]: Initializing 'Better Statistics Screen' as 'BetterStatsServer'.

[05:43:40] [main/INFO]: Registering C2S receiver with id betterstats:c2s_bss

[05:43:40] [main/INFO]: Registering C2S receiver with id betterstats:c2s_prf

[05:43:40] [main/INFO]: Registering C2S receiver with id betterstats:c2s_mcbs_req

[05:43:40] [main/INFO]: Initializing Distant Horizons server, firing DhApiBeforeDhInitEvent event...

[05:43:40] [main/INFO]: Distant Horizons, Version: 2.3.6-b

[05:43:40] [main/INFO]: Registering Fabric Server Events

[05:43:40] [main/INFO]: Distant Horizons server Initialized, adding event subscribers...

[05:43:40] [main/INFO]: Krypton is now accelerating your Minecraft server's networking stack üöÄ

[05:43:40] [main/INFO]: Initializing 'TCDCommons API' 4.0.1+fabric-1.21.8 as 'TCDCommonsServer'.

[05:43:41] [Cicada thread 0/INFO]: [cicada] Merry Christmas!

[05:43:41] [main/WARN]: You specified a resource pack without providing a sha1 hash. Pack will be updated on the client only if you change the name of the pack.

[05:43:41] [main/WARN]: resource-pack-id missing, using default of 3a9a9a57-ecf4-3552-abfd-bf753fe6628c

[05:43:41] [main/INFO]: Environment: Environment[sessionHost=https://sessionserver.mojang.com, servicesHost=https://api.minecraftservices.com, name=PROD]

[05:43:41] [main/WARN]: Pack file/BACAP_Enhanced_Discoveries_2.7_Hardcore_Addon.zip declared support for versions [80, 81] but declared main format is 48, defaulting to 48

[05:43:41] [main/WARN]: Missing data pack server_translations_api

[05:43:41] [main/INFO]: Generating SERVER_DATA resources

[05:43:41] [main/INFO]: Collected 0 data resources in 53.481220ms

[05:43:47] [main/INFO]: Loaded 1412 recipes

[05:43:47] [main/INFO]: Loaded 6570 advancements

[05:43:47] [main/INFO]: Applied 0 biome modifications to 0 of 65 new biomes in 851.9 Œºs

[05:43:47] [Server thread/INFO]: Initialising config for [DistantHorizons]

[05:43:47] [Server thread/INFO]: [DistantHorizons] Config initialised

[05:43:47] [Server thread/WARN]: Multiple potential preset options [LOW_IMPACT, BALANCED], defaulting to the first one.

[05:43:47] [Server thread/INFO]: Running Delayed setup...

[05:43:47] [Server thread/INFO]: Delayed setup complete, firing DhApiAfterDhInitEvent event...

[05:43:47] [Server thread/INFO]: Checking for Distant Horizons update

[05:43:48] [Server thread/INFO]: Distant Horizons already up to date.

[05:43:48] [Server thread/INFO]: Distant Horizons server Initialized at

[05:43:48] [Server thread/INFO]: Started [DhServerWorld] of type [SERVER_ONLY].

[05:43:48] [Server thread/INFO]: Starting minecraft server version 1.21.8

[05:43:48] [Server thread/INFO]: Loading properties

[05:43:48] [Server thread/INFO]: Default game type: SURVIVAL

[05:43:48] [Server thread/INFO]: Generating keypair

[05:43:48] [Server thread/INFO]: Starting Minecraft server on 0.0.0.0:30081

[05:43:48] [Server thread/INFO]: Using epoll channel type

[05:43:48] [Server thread/WARN]: **** SERVER IS RUNNING IN OFFLINE/INSECURE MODE!

[05:43:48] [Server thread/WARN]: The server will make no attempt to authenticate usernames. Beware.

[05:43:48] [Server thread/WARN]: While this makes the game possible to play without internet access, it also opens up the ability for hackers to connect with any username they choose.

[05:43:48] [Server thread/WARN]: To change this, set "online-mode" to "true" in the server.properties file.

[05:43:48] [Server thread/INFO]: Preparing level "Hardcore"

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:overworld]-[./Hardcore/data]...

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[05:43:48] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}] at [[LocalSaveStructure@(./Hardcore/data)]].

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_end]-[./Hardcore/DIM1/data]...

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[05:43:48] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}] at [[LocalSaveStructure@(./Hardcore/data;./Hardcore/DIM1/data)]].

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_nether]-[./Hardcore/DIM-1/data]...

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[05:43:48] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}] at [[LocalSaveStructure@(./Hardcore/data;./Hardcore/DIM-1/data;./Hardcore/DIM1/data)]].

[05:43:48] [Server thread/INFO]: Preparing start region for dimension minecraft:overworld

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: LOW_IMPACT

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: MEDIUM

[05:43:50] [DH-ApplyConfigPresetTimer/WARN]: Multiple potential preset options [LOW_IMPACT, BALANCED], defaulting to the first one.

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: preset active: LOW_IMPACT

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: preset active: MEDIUM

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Server thread/INFO]: Time elapsed: 5326 ms

[05:43:54] [Server thread/INFO]: Done (5.816s)! For help, type "help"

[05:43:54] [BlueMap-Plugin-Loading/INFO]: Loading BlueMap...

[05:43:54] [Server thread/WARN]: [voicechat] Running in offline mode - Voice chat encryption is not secure!

[05:43:54] [VoiceChatServerThread/INFO]: [voicechat] Using server-ip as bind address: 0.0.0.0

[05:43:54] [VoiceChatServerThread/INFO]: [voicechat] Voice host is '213.171.18.211:30081'

[05:43:54] [VoiceChatServerThread/INFO]: [voicechat] Voice chat server started at 0.0.0.0:30081

[05:43:54] [Server thread/INFO]: DH TerraFirmaCraft detection: false

[05:43:54] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[05:43:54] [Server thread/INFO]: Batch Chunk Generator initialized

[05:43:54] [Server thread/INFO]: Creating world gen queue

[05:43:54] [Server thread/INFO]: Created world gen queue

[05:43:54] [Server thread/INFO]: Set world gen queue for level [minecraft:overworld].

[05:43:54] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[05:43:54] [Server thread/INFO]: Batch Chunk Generator initialized

[05:43:54] [Server thread/INFO]: Creating world gen queue

[05:43:54] [Server thread/INFO]: Created world gen queue

[05:43:54] [Server thread/INFO]: Set world gen queue for level [minecraft:the_nether].

[05:43:54] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[05:43:54] [Server thread/INFO]: Batch Chunk Generator initialized

[05:43:54] [Server thread/INFO]: Creating world gen queue

[05:43:54] [Server thread/INFO]: Created world gen queue

[05:43:54] [Server thread/INFO]: Set world gen queue for level [minecraft:the_end].

[05:43:54] [BlueMap-Plugin-Loading/INFO]: Loading resources...

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Resources loaded.

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Initializing Storage: 'file' (Type: 'bluemap:file')

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore'...

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_end'...

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_nether'...

[05:43:57] [BlueMap-Plugin-Loading/INFO]: WebServer bound to all network interfaces on port 30031

[05:43:57] [Thread-27/INFO]: WebServer started.

[05:43:57] [BlueMap-Plugin-Loading/INFO]: BlueMap loaded!

[05:44:54] [Server thread/INFO]: pause-when-empty-seconds rule set, pausing server at 4903405, 5438736

[05:44:54] [Server thread/INFO]: Server empty for 60 seconds, pausing

[05:46:11] [Server thread/INFO]: ASSlover[/178.66.212.202:53452] logged in with entity id 37 at (-13.088996309336078, 72.0, -13.482843903986907)

[05:46:11] [Server thread/INFO]: Player [ASSlover] joined.

[05:46:11] [Server thread/INFO]: ASSlover joined the game

[05:46:12] [Server thread/INFO]: Unpausing server: onPlayerLogin, 0:01:18 at 4903405, 5438736

[05:46:12] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)

[05:46:12] [Server thread/INFO]: [voicechat] Sent secret to ASSlover

[05:46:12] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully authenticated player fd952715-538d-3844-b614-71ba8d053b66

[05:46:13] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully validated connection of player fd952715-538d-3844-b614-71ba8d053b66

[05:46:13] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Player ASSlover (fd952715-538d-3844-b614-71ba8d053b66) successfully connected to voice chat

[05:47:00] [Server thread/INFO]: [Not Secure] <ASSlover> 321

[–°–∏—Å—Ç–µ–º–∞]: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:43:34] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:43:34] [main/INFO]: Compatibility level set to JAVA_21

[05:43:34] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:43:34] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:43:34] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:43:34] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:43:35] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:43:40] [main/INFO]: Initializing Angella Discord Integration Mod

[05:43:40] [main/INFO]: Initializing Discord webhooks...

[05:43:40] [main/INFO]: Technical webhook configured

[05:43:40] [main/INFO]: Game webhook configured

[05:43:40] [main/INFO]: Discord webhooks initialized!

[05:43:40] [main/INFO]: Discord webhooks initialized successfully!

[05:43:40] [main/INFO]: Advancement event handler registered (may require custom implementation)

[05:43:40] [main/INFO]: Loading Collective version 8.11.

[05:43:40] [main/INFO]: Compression will use libdeflate (Linux x86_64), encryption will use OpenSSL 3.x.x (Linux x86_64)

–¥–µ–∫. 01, 2025 5:43:40 AM org.mineskin.ClientBuilder build

WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys

[05:43:40] [main/INFO]: [voicechat] Compatibility version 20

[05:43:40] [main/INFO]: [voicechat] Loading plugins

[05:43:40] [main/INFO]: [voicechat] Loaded 2 plugin(s)

[05:43:40] [main/INFO]: [voicechat] Initializing plugins

[05:43:40] [main/INFO]: Initializing Simple Voice Chat integration

[05:43:40] [main/INFO]: [voicechat] Initialized 2 plugin(s)

[05:43:40] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'

[05:43:40] [main/INFO]: [voicechat] Registering events for 'vcinteraction'

[05:43:40] [main/INFO]: Initializing 'Better Statistics Screen' as 'BetterStatsServer'.

[05:43:40] [main/INFO]: Registering C2S receiver with id betterstats:c2s_bss

[05:43:40] [main/INFO]: Registering C2S receiver with id betterstats:c2s_prf

[05:43:40] [main/INFO]: Registering C2S receiver with id betterstats:c2s_mcbs_req

[05:43:40] [main/INFO]: Initializing Distant Horizons server, firing DhApiBeforeDhInitEvent event...

[05:43:40] [main/INFO]: Distant Horizons, Version: 2.3.6-b

[05:43:40] [main/INFO]: Registering Fabric Server Events

[05:43:40] [main/INFO]: Distant Horizons server Initialized, adding event subscribers...

[05:43:40] [main/INFO]: Krypton is now accelerating your Minecraft server's networking stack üöÄ

[05:43:40] [main/INFO]: Initializing 'TCDCommons API' 4.0.1+fabric-1.21.8 as 'TCDCommonsServer'.

[05:43:41] [Cicada thread 0/INFO]: [cicada] Merry Christmas!

[05:43:41] [main/WARN]: You specified a resource pack without providing a sha1 hash. Pack will be updated on the client only if you change the name of the pack.

[05:43:41] [main/WARN]: resource-pack-id missing, using default of 3a9a9a57-ecf4-3552-abfd-bf753fe6628c

[05:43:41] [main/INFO]: Environment: Environment[sessionHost=https://sessionserver.mojang.com, servicesHost=https://api.minecraftservices.com, name=PROD]

[05:43:41] [main/WARN]: Pack file/BACAP_Enhanced_Discoveries_2.7_Hardcore_Addon.zip declared support for versions [80, 81] but declared main format is 48, defaulting to 48

[05:43:41] [main/WARN]: Missing data pack server_translations_api

[05:43:41] [main/INFO]: Generating SERVER_DATA resources

[05:43:41] [main/INFO]: Collected 0 data resources in 53.481220ms

[05:43:47] [main/INFO]: Loaded 1412 recipes

[05:43:47] [main/INFO]: Loaded 6570 advancements

[05:43:47] [main/INFO]: Applied 0 biome modifications to 0 of 65 new biomes in 851.9 Œºs

[05:43:47] [Server thread/INFO]: Initialising config for [DistantHorizons]

[05:43:47] [Server thread/INFO]: [DistantHorizons] Config initialised

[05:43:47] [Server thread/WARN]: Multiple potential preset options [LOW_IMPACT, BALANCED], defaulting to the first one.

[05:43:47] [Server thread/INFO]: Running Delayed setup...

[05:43:47] [Server thread/INFO]: Delayed setup complete, firing DhApiAfterDhInitEvent event...

[05:43:47] [Server thread/INFO]: Checking for Distant Horizons update

[05:43:48] [Server thread/INFO]: Distant Horizons already up to date.

[05:43:48] [Server thread/INFO]: Distant Horizons server Initialized at

[05:43:48] [Server thread/INFO]: Started [DhServerWorld] of type [SERVER_ONLY].

[05:43:48] [Server thread/INFO]: Starting minecraft server version 1.21.8

[05:43:48] [Server thread/INFO]: Loading properties

[05:43:48] [Server thread/INFO]: Default game type: SURVIVAL

[05:43:48] [Server thread/INFO]: Generating keypair

[05:43:48] [Server thread/INFO]: Starting Minecraft server on 0.0.0.0:30081

[05:43:48] [Server thread/INFO]: Using epoll channel type

[05:43:48] [Server thread/WARN]: **** SERVER IS RUNNING IN OFFLINE/INSECURE MODE!

[05:43:48] [Server thread/WARN]: The server will make no attempt to authenticate usernames. Beware.

[05:43:48] [Server thread/WARN]: While this makes the game possible to play without internet access, it also opens up the ability for hackers to connect with any username they choose.

[05:43:48] [Server thread/WARN]: To change this, set "online-mode" to "true" in the server.properties file.

[05:43:48] [Server thread/INFO]: Preparing level "Hardcore"

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:overworld]-[./Hardcore/data]...

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[05:43:48] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}] at [[LocalSaveStructure@(./Hardcore/data)]].

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_end]-[./Hardcore/DIM1/data]...

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[05:43:48] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}] at [[LocalSaveStructure@(./Hardcore/data;./Hardcore/DIM1/data)]].

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Attempting to migrate data sources for: [minecraft:the_nether]-[./Hardcore/DIM-1/data]...

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: Found [0] data sources that need migration.

[05:43:48] [DH-Full Data Migration Thread[0]/INFO]: No migration necessary.

[05:43:48] [Server thread/INFO]: Started DhServerLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}] at [[LocalSaveStructure@(./Hardcore/data;./Hardcore/DIM-1/data;./Hardcore/DIM1/data)]].

[05:43:48] [Server thread/INFO]: Preparing start region for dimension minecraft:overworld

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: LOW_IMPACT

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: changing preset to: MEDIUM

[05:43:50] [DH-ApplyConfigPresetTimer/WARN]: Multiple potential preset options [LOW_IMPACT, BALANCED], defaulting to the first one.

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: preset active: LOW_IMPACT

[05:43:50] [DH-ApplyConfigPresetTimer/INFO]: preset active: MEDIUM

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Worker-Main-1/INFO]: Preparing spawn area: 0%

[05:43:54] [Server thread/INFO]: Time elapsed: 5326 ms

[05:43:54] [Server thread/INFO]: Done (5.816s)! For help, type "help"

[05:43:54] [BlueMap-Plugin-Loading/INFO]: Loading BlueMap...

[05:43:54] [Server thread/WARN]: [voicechat] Running in offline mode - Voice chat encryption is not secure!

[05:43:54] [VoiceChatServerThread/INFO]: [voicechat] Using server-ip as bind address: 0.0.0.0

[05:43:54] [VoiceChatServerThread/INFO]: [voicechat] Voice host is '213.171.18.211:30081'

[05:43:54] [VoiceChatServerThread/INFO]: [voicechat] Voice chat server started at 0.0.0.0:30081

[05:43:54] [Server thread/INFO]: DH TerraFirmaCraft detection: false

[05:43:54] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[05:43:54] [Server thread/INFO]: Batch Chunk Generator initialized

[05:43:54] [Server thread/INFO]: Creating world gen queue

[05:43:54] [Server thread/INFO]: Created world gen queue

[05:43:54] [Server thread/INFO]: Set world gen queue for level [minecraft:overworld].

[05:43:54] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[05:43:54] [Server thread/INFO]: Batch Chunk Generator initialized

[05:43:54] [Server thread/INFO]: Creating world gen queue

[05:43:54] [Server thread/INFO]: Created world gen queue

[05:43:54] [Server thread/INFO]: Set world gen queue for level [minecraft:the_nether].

[05:43:54] [Server thread/INFO]: ================WORLD_GEN_STEP_INITING=============

[05:43:54] [Server thread/INFO]: Batch Chunk Generator initialized

[05:43:54] [Server thread/INFO]: Creating world gen queue

[05:43:54] [Server thread/INFO]: Created world gen queue

[05:43:54] [Server thread/INFO]: Set world gen queue for level [minecraft:the_end].

[05:43:54] [BlueMap-Plugin-Loading/INFO]: Loading resources...

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Resources loaded.

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Initializing Storage: 'file' (Type: 'bluemap:file')

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore'...

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_end'...

[05:43:56] [BlueMap-Plugin-Loading/INFO]: Loading map 'hardcore_the_nether'...

[05:43:57] [BlueMap-Plugin-Loading/INFO]: WebServer bound to all network interfaces on port 30031

[05:43:57] [Thread-27/INFO]: WebServer started.

[05:43:57] [BlueMap-Plugin-Loading/INFO]: BlueMap loaded!

[05:44:54] [Server thread/INFO]: pause-when-empty-seconds rule set, pausing server at 4903405, 5438736

[05:44:54] [Server thread/INFO]: Server empty for 60 seconds, pausing

[05:46:11] [Server thread/INFO]: ASSlover[/178.66.212.202:53452] logged in with entity id 37 at (-13.088996309336078, 72.0, -13.482843903986907)

[05:46:11] [Server thread/INFO]: Player [ASSlover] joined.

[05:46:11] [Server thread/INFO]: ASSlover joined the game

[05:46:12] [Server thread/INFO]: Unpausing server: onPlayerLogin, 0:01:18 at 4903405, 5438736

[05:46:12] [Server thread/INFO]: [voicechat] Received secret request of ASSlover (20)

[05:46:12] [Server thread/INFO]: [voicechat] Sent secret to ASSlover

[05:46:12] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully authenticated player fd952715-538d-3844-b614-71ba8d053b66

[05:46:13] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Successfully validated connection of player fd952715-538d-3844-b614-71ba8d053b66

[05:46:13] [VoiceChatPacketProcessingThread/INFO]: [voicechat] Player ASSlover (fd952715-538d-3844-b614-71ba8d053b66) successfully connected to voice chat

[05:47:00] [Server thread/INFO]: [Not Secure] <ASSlover> 321

stop

[05:52:42] [Server thread/INFO]: Stopping the server

[05:52:42] [Netty Epoll Server IO #2/INFO]: Player [ASSlover] disconnected.

[05:52:43] [Server thread/INFO]: BlueMap unloaded!

[05:52:43] [Server thread/INFO]: Stopping server

[05:52:43] [Server thread/INFO]: Saving players

[05:52:43] [Server thread/INFO]: ASSlover lost connection: Server closed

[05:52:43] [Server thread/INFO]: ASSlover left the game

[05:52:43] [Server thread/INFO]: Saving worlds

[05:52:43] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:overworld

[05:52:43] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:the_end

[05:52:43] [Server thread/INFO]: Saving chunks for level 'ServerLevel[Hardcore]'/minecraft:the_nether

[05:52:43] [Server thread/INFO]: ThreadedAnvilChunkStorage (Hardcore): All chunks are saved

[05:52:43] [Server thread/INFO]: ThreadedAnvilChunkStorage (DIM1): All chunks are saved

[05:52:43] [Server thread/INFO]: ThreadedAnvilChunkStorage (DIM-1): All chunks are saved

[05:52:43] [Server thread/INFO]: ThreadedAnvilChunkStorage: All dimensions are saved

[05:52:43] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:overworld}

[05:52:43] [Server thread/INFO]: Closing world gen queue

[05:52:43] [Server thread/INFO]: Closing WorldGenerationQueue...

[05:52:43] [Server thread/INFO]: Awaiting world generator thread pool termination...

[05:52:46] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.

[05:52:46] [Server thread/INFO]: BatchGenerator shutting down...

[05:52:46] [Server thread/INFO]: BatchGenerationEnvironment shutting down...

[05:52:46] [Server thread/INFO]: Canceling in progress generation event futures...

[05:52:46] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.

[05:52:46] [Server thread/INFO]: Finished closing WorldGenerationQueue

[05:52:46] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:52:46] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:52:46] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/data/DistantHorizons.sqlite]...

[05:52:46] [DH-Parent Update Queue [minecraft:overworld] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:overworld] Thread[0]] terminated.

[05:52:46] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/data/DistantHorizons.sqlite]

[05:52:46] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}].

[05:52:46] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:52:46] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:overworld}].

[05:52:46] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:overworld}].

[05:52:46] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:the_end}

[05:52:46] [Server thread/INFO]: Closing world gen queue

[05:52:46] [Server thread/INFO]: Closing WorldGenerationQueue...

[05:52:46] [Server thread/INFO]: Awaiting world generator thread pool termination...

[05:52:49] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.

[05:52:49] [Server thread/INFO]: BatchGenerator shutting down...

[05:52:49] [Server thread/INFO]: BatchGenerationEnvironment shutting down...

[05:52:49] [Server thread/INFO]: Canceling in progress generation event futures...

[05:52:49] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.

[05:52:49] [Server thread/INFO]: Finished closing WorldGenerationQueue

[05:52:49] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:52:49] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:52:49] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM1/data/DistantHorizons.sqlite]...

[05:52:49] [DH-Parent Update Queue [minecraft:the_end] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:the_end] Thread[0]] terminated.

[05:52:49] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM1/data/DistantHorizons.sqlite]

[05:52:49] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}].

[05:52:49] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:52:49] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_end}].

[05:52:49] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_end}].

[05:52:49] [Server thread/INFO]: Unloading level DhServerLevel{i0emslgphpdmq@minecraft:the_nether}

[05:52:49] [Server thread/INFO]: Closing world gen queue

[05:52:49] [Server thread/INFO]: Closing WorldGenerationQueue...

[05:52:49] [Server thread/INFO]: Awaiting world generator thread pool termination...

[05:52:52] [Server thread/WARN]: World generator thread pool shutdown didn't complete after [3] seconds. Some world generator requests may still be running.

[05:52:52] [Server thread/INFO]: BatchGenerator shutting down...

[05:52:52] [Server thread/INFO]: BatchGenerationEnvironment shutting down...

[05:52:52] [Server thread/INFO]: Canceling in progress generation event futures...

[05:52:52] [Server thread/INFO]: BatchGenerationEnvironment shutdown complete.

[05:52:52] [Server thread/INFO]: Finished closing WorldGenerationQueue

[05:52:53] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:52:53] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:52:53] [Server thread/INFO]: Closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM-1/data/DistantHorizons.sqlite]...

[05:52:53] [DH-Parent Update Queue [minecraft:the_nether] Thread[0]/INFO]: Update thread [DH-Parent Update Queue [minecraft:the_nether] Thread[0]] terminated.

[05:52:53] [Server thread/INFO]: Finished closing database connection: [jdbc:dh_sqlite:./Hardcore/DIM-1/data/DistantHorizons.sqlite]

[05:52:53] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}].

[05:52:53] [Server thread/INFO]: Closing [GeneratedFullDataSourceProvider] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:52:53] [Server thread/INFO]: Closing [FullDataSourceProviderV1] for level: [DhServerLevel{i0emslgphpdmq@minecraft:the_nether}].

[05:52:53] [Server thread/INFO]: Closed DHLevel for [Wrapped{ServerLevel[Hardcore]@minecraft:the_nether}].

[05:52:53] [Server thread/INFO]: Discord webhooks shutdown complete.

[05:52:53] [Server thread/INFO]: Closed DhWorld of type [SERVER_ONLY].

[05:52:53] [Server thread/INFO]: Closed DhWorld of type [SERVER_ONLY].

[05:52:53] [Server thread/INFO]: Shutting down PriorityTaskPicker thread pool...

[05:52:53] [Server thread/INFO]: Closing all [0] database connections...

[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

Status: Image is up to date for hosthub/openjdk:23

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:52:59] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:52:59] [main/INFO]: Loading 113 mods:

- angella 1.0.0

|-- com_google_code_gson_gson 2.10.1

\-- net_dv8tion_jda 5.1.1

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:53:00] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:53:00] [main/INFO]: Compatibility level set to JAVA_21

[05:53:00] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:53:00] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:53:00] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:53:00] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:53:00] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:53:05] [main/INFO]: Initializing Angella Discord Integration Mod

[05:53:05] [main/INFO]: Starting Discord bot...

[05:53:05] [main/INFO]: Loading Collective version 8.11.

[05:53:05] [main/INFO]: Compression will use libdeflate (Linux x86_64), encryption will use OpenSSL 3.x.x (Linux x86_64)

–¥–µ–∫. 01, 2025 5:53:06 AM org.mineskin.ClientBuilder build

WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys

[05:53:06] [main/INFO]: [voicechat] Compatibility version 20

[05:53:06] [main/INFO]: [voicechat] Loading plugins

[05:53:06] [main/INFO]: [voicechat] Loaded 2 plugin(s)

[05:53:06] [main/INFO]: [voicechat] Initializing plugins

[05:53:06] [main/INFO]: Initializing Simple Voice Chat integration

[05:53:06] [main/INFO]: [voicechat] Initialized 2 plugin(s)

[05:53:06] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'

[05:53:06] [main/INFO]: [voicechat] Registering events for 'vcinteraction'

[05:53:06] [main/ERROR]: Failed to start the minecraft server

java.lang.RuntimeException: Could not execute entrypoint stage 'main' due to errors, provided by 'angella' at 'com.angella.AngellaMod'!

at net.fabricmc.loader.impl.FabricLoaderImpl.lambda$invokeEntrypoints$0(FabricLoaderImpl.java:409) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.util.ExceptionUtil.gatherExceptions(ExceptionUtil.java:33) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:407) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.game.minecraft.Hooks.startServer(Hooks.java:63) ~[fabric-loader-0.18.0.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:114) [server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]

Caused by: java.lang.NoClassDefFoundError: okhttp3/Dispatcher

at knot/net.dv8tion.jda.internal.utils.IOUtil.newHttpClientBuilder(IOUtil.java:106) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/net.dv8tion.jda.api.JDABuilder.build(JDABuilder.java:1807) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/com.angella.discord.DiscordBot.start(DiscordBot.java:37) ~[angella-1.0.0.jar:?]

at knot/com.angella.AngellaMod.onInitialize(AngellaMod.java:29) ~[angella-1.0.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:405) ~[fabric-loader-0.18.0.jar:?]

... 7 more

Caused by: java.lang.ClassNotFoundException: okhttp3.Dispatcher

at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641) ~[?:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:239) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.dv8tion.jda.internal.utils.IOUtil.newHttpClientBuilder(IOUtil.java:106) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/net.dv8tion.jda.api.JDABuilder.build(JDABuilder.java:1807) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/com.angella.discord.DiscordBot.start(DiscordBot.java:37) ~[angella-1.0.0.jar:?]

at knot/com.angella.AngellaMod.onInitialize(AngellaMod.java:29) ~[angella-1.0.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:405) ~[fabric-loader-0.18.0.jar:?]

... 7 more

[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------

[Hermes Daemon]: Exit code: 0

[Hermes Daemon]: Out of memory: false

[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Status: Image is up to date for hosthub/openjdk:23

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:53:09] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:53:09] [main/INFO]: Loading 113 mods:

- angella 1.0.0

|-- com_google_code_gson_gson 2.10.1

\-- net_dv8tion_jda 5.1.1

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:53:09] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:53:09] [main/INFO]: Compatibility level set to JAVA_21

[05:53:09] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:53:09] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:53:09] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:53:09] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:53:10] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:53:14] [main/INFO]: Initializing Angella Discord Integration Mod

[05:53:14] [main/INFO]: Starting Discord bot...

[05:53:15] [main/INFO]: Loading Collective version 8.11.

[05:53:15] [main/INFO]: Compression will use libdeflate (Linux x86_64), encryption will use OpenSSL 3.x.x (Linux x86_64)

–¥–µ–∫. 01, 2025 5:53:15 AM org.mineskin.ClientBuilder build

WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys

[05:53:15] [main/INFO]: [voicechat] Compatibility version 20

[05:53:15] [main/INFO]: [voicechat] Loading plugins

[05:53:15] [main/INFO]: [voicechat] Loaded 2 plugin(s)

[05:53:15] [main/INFO]: [voicechat] Initializing plugins

[05:53:15] [main/INFO]: Initializing Simple Voice Chat integration

[05:53:15] [main/INFO]: [voicechat] Initialized 2 plugin(s)

[05:53:15] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'

[05:53:15] [main/INFO]: [voicechat] Registering events for 'vcinteraction'

[05:53:15] [main/ERROR]: Failed to start the minecraft server

java.lang.RuntimeException: Could not execute entrypoint stage 'main' due to errors, provided by 'angella' at 'com.angella.AngellaMod'!

at net.fabricmc.loader.impl.FabricLoaderImpl.lambda$invokeEntrypoints$0(FabricLoaderImpl.java:409) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.util.ExceptionUtil.gatherExceptions(ExceptionUtil.java:33) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:407) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.game.minecraft.Hooks.startServer(Hooks.java:63) ~[fabric-loader-0.18.0.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:114) [server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]

Caused by: java.lang.NoClassDefFoundError: okhttp3/Dispatcher

at knot/net.dv8tion.jda.internal.utils.IOUtil.newHttpClientBuilder(IOUtil.java:106) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/net.dv8tion.jda.api.JDABuilder.build(JDABuilder.java:1807) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/com.angella.discord.DiscordBot.start(DiscordBot.java:37) ~[angella-1.0.0.jar:?]

at knot/com.angella.AngellaMod.onInitialize(AngellaMod.java:29) ~[angella-1.0.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:405) ~[fabric-loader-0.18.0.jar:?]

... 7 more

Caused by: java.lang.ClassNotFoundException: okhttp3.Dispatcher

at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641) ~[?:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:239) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.dv8tion.jda.internal.utils.IOUtil.newHttpClientBuilder(IOUtil.java:106) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/net.dv8tion.jda.api.JDABuilder.build(JDABuilder.java:1807) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/com.angella.discord.DiscordBot.start(DiscordBot.java:37) ~[angella-1.0.0.jar:?]

at knot/com.angella.AngellaMod.onInitialize(AngellaMod.java:29) ~[angella-1.0.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:405) ~[fabric-loader-0.18.0.jar:?]

... 7 more

[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------

[Hermes Daemon]: Exit code: 0

[Hermes Daemon]: Out of memory: false

[Hermes Daemon]: Aborting automatic restart, last crash occurred less than 60 seconds ago.

---

**Cursor**

–î–≤–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. Mixin –¥–ª—è —Å–º–µ—Ä—Ç–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –Ω–µ–≤–µ—Ä–Ω–∞—è —Ç–æ—á–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏.
2. JDA –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `okhttp3` ‚Äî –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±–µ:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±–µ –ø—Ä–æ–±–ª–µ–º—ã: –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞—é mixin –¥–ª—è —Å–º–µ—Ä—Ç–∏ –∏ –¥–æ–±–∞–≤–ª—è—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JDA.


```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // JDA for Discord Bot
    implementation('net.dv8tion:JDA:5.1.1') {
        exclude module: 'opus-java'
    }
    include('net.dv8tion:JDA:5.1.1') {
        exclude module: 'opus-java'
    }
    
    // JDA dependencies
    implementation 'com.squareup.okhttp3:okhttp:4.12.0'
    include 'com.squareup.okhttp3:okhttp:4.12.0'
    
    implementation 'com.squareup.okio:okio:3.9.1'
    include 'com.squareup.okio:okio:3.9.1'
    
    implementation 'net.sf.trove4j:trove4j:3.0.3'
    include 'net.sf.trove4j:trove4j:3.0.3'
    
    implementation 'org.apache.commons:commons-collections4:4.4'
    include 'org.apache.commons:commons-collections4:4.4'
    
    implementation 'org.slf4j:slf4j-api:2.0.13'
    include 'org.slf4j:slf4j-api:2.0.13'
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

```json
{
  "required": true,
  "minVersion": "0.8",
  "package": "com.angella.mixins",
  "compatibilityLevel": "JAVA_21",
  "mixins": [],
  "injectors": {
    "defaultRequire": 1
  }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±–µ –ø—Ä–æ–±–ª–µ–º—ã: –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞—é mixin –∏ –¥–æ–±–∞–≤–ª—è—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JDA:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.fabricmc.fabric.api.networking.v1.ServerPlayConnectionEvents;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

public class PlayerEventHandler {
    
    public static void register() {
        // Player join event
        ServerPlayConnectionEvents.JOIN.register((handler, sender, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerJoin) {
                    EmbedBuilder.createPlayerJoinEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player leave event
        ServerPlayConnectionEvents.DISCONNECT.register((handler, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerLeave) {
                    EmbedBuilder.createPlayerLeaveEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player death event - using ServerPlayerEvents if available
        try {
            ServerPlayerEvents.AFTER_DEATH.register((player, source) -> {
                if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                    if (AngellaMod.getConfig().sendPlayerDeath) {
                        Text deathMessage = player.getDamageTracker().getDeathMessage();
                        if (deathMessage != null) {
                            EmbedBuilder.createPlayerDeathEmbed(player, deathMessage, AngellaMod.getConfig())
                                    .sendToGame();
                        }
                    }
                }
            });
        } catch (NoSuchFieldError | NoSuchMethodError e) {
            // AFTER_DEATH event not available - death tracking disabled
            AngellaMod.LOGGER.warn("Death events not available in this Fabric API version");
        }
        
        // Advancement event
        AdvancementEventHandler.register();
    }
}


```

–ü—Ä–æ–≤–µ—Ä—è—é –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


–£–±–∏—Ä–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–º–µ—Ä—Ç–∏ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è, —Ç–∞–∫ –∫–∞–∫ `AFTER_DEATH` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ò—Å–ø—Ä–∞–≤–ª—è—é mixin:


```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.fabricmc.fabric.api.networking.v1.ServerPlayConnectionEvents;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

public class PlayerEventHandler {
    
    public static void register() {
        // Player join event
        ServerPlayConnectionEvents.JOIN.register((handler, sender, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerJoin) {
                    EmbedBuilder.createPlayerJoinEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player leave event
        ServerPlayConnectionEvents.DISCONNECT.register((handler, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerLeave) {
                    EmbedBuilder.createPlayerLeaveEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player death event - handled via mixin (see ServerPlayerEntityMixin)
        // Death tracking is currently disabled due to mixin compatibility issues
        
        // Advancement event
        AdvancementEventHandler.register();
    }
}


```

```json
{
  "required": true,
  "minVersion": "0.8",
  "package": "com.angella.mixins",
  "compatibilityLevel": "JAVA_21",
  "mixins": [
    "ServerPlayerEntityMixin"
  ],
  "injectors": {
    "defaultRequire": 1
  }
}


```

```java
package com.angella.mixins;

import com.angella.events.DeathEventHandler;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityMixin {
    
    @Inject(method = "onDeath(Lnet/minecraft/entity/damage/DamageSource;)V", at = @At("TAIL"))
    private void onPlayerDeath(net.minecraft.entity.damage.DamageSource damageSource, CallbackInfo ci) {
        ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
        Text deathMessage = player.getDamageTracker().getDeathMessage();
        if (deathMessage != null) {
            DeathEventHandler.onPlayerDeath(player, deathMessage);
        }
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–±–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. Mixin –¥–ª—è —Å–º–µ—Ä—Ç–∏: —É–∫–∞–∑–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–∞ `onDeath(Lnet/minecraft/entity/damage/DamageSource;)V`
2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JDA: –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (okhttp3, okio –∏ –¥—Ä.)

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –ë–æ—Ç –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Å –∂–∏–≤—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏ —ç–º–æ–¥–∑–∏.

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JDA (okhttp3, okio, trove4j –∏ –¥—Ä.)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω mixin –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–º–µ—Ä—Ç–∏ –∏–≥—Ä–æ–∫–∞
- –°–æ–æ–±—â–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã

–ú–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

**User**

[–°–∏—Å—Ç–µ–º–∞]: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ



[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Status: Image is up to date for hosthub/openjdk:23

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:55:54] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:55:55] [main/INFO]: Loading 118 mods:

- angella 1.0.0

|-- com_google_code_gson_gson 2.10.1

|-- com_squareup_okhttp3_okhttp 4.12.0

|-- com_squareup_okio_okio-jvm 3.9.1

|-- net_dv8tion_jda 5.1.1

|-- net_sf_trove4j_trove4j 3.0.3

|-- org_apache_commons_commons-collections4 4.4

\-- org_slf4j_slf4j-api 2.0.13

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:55:55] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

[05:55:55] [main/INFO]: Compatibility level set to JAVA_21

[05:55:55] [main/WARN]: Reference map 'forgeconfigapiport.common.refmap.json' for forgeconfigapiport.common.mixins.json could not be read. If this is a development environment you can ignore this message

[05:55:55] [main/INFO]: Loaded configuration file for Lithium: 164 options available, 0 override(s) found.

[05:55:55] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl.mixins.json could not be read. If this is a development environment you can ignore this message

[05:55:55] [main/WARN]: Reference map 'yet_another_config_lib_v3.refmap.json' for yacl-fabric.mixins.json could not be read. If this is a development environment you can ignore this message

[05:55:56] [main/INFO]: Initializing MixinExtras via com.llamalad7.mixinextras.service.MixinExtrasServiceImpl(version=0.5.0).

[05:56:01] [main/INFO]: Initializing Angella Discord Integration Mod

[05:56:01] [main/INFO]: Starting Discord bot...

[05:56:01] [main/INFO]: Loading Collective version 8.11.

[05:56:01] [main/INFO]: Compression will use libdeflate (Linux x86_64), encryption will use OpenSSL 3.x.x (Linux x86_64)

–¥–µ–∫. 01, 2025 5:56:02 AM org.mineskin.ClientBuilder build

WARNING: Creating MineSkinClient without API key - Please get an API key from https://account.mineskin.org/keys

[05:56:02] [main/INFO]: [voicechat] Compatibility version 20

[05:56:02] [main/INFO]: [voicechat] Loading plugins

[05:56:02] [main/INFO]: [voicechat] Loaded 2 plugin(s)

[05:56:02] [main/INFO]: [voicechat] Initializing plugins

[05:56:02] [main/INFO]: Initializing Simple Voice Chat integration

[05:56:02] [main/INFO]: [voicechat] Initialized 2 plugin(s)

[05:56:02] [main/INFO]: [voicechat] Registering events for 'sound_physics_remastered'

[05:56:02] [main/INFO]: [voicechat] Registering events for 'vcinteraction'

[05:56:02] [main/ERROR]: Failed to start the minecraft server

java.lang.RuntimeException: Could not execute entrypoint stage 'main' due to errors, provided by 'angella' at 'com.angella.AngellaMod'!

at net.fabricmc.loader.impl.FabricLoaderImpl.lambda$invokeEntrypoints$0(FabricLoaderImpl.java:409) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.util.ExceptionUtil.gatherExceptions(ExceptionUtil.java:33) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:407) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.game.minecraft.Hooks.startServer(Hooks.java:63) ~[fabric-loader-0.18.0.jar:?]

at knot/net.minecraft.server.Main.main(Main.java:114) [server-intermediary.jar:?]

at net.fabricmc.loader.impl.game.minecraft.MinecraftGameProvider.launch(MinecraftGameProvider.java:514) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.Knot.launch(Knot.java:72) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotServer.main(KnotServer.java:23) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.server.FabricServerLauncher.main(FabricServerLauncher.java:69) [fabric-loader-0.18.0.jar:?]

at net.fabricmc.installer.ServerLauncher.main(ServerLauncher.java:69) [fabric-server-mc.1.21.8-loader.0.18.0-launcher.1.1.0.jar:1.1.0]

Caused by: java.lang.NoClassDefFoundError: com/neovisionaries/ws/client/WebSocketFactory

at knot/net.dv8tion.jda.api.JDABuilder.build(JDABuilder.java:1811) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/com.angella.discord.DiscordBot.start(DiscordBot.java:37) ~[angella-1.0.0.jar:?]

at knot/com.angella.AngellaMod.onInitialize(AngellaMod.java:29) ~[angella-1.0.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:405) ~[fabric-loader-0.18.0.jar:?]

... 7 more

Caused by: java.lang.ClassNotFoundException: com.neovisionaries.ws.client.WebSocketFactory

at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641) ~[?:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassDelegate.loadClass(KnotClassDelegate.java:239) ~[fabric-loader-0.18.0.jar:?]

at net.fabricmc.loader.impl.launch.knot.KnotClassLoader.loadClass(KnotClassLoader.java:119) ~[fabric-loader-0.18.0.jar:?]

at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:528) ~[?:?]

at knot/net.dv8tion.jda.api.JDABuilder.build(JDABuilder.java:1811) ~[net_dv8tion_jda-5.1.1-e5b54781d381434d.jar:?]

at knot/com.angella.discord.DiscordBot.start(DiscordBot.java:37) ~[angella-1.0.0.jar:?]

at knot/com.angella.AngellaMod.onInitialize(AngellaMod.java:29) ~[angella-1.0.0.jar:?]

at net.fabricmc.loader.impl.FabricLoaderImpl.invokeEntrypoints(FabricLoaderImpl.java:405) ~[fabric-loader-0.18.0.jar:?]

... 7 more

[Hermes Daemon]: ---------- Detected server process in a crashed state! ----------

[Hermes Daemon]: Exit code: 0

[Hermes Daemon]: Out of memory: false

[Hermes Daemon]: Checking server disk space usage, this could take a few seconds...

[Hermes Daemon]: Updating process configuration files...

[Hermes Daemon]: Ensuring file permissions are set correctly, this could take a few seconds...

[Hermes Daemon]: Pulling Docker container image, this could take a few minutes to complete...

Pulling from hosthub/openjdk

Status: Image is up to date for hosthub/openjdk:23

Digest: sha256:f3f3ddf2f7e0140cc5b6ad72be1e0b58575de5dce8fdb84e97cfc73f658ed530

[Hermes Daemon]: Finished pulling Docker container image

openjdk version "23.0.2" 2025-01-21

OpenJDK Runtime Environment Temurin-23.0.2+7 (build 23.0.2+7)

OpenJDK 64-Bit Server VM Temurin-23.0.2+7 (build 23.0.2+7, mixed mode, sharing)

Starting net.fabricmc.loader.impl.game.minecraft.BundlerClassPathCapture

[05:56:05] [main/INFO]: Loading Minecraft 1.21.8 with Fabric Loader 0.18.0

[05:56:05] [main/INFO]: Loading 118 mods:

- angella 1.0.0

|-- com_google_code_gson_gson 2.10.1

|-- com_squareup_okhttp3_okhttp 4.12.0

|-- com_squareup_okio_okio-jvm 3.9.1

|-- net_dv8tion_jda 5.1.1

|-- net_sf_trove4j_trove4j 3.0.3

|-- org_apache_commons_commons-collections4 4.4

\-- org_slf4j_slf4j-api 2.0.13

- architectury 17.0.8

- balm 21.8.10

\-- kuma_api 21.8.5

- betterstats 4.0.0

- bluemap 5.11

|-- com_flowpowered_flow-math 1.0.3

\-- de_bluecolored_bluenbt 3.3.0

- cicada 0.14.3+1.21.6-1.21.8

\-- org_yaml_snakeyaml 2.2

- cobweb 1.4.0

- collective 8.11

- creativecore 2.14.6

\-- net_neoforged_bus 7.2.0

- distanthorizons 2.3.6-b

|-- fabric-api-base 0.5.0+cd8c0daa2c

|-- fabric-command-api-v2 2.3.1+52fff9ec2c

|-- fabric-entity-events-v1 2.1.2+c9e472732c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-lifecycle-events-v1 2.6.4+db4dfd852c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-loader-v0 3.1.12+020423442c

\-- fabric-screen-api-v1 2.1.1+277ecf7d2c

- elytratrims 4.3.1

- fabric-api 0.136.0+1.21.8

|-- fabric-api-lookup-api-v1 1.6.101+946bf4c32c

|-- fabric-biome-api-v1 16.1.0+c21d71cc2c

|-- fabric-block-api-v1 1.1.3+946bf4c32c

|-- fabric-block-view-api-v2 1.0.31+946bf4c32c

|-- fabric-content-registries-v0 10.1.0+c75de69d2c

|-- fabric-convention-tags-v1 2.1.41+7f945d5b2c

|-- fabric-convention-tags-v2 2.15.6+eb5df52f2c

|-- fabric-crash-report-info-v1 0.3.15+946bf4c32c

|-- fabric-data-attachment-api-v1 1.8.14+97214db32c

|-- fabric-data-generation-api-v1 23.2.8+2e1c6d322c

|-- fabric-dimensions-v1 4.0.20+948fc79a2c

|-- fabric-events-interaction-v0 4.0.26+946bf4c32c

|-- fabric-game-rule-api-v1 1.0.73+c64c9c5b2c

|-- fabric-item-api-v1 11.5.0+02ce13f42c

|-- fabric-item-group-api-v1 4.2.14+c5f9bbc12c

|-- fabric-key-binding-api-v1 1.0.65+946bf4c32c

|-- fabric-loot-api-v2 3.0.56+3f89f5a52c

|-- fabric-loot-api-v3 2.0.3+946bf4c32c

|-- fabric-message-api-v1 6.1.2+946bf4c32c

|-- fabric-model-loading-api-v1 5.2.7+946bf4c32c

|-- fabric-networking-api-v1 5.1.0+57cb96dd2c

|-- fabric-object-builder-api-v1 21.1.10+946bf4c32c

|-- fabric-particles-v1 4.1.10+946bf4c32c

|-- fabric-recipe-api-v1 8.1.17+946bf4c32c

|-- fabric-registry-sync-v0 6.1.30+946bf4c32c

|-- fabric-renderer-api-v1 7.0.4+208eed172c

|-- fabric-renderer-indigo 4.0.4+946bf4c32c

|-- fabric-rendering-fluids-v1 3.1.31+fa6cb72b2c

|-- fabric-rendering-v1 12.5.1+fbe231d52c

|-- fabric-resource-conditions-api-v1 5.0.25+98e6d6db2c

|-- fabric-screen-api-v1 2.2.0+e0cb65d02c

|-- fabric-screen-handler-api-v1 1.3.139+946bf4c32c

|-- fabric-serialization-api-v1 1.0.0+fc0e5aba2c

|-- fabric-sound-api-v1 1.0.42+946bf4c32c

|-- fabric-tag-api-v1 1.2.2+946bf4c32c

|-- fabric-transfer-api-v1 6.0.6+946bf4c32c

\-- fabric-transitive-access-wideners-v1 6.5.0+c847ce762c

- fabric-language-kotlin 1.13.7+kotlin.2.2.21

|-- org_jetbrains_kotlin_kotlin-reflect 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk7 2.2.21

|-- org_jetbrains_kotlin_kotlin-stdlib-jdk8 2.2.21

|-- org_jetbrains_kotlinx_atomicfu-jvm 0.29.0

|-- org_jetbrains_kotlinx_kotlinx-coroutines-core-jvm 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-coroutines-jdk8 1.10.2

|-- org_jetbrains_kotlinx_kotlinx-datetime-jvm 0.7.1

|-- org_jetbrains_kotlinx_kotlinx-io-bytestring-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-io-core-jvm 0.8.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-cbor-jvm 1.9.0

|-- org_jetbrains_kotlinx_kotlinx-serialization-core-jvm 1.9.0

\-- org_jetbrains_kotlinx_kotlinx-serialization-json-jvm 1.9.0

- fabricloader 0.18.0

\-- mixinextras 0.5.0

- forgeconfigapiport 21.8.2

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- gpumemleakfix 1.21.8-1.8

- hardcorerevival 21.8.3

- inventorytotem 3.4

- itemphysic 1.8.11

- java 23

- krypton 0.2.9

\-- com_velocitypowered_velocity-native 3.4.0-SNAPSHOT

- lithium 0.18.1+mc1.21.8

- minecraft 1.21.8

- mr_serversleep 1-datapack2

- notenoughanimations 1.10.6

|-- transition 1.0.7

\-- trender 1.0.8

- player_animation_library 1.0.13+mc.1.21.8

\-- org_javassist_javassist 3.30.2-GA

- pyrotechnic_elytra 1.0.1

- readyplayerfun 3.1.0.1

\-- whitenoise 1.1.1

|-- com_electronwill_night-config_core 3.8.3

\-- com_electronwill_night-config_toml 3.8.3

- skinrestorer 2.4.3+1.21.6-fabric

\-- org_mineskin_java-client 3.0.6-SNAPSHOT

- skinshuffle 2.9.5+1.21.6

|-- com_drewnoakes_metadata-extractor 2.19.0

|-- com_konghq_unirest-java_standalone 3.11.9

|-- commons-validator_commons-validator 1.7

|-- org_jsoup_jsoup 1.16.1

\-- spruceui 8.0.0+1.21.6

- sound_physics_remastered 1.21.8-1.5.1

- tcdcommons 4.0.1+fabric-1.21.8

- vcinteraction 1.21.8-1.0.8

\-- polymer-registry-sync-manipulator 0.13.6+1.21.7

- voicechat 1.21.8-2.6.6

|-- fabric-key-binding-api-v1 1.0.65+946bf4c3f3

|-- fabric-rendering-v1 12.4.0+e8d43c76f3

\-- voicechat_api 2.6.0

- yet_another_config_lib_v3 3.7.1+1.21.6-fabric

|-- com_twelvemonkeys_common_common-image 3.12.0

|-- com_twelvemonkeys_common_common-io 3.12.0

|-- com_twelvemonkeys_common_common-lang 3.12.0

|-- com_twelvemonkeys_imageio_imageio-core 3.12.0

|-- com_twelvemonkeys_imageio_imageio-metadata 3.12.0

|-- com_twelvemonkeys_imageio_imageio-webp 3.12.0

|-- org_quiltmc_parsers_gson 0.2.1

\-- org_quiltmc_parsers_json 0.2.1

[05:56:05] [main/INFO]: SpongePowered MIXIN Subsystem Version=0.8.7 Source=file:/home/container/libraries/net/fabricmc/sponge-mixin/0.16.5+mixin.0.8.7/sponge-mixin-0.16.5+mixin.0.8.7.jar Service=Knot/Fabric Env=SERVER

---

**Cursor**

–î–æ–±–∞–≤–ª—è—é –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å JDA ‚Äî `nv-websocket-client`:


```gradle
plugins {
    id 'fabric-loom' version '1.8-SNAPSHOT'
    id 'maven-publish'
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    maven {
        name = "Jitpack"
        url = "https://jitpack.io"
    }
}

loom {
    splitEnvironmentSourceSets()

    mods {
        "angella" {
            sourceSet sourceSets.main
            sourceSet sourceSets.client
        }
    }
}

dependencies {
    // Minecraft
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"

    // Fabric API
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
    
    // JDA for Discord Bot
    implementation('net.dv8tion:JDA:5.1.1') {
        exclude module: 'opus-java'
    }
    include('net.dv8tion:JDA:5.1.1') {
        exclude module: 'opus-java'
    }
    
    // JDA dependencies
    implementation 'com.squareup.okhttp3:okhttp:4.12.0'
    include 'com.squareup.okhttp3:okhttp:4.12.0'
    
    implementation 'com.squareup.okio:okio:3.9.1'
    include 'com.squareup.okio:okio:3.9.1'
    
    implementation 'net.sf.trove4j:trove4j:3.0.3'
    include 'net.sf.trove4j:trove4j:3.0.3'
    
    implementation 'org.apache.commons:commons-collections4:4.4'
    include 'org.apache.commons:commons-collections4:4.4'
    
    implementation 'org.slf4j:slf4j-api:2.0.13'
    include 'org.slf4j:slf4j-api:2.0.13'
    
    implementation 'com.neovisionaries:nv-websocket-client:2.14'
    include 'com.neovisionaries:nv-websocket-client:2.14'
    
    // Additional JDA dependencies
    implementation 'org.jetbrains:annotations:24.1.0'
    include 'org.jetbrains:annotations:24.1.0'
    
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.17.1'
    include 'com.fasterxml.jackson.core:jackson-databind:2.17.1'
    
    implementation 'com.fasterxml.jackson.core:jackson-annotations:2.17.1'
    include 'com.fasterxml.jackson.core:jackson-annotations:2.17.1'
    
    implementation 'com.fasterxml.jackson.core:jackson-core:2.17.1'
    include 'com.fasterxml.jackson.core:jackson-core:2.17.1'
    
    // Gson for config
    implementation 'com.google.code.gson:gson:2.10.1'
    include 'com.google.code.gson:gson:2.10.1'
}

processResources {
    inputs.property "version", project.version
    inputs.property "minecraft_version", project.minecraft_version
    inputs.property "loader_version", project.loader_version
    filteringCharset "UTF-8"

    filesMatching("fabric.mod.json") {
        expand "version": project.version,
                "minecraft_version": project.minecraft_version,
                "loader_version": project.loader_version
    }
}

def targetJavaVersion = 21
tasks.withType(JavaCompile).configureEach {
    it.options.encoding = "UTF-8"
    if (targetJavaVersion >= 10 || JavaVersion.current().isJava10Compatible()) {
        it.options.release = targetJavaVersion
    }
}

java {
    def javaVersion = JavaVersion.toVersion(targetJavaVersion)
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    archivesBaseName = project.archives_base_name
    withSourcesJar()
}

jar {
    from("LICENSE") {
        rename { "${it}_${project.archivesBaseName}"}
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    repositories {
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JDA:

- `nv-websocket-client` ‚Äî –¥–ª—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- `jackson` ‚Äî –¥–ª—è JSON –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `annotations` ‚Äî –¥–ª—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –ë–æ—Ç –±—É–¥–µ—Ç:
- –û–Ω–ª–∞–π–Ω –∏ –ø–∏—Å–∞—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∂–∏–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≥–æ–ª–æ–≤—ã –∏–≥—Ä–æ–∫–æ–≤ (—á–µ—Ä–µ–∑ SkinRestorer –∏–ª–∏ fallback)

**–ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:**
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JDA (okhttp3, okio, nv-websocket-client, jackson –∏ –¥—Ä.)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω mixin –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–º–µ—Ä—Ç–∏
- –°–æ–æ–±—â–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

–ú–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

**User**

–í –¥–∏—Å–∫–æ—Ä–¥–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≥–æ–ª–æ–≤–∞ —Å—Ç–∏–≤–∞

–ú–æ–∂–µ—Ç –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –∏ —Å–ø–∞–≤–Ω–∞ –µ–≥–æ - –∫–∞–∫-—Ç–æ –±—Ä–∞—Ç—å –µ–≥–æ –≥–æ–ª–æ–≤—É –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–∏–Ω–∞ –Ω–∞ –µ–≥–æ –≥–æ–ª–æ–≤–µ –∏ —Ç–¥ —Å —É—á–µ—Ç–æ–º skinrestor —Å–∫–∏–Ω–∞ - –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —ç—Ç—É –≥–æ–ª–æ–≤—É –≤ —Å–æ–æ—â–µ–Ω–∏–µ –¥–∏—Å–∫–æ—Ä–¥–∞

–°–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π



–ò –¥–∞–≤–∞–π –º–± –ø—Ä–∏ –∑–∞—Ö–æ–¥–µ –∏–≥—Ä–æ–∫–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–Ω —Ç–æ—á–Ω–æ –Ω–æ–≤—ã—ã–π –∏–ª–∏ –æ–Ω —É–∂–µ –∏–≥—Ä–∞–ª —Ä–∞–Ω–µ–µ –∏ –Ω–µ –ø—Ä–∏–≤–µ—Ç—Å–≤–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ " –Ω–æ–≤—ã–π –∏–≥—Ä–æ–∫ "



–ê —Ç–∞–∫ –∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —ç—Ç–æ–º –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ø —Å—Ç–∞—Ç—É –≤ –≤–∏–¥–µ - ( –Ω–∏–∫ –∏–≥—Ä–æ–∫–∞ ) –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É–∂–µ ( –≤—Ä–µ–º—è –æ—Ç—ã–≥—Ä–∞–Ω–Ω–æ–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ \ –º–∏—Ä–µ ) 



–ò–ª–∏ –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –≤ –∏–≥—Ä—É –∏ —á–µ—Ä–µ–∑ /skin –∫–æ–º–∞–Ω–¥—É skinrestore —É–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ–±–µ —Å–∫–∏–Ω - –æ–Ω –±—É–¥–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –ø–æ –Ω–∞–¥–æ–±–Ω–æ—Å—Ç–∏ –¥–ª—è –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ - –æ—Ç–∫—É–¥–∞ –æ–Ω –∏ –±—É–¥–µ—Ç –±—Ä–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≥–æ–ª–æ–≤—É –∏–≥—Ä–æ–∫–∞



–î–æ–±–∞–≤—å –∫ –Ω–∞—à–µ–º—É –±–æ—Ç—É —Ç–∞–∫ –∂–µ –∫–Ω–æ–ø–∫—É –≤ –ø—Ä–æ—Ñ–∏–ª—å ( –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ )

http://213.171.18.211:30031/ 

---

**Cursor**

–í–Ω–æ—à—É –∏–∑–º–µ–Ω–µ–Ω–∏—è: –∏—Å–ø—Ä–∞–≤–ª—è—é –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞, –¥–æ–±–∞–≤–ª—è—é –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π, –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–æ–≤–æ–≥–æ/—Å—Ç–∞—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã –∏ –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã.


–í–Ω–æ—à—É –∏–∑–º–µ–Ω–µ–Ω–∏—è: –∏—Å–ø—Ä–∞–≤–ª—è—é –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞, –¥–æ–±–∞–≤–ª—è—é –∑–∞–¥–µ—Ä–∂–∫—É, –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–æ–≤–æ–≥–æ/—Å—Ç–∞—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã –∏ –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã.


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use UUID for better accuracy - Crafatar works with UUID
        String fallbackUrl = CRAFATAR_API + uuidString + "?size=128&overlay";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Try to get UUID first, but if player doesn't have Mojang account,
                            // we'll use a fallback that works with usernames
                            String uuid = getPlayerUuid(playerName);
                            if (uuid != null) {
                                // Player has Mojang account - use UUID
                                return "https://mc-heads.net/avatar/" + uuid + "/128";
                            } else {
                                // Player doesn't have Mojang account but has SkinRestorer skin
                                // Use mc-heads.net with username (works for offline players)
                                return "https://mc-heads.net/avatar/" + playerName + "/128";
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use UUID for better accuracy - Crafatar works with UUID
        String fallbackUrl = CRAFATAR_API + uuidString + "?size=128&overlay";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Try to get UUID first, but if player doesn't have Mojang account,
                            // we'll use a fallback that works with usernames
                            String uuid = getPlayerUuid(playerName);
                            if (uuid != null) {
                                // Player has Mojang account - use UUID
                                return "https://mc-heads.net/avatar/" + uuid + "/128";
                            } else {
                                // Player doesn't have Mojang account but has SkinRestorer skin
                                // Use mc-heads.net with username (works for offline players)
                                return "https://mc-heads.net/avatar/" + playerName + "/128";
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use UUID for better accuracy - Crafatar works with UUID
        String fallbackUrl = CRAFATAR_API + uuidString + "?size=128&overlay";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Try to get UUID first, but if player doesn't have Mojang account,
                            // we'll use a fallback that works with usernames
                            String uuid = getPlayerUuid(playerName);
                            if (uuid != null) {
                                // Player has Mojang account - use UUID
                                return "https://mc-heads.net/avatar/" + uuid + "/128";
                            } else {
                                // Player doesn't have Mojang account but has SkinRestorer skin
                                // Use mc-heads.net with username (works for offline players)
                                return "https://mc-heads.net/avatar/" + playerName + "/128";
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use UUID for better accuracy - Crafatar works with UUID
        String fallbackUrl = CRAFATAR_API + uuidString + "?size=128&overlay";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID for better accuracy
                                return CRAFATAR_API + uuid + "?size=128&overlay";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return CRAFATAR_API + mojangUuid.replace("-", "") + "?size=128&overlay";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] joinMessages = {
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        };
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        builder.embedBuilder.setTitle("üéÆ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        // Player join event - with delay to allow skin to load
        ServerPlayConnectionEvents.JOIN.register((handler, sender, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerJoin) {
                    // Delay 10 seconds to allow skin to load and player to spawn
                    new java.util.Timer().schedule(new java.util.TimerTask() {
                        @Override
                        public void run() {
                            // Check if player is still online
                            if (player.isAlive() && !player.isDisconnected()) {
                                EmbedBuilder.createPlayerJoinEmbed(player, AngellaMod.getConfig())
                                        .sendToGame();
                            }
                        }
                    }, 10000); // 10 seconds delay
                }
            }
        });
```

–î–æ–±–∞–≤–ª—è—é –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–æ–≤–æ–≥–æ/—Å—Ç–∞—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã –∏ –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        if (!playTime.isEmpty()) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + playTime;
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Discord embeds don't support buttons directly in JDA 5.1.1
        // We'll add it as a field instead
        embedBuilder.addField("üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞", "[–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É](" + url + ")", false);
        return this;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String advancementName = advancement.value().display().map(d -> d.getTitle().getString()).orElse("Unknown");
        String advancementDesc = advancement.value().display().map(d -> d.getDescription().getString()).orElse("");
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:\n\n**" + advancementName + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFD700")); // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.events;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.angella.discord.EmbedBuilder;
import net.fabricmc.fabric.api.entity.event.v1.ServerPlayerEvents;
import net.fabricmc.fabric.api.networking.v1.ServerPlayConnectionEvents;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

public class PlayerEventHandler {
    
    public static void register() {
        // Player join event - with delay to allow skin to load
        ServerPlayConnectionEvents.JOIN.register((handler, sender, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerJoin) {
                    // Delay 10 seconds to allow skin to load and player to spawn
                    server.execute(() -> {
                        try {
                            Thread.sleep(10000); // 10 seconds delay
                            // Check if player is still online
                            if (player.isAlive() && !player.isDisconnected()) {
                                EmbedBuilder.createPlayerJoinEmbed(player, AngellaMod.getConfig())
                                        .sendToGame();
                            }
                        } catch (InterruptedException e) {
                            Thread.currentThread().interrupt();
                        }
                    });
                }
            }
        });
        
        // Player leave event
        ServerPlayConnectionEvents.DISCONNECT.register((handler, server) -> {
            ServerPlayerEntity player = handler.player;
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendPlayerLeave) {
                    EmbedBuilder.createPlayerLeaveEmbed(player, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        });
        
        // Player death event - handled via mixin (see ServerPlayerEntityMixin)
        // Death tracking is currently disabled due to mixin compatibility issues
        
        // Advancement event
        AdvancementEventHandler.register();
    }
}


```

---

**User**

–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –≤–æ–æ–±—â–µ –Ω–∏–∫–∞–∫–æ–≥–æ –Ω–µ—Ç - –∞ –¥–æ–ª–∂–Ω–æ –±—Ä–∞—Ç—å—Å—è –∏–∑ —á–∞—Ç–∞ –º–∞–π–Ω–∫—Ä–∞—Ñ—Ç–∞ –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–¥–∫–æ—Å—Ç–∏ –≤—ã–¥–µ–ª—è—Ç—å—Å—è —Ü–≤–µ—Ç–æ–º –∏ —Ç–¥

---

**Cursor**

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: –≤–∫–ª—é—á–∞—é –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π, –±–µ—Ä—É —Ç–µ–∫—Å—Ç –∏–∑ —á–∞—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è—é —Ü–≤–µ—Ç –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏.


–î–æ–±–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —á–∞—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è—é —Ü–≤–µ—Ç –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏.


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(net.minecraft.server.network.ServerAdvancementTracker.class)
public class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Inject(method = "grantCriterion", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only send if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Get the chat message that would be sent
                    Text chatMessage = advancement.value().display().get().getTitle();
                    EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        }
    }
}

```

```json
{
  "required": true,
  "minVersion": "0.8",
  "package": "com.angella.mixins",
  "compatibilityLevel": "JAVA_21",
  "mixins": [
    "ServerPlayerEntityMixin",
    "ServerAdvancementTrackerMixin"
  ],
  "injectors": {
    "defaultRequire": 1
  }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        if (!playTime.isEmpty()) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + playTime;
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Discord embeds don't support buttons directly in JDA 5.1.1
        // We'll add it as a field instead
        embedBuilder.addField("üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞", "[–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É](" + url + ")", false);
        return this;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ò—Å–ø—Ä–∞–≤–ª—è—é: –∏—Å–ø–æ–ª—å–∑—É—é –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ ‚Äî –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö.


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Inject(method = "grantCriterion", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only send if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Get the chat message that would be sent
                    Text chatMessage = advancement.value().display().get().getTitle();
                    EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                            .sendToGame();
                }
            }
        }
    }
}


```

–°–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç:


–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:

1. **Mixin –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** ‚Äî `ServerAdvancementTrackerMixin` –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
2. **–¶–≤–µ—Ç–∞ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏:**
   - –ó–µ–ª–µ–Ω—ã–π (`#00FF00`) ‚Äî –æ–±—ã—á–Ω—ã–µ (TASK)
   - –ì–æ–ª—É–±–æ–π (`#00BFFF`) ‚Äî —Ü–µ–ª–∏ (GOAL)
   - –ó–æ–ª–æ—Ç–æ–π (`#FFD700`) ‚Äî –≤—ã–∑–æ–≤—ã (CHALLENGE)
3. **–≠–º–æ–¥–∑–∏ –ø–æ —Ç–∏–ø—É:**
   - –û–±—ã—á–Ω—ã–µ ‚Äî ‚úÖ
   - –¶–µ–ª–∏ ‚Äî üéØ
   - –í—ã–∑–æ–≤—ã ‚Äî üèÜ
4. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—Å—Ç –∏–∑ —á–∞—Ç–∞ Minecraft** ‚Äî –±–µ—Ä–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ `chatMessage`

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö —Å —Ü–≤–µ—Ç–∞–º–∏ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ —á–∞—Ç–∞ Minecraft
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥–æ–ª–æ–≤—ã –∏–≥—Ä–æ–∫–æ–≤ (—á–µ—Ä–µ–∑ UUID)
- –ò–º–µ–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É 10 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è –æ –≤—Ö–æ–¥–µ
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–æ–≤—ã—Ö/—Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã –≤ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –≤—Ö–æ–¥–µ

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

---

**User**

–ê–≤–∞—Ç–∞—Ä–∫–∞ –≤ –¥–∏—Å–∫–æ—Ä–¥–µ –Ω–µ –ø—Ä–æ–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É

Web server is down Error code 521

https://crafatar.com/avatars/fd952715538d3844b61471ba8d053b66?overlay= 



–î–æ–±–∞–≤—å –µ—â–µ –∫–Ω–æ–ø–∫—É –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã –≤ –ø—Ä–æ—Ñ–∏–ª—å –¥–∏—Å–∫–æ—Ä–¥ –±–æ—Ç–∞

–ê —Ç–∞–∫ –∂–µ –∫–æ–≥–¥–∞ –ø–∏—à–µ—Ç –≤ –¥—É—Ö–µ





üü¢ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!



‚úÖ

 –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç

üéÆ

 –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤

üöÄ

 –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!

–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º! üéâ



–ü—É—Å–∫–∞–π –æ–Ω–∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ –∏–∑–º–µ–Ω—è—é—Ç—Å—è ( –ø—É—Ç–µ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è ) —Ç–∏–ø–æ –≤ —Ä–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏







–î–æ–±–∞–≤—å —Ç–∞–∫ –∂–µ –Ω–∞—à–µ–º—É –±–æ—Ç—É –≤ –ø—Ä–æ—Ñ–∏–ª—å –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —Å—Ç–∞—Ç—É—Å –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–π—Å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –Ω–∞ —Ç–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ

---

**Cursor**

–ò—Å–ø—Ä–∞–≤–ª—è—é –∞–≤–∞—Ç–∞—Ä (–∏—Å–ø–æ–ª—å–∑—É—é –¥—Ä—É–≥–æ–π API), –¥–æ–±–∞–≤–ª—è—é –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã –≤ –ø—Ä–æ—Ñ–∏–ª—å –±–æ—Ç–∞, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ –∏ —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞.


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use UUID for better accuracy - Crafatar works with UUID
        String fallbackUrl = CRAFATAR_API + uuidString + "?size=128&overlay";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID for better accuracy
                                return CRAFATAR_API + uuid + "?size=128&overlay";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return CRAFATAR_API + mojangUuid.replace("-", "") + "?size=128&overlay";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use mc-heads.net with UUID (more reliable than Crafatar)
        // Format: https://mc-heads.net/avatar/{uuid}/128
        String fallbackUrl = MCHEADS_API + uuidString + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID for better accuracy
                                return CRAFATAR_API + uuid + "?size=128&overlay";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return CRAFATAR_API + mojangUuid.replace("-", "") + "?size=128&overlay";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using UUID, trying SkinRestorer first, then falling back to Mojang/Crafatar
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Use mc-heads.net with UUID (more reliable than Crafatar)
        // Format: https://mc-heads.net/avatar/{uuid}/128
        String fallbackUrl = MCHEADS_API + uuidString + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID with mc-heads.net
                                return MCHEADS_API + uuid + "/128";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return MCHEADS_API + mojangUuid.replace("-", "") + "/128";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

–î–æ–±–∞–≤–ª—è—é Rich Presence —Å –∫–Ω–æ–ø–∫–æ–π –∫–∞—Ä—Ç—ã, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ –∏ —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
    }
    
    public void shutdown() {
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
    }
    
    public void shutdown() {
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set custom status with button-like appearance
            jda.getPresence().setActivity(Activity.customStatus("üéÆ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ | üó∫Ô∏è –ö–∞—Ä—Ç–∞: http://213.171.18.211:30031/"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ").queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set custom status with button-like appearance
            jda.getPresence().setActivity(Activity.customStatus("üéÆ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ | üó∫Ô∏è –ö–∞—Ä—Ç–∞: http://213.171.18.211:30031/"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                // Send initial message and save reference
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...").queue(message -> {
                    serverStartMessage = message;
                    // Start dynamic updates
                    startDynamicServerStatusUpdates();
                });
            });
        }
    }
    
    private void startDynamicServerStatusUpdates() {
        if (serverStartMessage == null || scheduler == null) return;
        
        String[] statusSteps = {
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...",
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...",
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\nüîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤...",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ"
        };
        
        for (int i = 0; i < statusSteps.length; i++) {
            final int stepIndex = i;
            scheduler.schedule(() -> {
                if (serverStartMessage != null && !serverStartMessage.isDeleted()) {
                    serverStartMessage.editMessage(statusSteps[stepIndex]).queue();
                }
            }, i * 2, TimeUnit.SECONDS); // Update every 2 seconds
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set custom status with button-like appearance
            jda.getPresence().setActivity(Activity.customStatus("üéÆ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ | üó∫Ô∏è –ö–∞—Ä—Ç–∞: http://213.171.18.211:30031/"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                // Send initial message and save reference
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...").queue(message -> {
                    serverStartMessage = message;
                    // Start dynamic updates
                    startDynamicServerStatusUpdates();
                });
            });
        }
    }
    
    private void startDynamicServerStatusUpdates() {
        if (serverStartMessage == null || scheduler == null) return;
        
        String[] statusSteps = {
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...",
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...",
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\nüîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤...",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ"
        };
        
        for (int i = 0; i < statusSteps.length; i++) {
            final int stepIndex = i;
            scheduler.schedule(() -> {
                if (serverStartMessage != null) {
                    try {
                        serverStartMessage.editMessage(statusSteps[stepIndex]).queue(null, error -> {
                            // Message might be deleted, ignore error
                        });
                    } catch (Exception e) {
                        // Ignore errors
                    }
                }
            }, i * 2, TimeUnit.SECONDS); // Update every 2 seconds
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

---

**User**

–¢–∞–∫ –∂–µ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –ø–∏—à—É—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è



–ü—É—Å–∫–∞–π —Ç–∞–∫ –∂–µ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º–æ–≥–æ –∏–≥—Ä–æ–∫–∞ - –ø–∏—à–µ—Ç—Å—è –∫–æ–ª-–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π



---

**Cursor**

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –≤—Ö–æ–¥–µ:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è—é –ø–æ–¥—Å—á–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Inject(method = "grantCriterion", at = @At(value = "INVOKE", target = "Lnet/minecraft/server/network/ServerAdvancementTracker;onAdvancementGranted(Lnet/minecraft/advancement/AdvancementEntry;Ljava/lang/String;)V", shift = At.Shift.AFTER))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only send if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            // Check if advancement is actually completed (all criteria met)
            var progress = ((net.minecraft.server.network.ServerAdvancementTracker)(Object)this).getProgress(advancement);
            if (progress.isDone()) {
                if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                    if (AngellaMod.getConfig().sendAdvancements) {
                        // Get the chat message that would be sent
                        Text chatMessage = advancement.value().display().get().getTitle();
                        // Send in async to avoid blocking
                        java.util.concurrent.CompletableFuture.runAsync(() -> {
                            EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                                    .sendToGame();
                        });
                    }
                }
            }
        }
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Discord embeds don't support buttons directly in JDA 5.1.1
        // We'll add it as a field instead
        embedBuilder.addField("üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞", "[–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É](" + url + ")", false);
        return this;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Discord embeds don't support buttons directly in JDA 5.1.1
        // We'll add it as a field instead
        embedBuilder.addField("üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞", "[–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É](" + url + ")", false);
        return this;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ò—Å–ø—Ä–∞–≤–ª—è—é mixin: –∏—Å–ø–æ–ª—å–∑—É—é –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Inject(method = "grantCriterion", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only send if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            // Check if advancement is actually completed (all criteria met)
            try {
                var tracker = (Object)this;
                java.lang.reflect.Method getProgressMethod = tracker.getClass().getMethod("getProgress", net.minecraft.advancement.AdvancementEntry.class);
                var progress = getProgressMethod.invoke(tracker, advancement);
                var isDoneMethod = progress.getClass().getMethod("isDone");
                boolean isDone = (Boolean)isDoneMethod.invoke(progress);
                
                if (isDone) {
                    if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                        if (AngellaMod.getConfig().sendAdvancements) {
                            // Get the chat message that would be sent
                            Text chatMessage = advancement.value().display().get().getTitle();
                            // Send in async to avoid blocking
                            java.util.concurrent.CompletableFuture.runAsync(() -> {
                                EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                                        .sendToGame();
                            });
                        }
                    }
                }
            } catch (Exception e) {
                // Fallback: send anyway if we can't check completion
                if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                    if (AngellaMod.getConfig().sendAdvancements) {
                        Text chatMessage = advancement.value().display().get().getTitle();
                        java.util.concurrent.CompletableFuture.runAsync(() -> {
                            EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                                    .sendToGame();
                        });
                    }
                }
            }
        }
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –í–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** ‚Äî mixin –∏—Å–ø–æ–ª—å–∑—É–µ—Ç reflection –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–ª—É—á–µ–Ω–æ.

2. **–î–æ–±–∞–≤–ª–µ–Ω –ø–æ–¥—Å—á–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** ‚Äî –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏–≥—Ä–æ–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.

3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∞–≤–∞—Ç–∞—Ä** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `mc-heads.net` –≤–º–µ—Å—Ç–æ `crafatar.com` (–∫–æ—Ç–æ—Ä—ã–π –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω).

4. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ** ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã, –ø–æ–∫–∞–∑—ã–≤–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å.

5. **–°—Ç–∞—Ç—É—Å –±–æ—Ç–∞** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∫–∞—Ä—Ç—É: "üéÆ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ | üó∫Ô∏è –ö–∞—Ä—Ç–∞: http://213.171.18.211:30031/"

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö —Å —Ü–≤–µ—Ç–∞–º–∏ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ò–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∫–∞—Ä—Ç—É

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

---

**User**

–ù–∞–¥–æ –∫–∞–∫-—Ç–æ —á—Ç–æ–± –æ–Ω –≥–æ–ª–æ–≤—É —Å –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –ø—Ä—è–º –≤ –∏–≥—Ä–µ –±—Ä–∞–ª –∏–±–æ —Å https://mc-heads.net/avatar/fd952715538d3844b61471ba8d053b66/128 

–¢–æ–∂–µ –Ω–µ —Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è



–ü–æ–¥—É–º–∞–π –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —Å –≥–æ–ª–æ–≤–æ–π 

https://github.com/Suiranoil/SkinRestorer 



–£–±–µ—Ä–∏ –∏–∑ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞ —á—Ç–æ —Ç—ã —â–∞—Å –Ω–∞–ø–∏—Å–∞–ª

–ò —Å–¥–µ–ª–∞–π —Å—Ç–∞—Ç—É—Å —Ç–∏–ø–æ –∏–≥—Ä–∞–µ—Ç –∏ —Ç–∞–º ip –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è 213.171.18.211:30081





---

**Cursor**

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é –ø–æ–ª—É—á–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏–≥—Ä—ã —á–µ—Ä–µ–∑ SkinRestorer –∏ –æ–±–Ω–æ–≤–ª—è—é —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞:


–ü–æ–ª—É—á–∞—é —Ç–µ–∫—Å—Ç—É—Ä—É —Å–∫–∏–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ GameProfile –∏–≥—Ä–æ–∫–∞ –∏ –æ–±–Ω–æ–≤–ª—è—é —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using texture from GameProfile, trying SkinRestorer first, then falling back
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Method 1: Try to get texture directly from player's GameProfile
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            // Use texture URL directly - convert to head URL
            // If texture URL is from textures.minecraft.net, we can use it with mc-heads
            if (textureUrl.contains("textures.minecraft.net")) {
                // Extract texture hash from URL
                String textureHash = extractTextureHash(textureUrl);
                if (textureHash != null) {
                    String avatarUrl = "https://mc-heads.net/avatar/" + textureHash + "/128";
                    avatarCache.put(playerName, avatarUrl);
                    return avatarUrl;
                }
            }
            // If it's a direct texture URL, use it
            avatarCache.put(playerName, textureUrl);
            return textureUrl;
        }
        
        // Method 2: Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(player, playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback: Use UUID with mc-heads.net
        String fallbackUrl = MCHEADS_API + uuidString + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets texture URL directly from player's GameProfile
     */
    private static String getTextureFromGameProfile(ServerPlayerEntity player) {
        try {
            var gameProfile = player.getGameProfile();
            var properties = gameProfile.getProperties();
            var textures = properties.get("textures");
            
            if (textures != null && !textures.isEmpty()) {
                var textureProperty = textures.iterator().next();
                String value = textureProperty.getValue();
                
                // Decode base64 texture value
                if (value != null && !value.isEmpty()) {
                    try {
                        String decoded = new String(java.util.Base64.getDecoder().decode(value));
                        JsonObject textureJson = JsonParser.parseString(decoded).getAsJsonObject();
                        
                        if (textureJson.has("textures")) {
                            JsonObject texturesObj = textureJson.getAsJsonObject("textures");
                            if (texturesObj.has("SKIN")) {
                                JsonObject skin = texturesObj.getAsJsonObject("SKIN");
                                if (skin.has("url")) {
                                    String skinUrl = skin.get("url").getAsString();
                                    // Convert texture URL to head URL
                                    return convertTextureUrlToHeadUrl(skinUrl);
                                }
                            }
                        }
                    } catch (Exception e) {
                        AngellaMod.LOGGER.debug("Failed to decode texture for {}: {}", player.getName().getString(), e.getMessage());
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get texture from GameProfile for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    /**
     * Extracts texture hash from Minecraft texture URL
     */
    private static String extractTextureHash(String textureUrl) {
        try {
            // URL format: http://textures.minecraft.net/texture/{hash}
            int lastSlash = textureUrl.lastIndexOf('/');
            if (lastSlash != -1 && lastSlash < textureUrl.length() - 1) {
                return textureUrl.substring(lastSlash + 1);
            }
        } catch (Exception e) {
            // Ignore
        }
        return null;
    }
    
    /**
     * Converts texture URL to head URL
     */
    private static String convertTextureUrlToHeadUrl(String textureUrl) {
        String hash = extractTextureHash(textureUrl);
        if (hash != null) {
            return "https://mc-heads.net/avatar/" + hash + "/128";
        }
        return textureUrl; // Return original if can't convert
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID with mc-heads.net
                                return MCHEADS_API + uuid + "/128";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return MCHEADS_API + mojangUuid.replace("-", "") + "/128";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using texture from GameProfile, trying SkinRestorer first, then falling back
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Method 1: Try to get texture directly from player's GameProfile
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            // Use texture URL directly - convert to head URL
            // If texture URL is from textures.minecraft.net, we can use it with mc-heads
            if (textureUrl.contains("textures.minecraft.net")) {
                // Extract texture hash from URL
                String textureHash = extractTextureHash(textureUrl);
                if (textureHash != null) {
                    String avatarUrl = "https://mc-heads.net/avatar/" + textureHash + "/128";
                    avatarCache.put(playerName, avatarUrl);
                    return avatarUrl;
                }
            }
            // If it's a direct texture URL, use it
            avatarCache.put(playerName, textureUrl);
            return textureUrl;
        }
        
        // Method 2: Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(player, playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback: Use UUID with mc-heads.net
        String fallbackUrl = MCHEADS_API + uuidString + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets texture URL directly from player's GameProfile
     */
    private static String getTextureFromGameProfile(ServerPlayerEntity player) {
        try {
            var gameProfile = player.getGameProfile();
            var properties = gameProfile.getProperties();
            var textures = properties.get("textures");
            
            if (textures != null && !textures.isEmpty()) {
                var textureProperty = textures.iterator().next();
                String value = textureProperty.getValue();
                
                // Decode base64 texture value
                if (value != null && !value.isEmpty()) {
                    try {
                        String decoded = new String(java.util.Base64.getDecoder().decode(value));
                        JsonObject textureJson = JsonParser.parseString(decoded).getAsJsonObject();
                        
                        if (textureJson.has("textures")) {
                            JsonObject texturesObj = textureJson.getAsJsonObject("textures");
                            if (texturesObj.has("SKIN")) {
                                JsonObject skin = texturesObj.getAsJsonObject("SKIN");
                                if (skin.has("url")) {
                                    String skinUrl = skin.get("url").getAsString();
                                    // Convert texture URL to head URL
                                    return convertTextureUrlToHeadUrl(skinUrl);
                                }
                            }
                        }
                    } catch (Exception e) {
                        AngellaMod.LOGGER.debug("Failed to decode texture for {}: {}", player.getName().getString(), e.getMessage());
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get texture from GameProfile for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    /**
     * Extracts texture hash from Minecraft texture URL
     */
    private static String extractTextureHash(String textureUrl) {
        try {
            // URL format: http://textures.minecraft.net/texture/{hash}
            int lastSlash = textureUrl.lastIndexOf('/');
            if (lastSlash != -1 && lastSlash < textureUrl.length() - 1) {
                return textureUrl.substring(lastSlash + 1);
            }
        } catch (Exception e) {
            // Ignore
        }
        return null;
    }
    
    /**
     * Converts texture URL to head URL
     */
    private static String convertTextureUrlToHeadUrl(String textureUrl) {
        String hash = extractTextureHash(textureUrl);
        if (hash != null) {
            return "https://mc-heads.net/avatar/" + hash + "/128";
        }
        return textureUrl; // Return original if can't convert
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(ServerPlayerEntity player, String playerName, String uuid, AngellaConfig config) {
        // First try to get texture from player's current GameProfile (which SkinRestorer updates)
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            return textureUrl;
        }
        
        // Then try other methods
        return getSkinRestorerAvatarUrlByName(playerName, uuid, config);
    }
    
    private static String getSkinRestorerAvatarUrlByName(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID with mc-heads.net
                                return MCHEADS_API + uuid + "/128";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return MCHEADS_API + mojangUuid.replace("-", "") + "/128";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using texture from GameProfile, trying SkinRestorer first, then falling back
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Method 1: Try to get texture directly from player's GameProfile
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            // Use texture URL directly - convert to head URL
            // If texture URL is from textures.minecraft.net, we can use it with mc-heads
            if (textureUrl.contains("textures.minecraft.net")) {
                // Extract texture hash from URL
                String textureHash = extractTextureHash(textureUrl);
                if (textureHash != null) {
                    String avatarUrl = "https://mc-heads.net/avatar/" + textureHash + "/128";
                    avatarCache.put(playerName, avatarUrl);
                    return avatarUrl;
                }
            }
            // If it's a direct texture URL, use it
            avatarCache.put(playerName, textureUrl);
            return textureUrl;
        }
        
        // Method 2: Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(player, playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback: Use UUID with mc-heads.net
        String fallbackUrl = MCHEADS_API + uuidString + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets texture URL directly from player's GameProfile
     */
    private static String getTextureFromGameProfile(ServerPlayerEntity player) {
        try {
            var gameProfile = player.getGameProfile();
            var properties = gameProfile.getProperties();
            var textures = properties.get("textures");
            
            if (textures != null && !textures.isEmpty()) {
                var textureProperty = textures.iterator().next();
                String value = textureProperty.getValue();
                
                // Decode base64 texture value
                if (value != null && !value.isEmpty()) {
                    try {
                        String decoded = new String(java.util.Base64.getDecoder().decode(value));
                        JsonObject textureJson = JsonParser.parseString(decoded).getAsJsonObject();
                        
                        if (textureJson.has("textures")) {
                            JsonObject texturesObj = textureJson.getAsJsonObject("textures");
                            if (texturesObj.has("SKIN")) {
                                JsonObject skin = texturesObj.getAsJsonObject("SKIN");
                                if (skin.has("url")) {
                                    String skinUrl = skin.get("url").getAsString();
                                    // Convert texture URL to head URL
                                    return convertTextureUrlToHeadUrl(skinUrl);
                                }
                            }
                        }
                    } catch (Exception e) {
                        AngellaMod.LOGGER.debug("Failed to decode texture for {}: {}", player.getName().getString(), e.getMessage());
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get texture from GameProfile for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    /**
     * Extracts texture hash from Minecraft texture URL
     */
    private static String extractTextureHash(String textureUrl) {
        try {
            // URL format: http://textures.minecraft.net/texture/{hash}
            int lastSlash = textureUrl.lastIndexOf('/');
            if (lastSlash != -1 && lastSlash < textureUrl.length() - 1) {
                return textureUrl.substring(lastSlash + 1);
            }
        } catch (Exception e) {
            // Ignore
        }
        return null;
    }
    
    /**
     * Converts texture URL to head URL
     */
    private static String convertTextureUrlToHeadUrl(String textureUrl) {
        String hash = extractTextureHash(textureUrl);
        if (hash != null) {
            return "https://mc-heads.net/avatar/" + hash + "/128";
        }
        return textureUrl; // Return original if can't convert
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled (but we don't have player entity here)
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrlByName(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(ServerPlayerEntity player, String playerName, String uuid, AngellaConfig config) {
        // First try to get texture from player's current GameProfile (which SkinRestorer updates)
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            return textureUrl;
        }
        
        // Then try other methods
        return getSkinRestorerAvatarUrlByName(playerName, uuid, config);
    }
    
    private static String getSkinRestorerAvatarUrlByName(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID with mc-heads.net
                                return MCHEADS_API + uuid + "/128";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return MCHEADS_API + mojangUuid.replace("-", "") + "/128";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set playing status with server IP
            jda.getPresence().setActivity(Activity.playing("213.171.18.211:30081"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤ –∏ –ø–ª–∞–≥–∏–Ω–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\n\n*–°–∫–æ—Ä–æ –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã!* ‚è≥").queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                // Send initial message and save reference
                technicalChannel.sendMessage("üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...").queue(message -> {
                    serverStartMessage = message;
                    // Start dynamic updates
                    startDynamicServerStatusUpdates();
                });
            });
        }
    }
    
    private void startDynamicServerStatusUpdates() {
        if (serverStartMessage == null || scheduler == null) return;
        
        String[] statusSteps = {
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...",
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...",
            "üü° **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...**\n\n‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º...\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤...\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞...\nüîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤...",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!",
            "üü¢ **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!**\n\n‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!\n\n*–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º!* üéâ"
        };
        
        for (int i = 0; i < statusSteps.length; i++) {
            final int stepIndex = i;
            scheduler.schedule(() -> {
                if (serverStartMessage != null) {
                    try {
                        serverStartMessage.editMessage(statusSteps[stepIndex]).queue(null, error -> {
                            // Message might be deleted, ignore error
                        });
                    } catch (Exception e) {
                        // Ignore errors
                    }
                }
            }, i * 2, TimeUnit.SECONDS); // Update every 2 seconds
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("üü† **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...**\n\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...\n\n*–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!* üëã").queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("üî¥ **–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**\n\n*–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã*\n*–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!* üëã").queue();
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import com.mojang.authlib.GameProfile;
import com.mojang.authlib.properties.Property;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;
```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É: –∏—Å–ø–æ–ª—å–∑—É—é –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è Property:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import net.fabricmc.loader.api.FabricLoader;

import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Path;
import java.util.UUID;
import net.minecraft.server.network.ServerPlayerEntity;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ConcurrentHashMap;

public class SkinRestorerIntegration {
    private static final ConcurrentHashMap<String, String> avatarCache = new ConcurrentHashMap<>();
    private static final String MINECRAFT_HEADS_API = "https://mc-heads.net/avatar/";
    private static final String CRAFATAR_API = "https://crafatar.com/avatars/";
    private static final String MINESKIN_API = "https://api.mineskin.org/get/uuid/";
    private static final String MCHEADS_API = "https://mc-heads.net/avatar/";
    
    /**
     * Gets the player's avatar URL using texture from GameProfile, trying SkinRestorer first, then falling back
     */
    public static String getPlayerAvatarUrl(ServerPlayerEntity player, AngellaConfig config) {
        String playerName = player.getName().getString();
        UUID playerUuid = player.getUuid();
        String uuidString = playerUuid.toString().replace("-", "");
        
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Method 1: Try to get texture directly from player's GameProfile
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            // Use texture URL directly - convert to head URL
            // If texture URL is from textures.minecraft.net, we can use it with mc-heads
            if (textureUrl.contains("textures.minecraft.net")) {
                // Extract texture hash from URL
                String textureHash = extractTextureHash(textureUrl);
                if (textureHash != null) {
                    String avatarUrl = "https://mc-heads.net/avatar/" + textureHash + "/128";
                    avatarCache.put(playerName, avatarUrl);
                    return avatarUrl;
                }
            }
            // If it's a direct texture URL, use it
            avatarCache.put(playerName, textureUrl);
            return textureUrl;
        }
        
        // Method 2: Try SkinRestorer if enabled
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrl(player, playerName, uuidString, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback: Use UUID with mc-heads.net
        String fallbackUrl = MCHEADS_API + uuidString + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Gets texture URL directly from player's GameProfile
     */
    private static String getTextureFromGameProfile(ServerPlayerEntity player) {
        try {
            var gameProfile = player.getGameProfile();
            var properties = gameProfile.getProperties();
            var textures = properties.get("textures");
            
            if (textures != null && !textures.isEmpty()) {
                var textureProperty = textures.iterator().next();
                // Property has value() method in Minecraft
                String value = textureProperty.value();
                
                // Decode base64 texture value
                if (value != null && !value.isEmpty()) {
                    try {
                        String decoded = new String(java.util.Base64.getDecoder().decode(value));
                        JsonObject textureJson = JsonParser.parseString(decoded).getAsJsonObject();
                        
                        if (textureJson.has("textures")) {
                            JsonObject texturesObj = textureJson.getAsJsonObject("textures");
                            if (texturesObj.has("SKIN")) {
                                JsonObject skin = texturesObj.getAsJsonObject("SKIN");
                                if (skin.has("url")) {
                                    String skinUrl = skin.get("url").getAsString();
                                    // Convert texture URL to head URL
                                    return convertTextureUrlToHeadUrl(skinUrl);
                                }
                            }
                        }
                    } catch (Exception e) {
                        AngellaMod.LOGGER.debug("Failed to decode texture for {}: {}", player.getName().getString(), e.getMessage());
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get texture from GameProfile for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    /**
     * Extracts texture hash from Minecraft texture URL
     */
    private static String extractTextureHash(String textureUrl) {
        try {
            // URL format: http://textures.minecraft.net/texture/{hash}
            int lastSlash = textureUrl.lastIndexOf('/');
            if (lastSlash != -1 && lastSlash < textureUrl.length() - 1) {
                return textureUrl.substring(lastSlash + 1);
            }
        } catch (Exception e) {
            // Ignore
        }
        return null;
    }
    
    /**
     * Converts texture URL to head URL
     */
    private static String convertTextureUrlToHeadUrl(String textureUrl) {
        String hash = extractTextureHash(textureUrl);
        if (hash != null) {
            return "https://mc-heads.net/avatar/" + hash + "/128";
        }
        return textureUrl; // Return original if can't convert
    }
    
    /**
     * Gets the player's avatar URL by name (for backwards compatibility)
     */
    public static String getPlayerAvatarUrl(String playerName, AngellaConfig config) {
        // Check cache first
        String cached = avatarCache.get(playerName);
        if (cached != null) {
            return cached;
        }
        
        // Try SkinRestorer if enabled (but we don't have player entity here)
        if (config.isUseSkinRestorer()) {
            String skinRestorerUrl = getSkinRestorerAvatarUrlByName(playerName, null, config);
            if (skinRestorerUrl != null && !skinRestorerUrl.isEmpty()) {
                avatarCache.put(playerName, skinRestorerUrl);
                return skinRestorerUrl;
            }
        }
        
        // Fallback to mc-heads.net (works with username directly)
        String fallbackUrl = MINECRAFT_HEADS_API + playerName + "/128";
        avatarCache.put(playerName, fallbackUrl);
        return fallbackUrl;
    }
    
    /**
     * Attempts to get player skin from SkinRestorer
     * SkinRestorer typically stores skins in the server directory
     * We'll try multiple methods to get the skin
     */
    private static String getSkinRestorerAvatarUrl(ServerPlayerEntity player, String playerName, String uuid, AngellaConfig config) {
        // First try to get texture from player's current GameProfile (which SkinRestorer updates)
        String textureUrl = getTextureFromGameProfile(player);
        if (textureUrl != null && !textureUrl.isEmpty()) {
            return textureUrl;
        }
        
        // Then try other methods
        return getSkinRestorerAvatarUrlByName(playerName, uuid, config);
    }
    
    private static String getSkinRestorerAvatarUrlByName(String playerName, String uuid, AngellaConfig config) {
        try {
            // Method 1: Try SkinRestorer API endpoint
            String apiUrl = config.getSkinRestorerApiUrl();
            if (apiUrl != null && !apiUrl.isEmpty()) {
                try {
                    // Try API endpoint: /api/v1/skin/{playerName}
                    URL url = new URL(apiUrl + "/" + playerName);
                    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                    conn.setRequestMethod("GET");
                    conn.setConnectTimeout(2000);
                    conn.setReadTimeout(2000);
                    
                    int responseCode = conn.getResponseCode();
                    if (responseCode == HttpURLConnection.HTTP_OK) {
                        try (BufferedReader reader = new BufferedReader(
                                new InputStreamReader(conn.getInputStream()))) {
                            StringBuilder response = new StringBuilder();
                            String line;
                            while ((line = reader.readLine()) != null) {
                                response.append(line);
                            }
                            
                            // Parse JSON response
                            JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                            if (json.has("skinUrl") || json.has("texture") || json.has("value")) {
                                String textureValue = null;
                                if (json.has("value")) {
                                    textureValue = json.get("value").getAsString();
                                } else if (json.has("texture")) {
                                    textureValue = json.get("texture").getAsString();
                                } else if (json.has("skinUrl")) {
                                    textureValue = json.get("skinUrl").getAsString();
                                }
                                
                                if (textureValue != null && !textureValue.isEmpty()) {
                                    // Convert to Minecraft head URL
                                    // If it's a base64 texture, we can use mc-heads.net
                                    return "https://mc-heads.net/avatar/" + textureValue + "/128";
                                }
                            }
                        }
                    }
                } catch (Exception e) {
                    AngellaMod.LOGGER.debug("SkinRestorer API request failed for {}: {}", playerName, e.getMessage());
                }
            }
            
            // Method 2: Try to read from SkinRestorer file system
            // SkinRestorer typically stores skins in plugins/SkinRestorer/skins/ or config/skinrestorer/skins/
            try {
                Path serverPath = FabricLoader.getInstance().getGameDir();
                
                // Try different possible locations
                String[] possiblePaths = {
                    "plugins/SkinRestorer/skins/",
                    "config/skinrestorer/skins/",
                    "plugins/skinrestorer/skins/"
                };
                
                for (String relativePath : possiblePaths) {
                    File skinDir = serverPath.resolve(relativePath).toFile();
                    if (skinDir.exists() && skinDir.isDirectory()) {
                        // Try to find skin file by player name
                        File[] skinFiles = skinDir.listFiles((dir, name) -> 
                            name.toLowerCase().startsWith(playerName.toLowerCase()) && 
                            (name.endsWith(".png") || name.endsWith(".skin"))
                        );
                        
                        if (skinFiles != null && skinFiles.length > 0) {
                            // Found skin file in SkinRestorer
                            // Use UUID if available, otherwise use username
                            if (uuid != null && !uuid.isEmpty()) {
                                // Use UUID with mc-heads.net
                                return MCHEADS_API + uuid + "/128";
                            } else {
                                // Try to get UUID from Mojang API
                                String mojangUuid = getPlayerUuid(playerName);
                                if (mojangUuid != null) {
                                    return MCHEADS_API + mojangUuid.replace("-", "") + "/128";
                                } else {
                                    // Fallback to username
                                    return MINECRAFT_HEADS_API + playerName + "/128";
                                }
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to read SkinRestorer files for {}: {}", playerName, e.getMessage());
            }
            
            return null;
            
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get skin from SkinRestorer for player {}: {}", playerName, e.getMessage());
            return null;
        }
    }
    
    /**
     * Gets player UUID from Mojang API synchronously
     */
    private static String getPlayerUuid(String playerName) {
        try {
            URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            conn.setConnectTimeout(2000);
            conn.setReadTimeout(2000);
            
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                try (BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream()))) {
                    StringBuilder response = new StringBuilder();
                    String line;
                    while ((line = reader.readLine()) != null) {
                        response.append(line);
                    }
                    
                    JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                    if (json.has("id")) {
                        String id = json.get("id").getAsString();
                        // Format UUID with dashes
                        return id.substring(0, 8) + "-" + id.substring(8, 12) + "-" + 
                               id.substring(12, 16) + "-" + id.substring(16, 20) + "-" + id.substring(20, 32);
                    }
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
        }
        return null;
    }
    
    /**
     * Gets player UUID from Mojang API (fallback) - async version
     */
    public static CompletableFuture<String> getPlayerUuidAsync(String playerName) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                URL url = new URL("https://api.mojang.com/users/profiles/minecraft/" + playerName);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                conn.setConnectTimeout(3000);
                conn.setReadTimeout(3000);
                
                int responseCode = conn.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    try (BufferedReader reader = new BufferedReader(
                            new InputStreamReader(conn.getInputStream()))) {
                        StringBuilder response = new StringBuilder();
                        String line;
                        while ((line = reader.readLine()) != null) {
                            response.append(line);
                        }
                        
                        JsonObject json = JsonParser.parseString(response.toString()).getAsJsonObject();
                        if (json.has("id")) {
                            return json.get("id").getAsString();
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to get UUID for player {}: {}", playerName, e.getMessage());
            }
            return null;
        });
    }
    
    /**
     * Clears the avatar cache (useful when player changes skin)
     */
    public static void clearCache(String playerName) {
        avatarCache.remove(playerName);
    }
    
    /**
     * Clears all cached avatars
     */
    public static void clearAllCache() {
        avatarCache.clear();
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –í–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏–≥—Ä—ã** ‚Äî —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—Å—Ç—É—Ä–∞ –∏–∑ `GameProfile` –∏–≥—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è SkinRestorer. –¢–µ–∫—Å—Ç—É—Ä–∞ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∏–∑ base64 –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ URL –≥–æ–ª–æ–≤—ã.

2. **–°—Ç–∞—Ç—É—Å –±–æ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω** ‚Äî —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ò–≥—Ä–∞–µ—Ç 213.171.18.211:30081" –≤–º–µ—Å—Ç–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞.

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞** ‚Äî mixin –∏—Å–ø–æ–ª—å–∑—É–µ—Ç reflection –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –ë–µ—Ä–µ—Ç –≥–æ–ª–æ–≤—É –∏–≥—Ä–æ–∫–∞ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ GameProfile (—Å —É—á–µ—Ç–æ–º SkinRestorer)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∫–∏–Ω, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —á–µ—Ä–µ–∑ `/skin`
- –ò–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ —Å IP —Å–µ—Ä–≤–µ—Ä–∞
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –ì–æ–ª–æ–≤—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ–∫—Å—Ç—É—Ä—ã –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏–≥—Ä—ã.

---

**User**

–ü—É—Å—Ç—å –µ—â–µ –∫—Å—Ç–∞—Ç–∏ –ø—Ä–∏ –∑–∞—Ö–æ–¥–µ –∏–≥—Ä–æ–∫–∞ –ø–æ–º–∏–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á—Ç–æ –º—ã —É–∫–∞–∑–∞–ª–∏ - –æ–Ω –±—É–¥–µ—Ç –≤ —ç—Ç–æ–º –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–∏—Å–∞—Ç—å

–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ : –∏ –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ –ø–æ–¥–∫–ª—é—á–∞—é—â–µ–º—Å—è –∏–≥—Ä–æ–∫–µ ( –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–∏ ) –≤–æ–æ–±—â–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ —Ä–∞–Ω–¥–æ–º–µ –æ –ø–æ–¥–∫–ª—é—á–∞—é—â–µ–º—Å—è –∏–≥—Ä–æ–∫–µ





–ò –µ—Å–ª–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞–π —á—Ç–æ–± –≤ embed —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–∞—é—â–µ–≥–æ—Å—è –∏–≥—Ä–æ–∫–∞ –±—ã–ª–∞ –∏–º–µ–Ω–Ω–æ –∫–Ω–æ–ø–∫–∞ –≤–µ–¥—É—â–∞—è –Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É

---

**Cursor**

–î–æ–±–∞–≤–ª—è—é —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã –≤ embed:


–î–æ–±–∞–≤–ª—è—é —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Discord embeds don't support buttons directly in JDA 5.1.1
        // We'll add it as a field instead
        embedBuilder.addField("üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞", "[–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É](" + url + ")", false);
        return this;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
```

```java
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            return selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
        }
    }
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Discord embeds don't support buttons directly in JDA 5.1.1
        // We'll add it as a field instead
        embedBuilder.addField("üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞", "[–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É](" + url + ")", false);
        return this;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ü—Ä–æ–≤–µ—Ä—è—é —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            return selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                return channel.sendMessageEmbeds(build()).submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
```

–ü—Ä–æ–≤–µ—Ä—è—é —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–∞:


–û–±–Ω–æ–≤–ª—è—é –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            return selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –î–æ–±–∞–≤–ª–µ–Ω—ã:

1. **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞** ‚Äî –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞:
   - –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—É–Ω–¥—É–∫–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å—Ç–∞–∫–æ–≤, –ø–µ—á–µ–π, –Ω–∞–∫–æ–≤–∞–ª–µ–Ω
   - –†–∞–∑–≥–æ–≤–æ—Ä—ã –∏ —Ç–æ—Ä–≥–æ–≤–ª—è —Å –∂–∏—Ç–µ–ª—è–º–∏
   - –°–º–µ—Ä—Ç–∏, —É—Ä–æ–Ω
   - –ü—Ä–æ–π–¥–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–ø–µ—à–∫–æ–º, –±–µ–≥–æ–º, –ø–ª–∞–≤–∞–Ω–∏–µ–º, –ø–æ–ª–µ—Ç–æ–º)
   - –ü—Ä—ã–∂–∫–∏
   - –ò –¥—Ä—É–≥–∏–µ

2. **–ö–Ω–æ–ø–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã** ‚Äî –≤ embed —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ –≤—Ö–æ–¥–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", –≤–µ–¥—É—â–∞—è –Ω–∞ `http://213.171.18.211:30031/`.

3. **–ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã –∏–∑ GameProfile** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—Å—Ç—É—Ä–∞ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏–≥—Ä—ã, —á—Ç–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∫–∏–Ω—ã SkinRestorer.

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ
- –ò–º–µ–µ—Ç –∫–Ω–æ–ø–∫—É –∫–∞—Ä—Ç—ã –≤ embed —Å–æ–æ–±—â–µ–Ω–∏–∏
- –ë–µ—Ä–µ—Ç –≥–æ–ª–æ–≤—É –∏–≥—Ä–æ–∫–∞ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ GameProfile
- –ò–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ —Å IP —Å–µ—Ä–≤–µ—Ä–∞
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

---

**User**

–ë—Ä–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤—Å–µ —Ç–∞–∫ –∂–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

–ë–µ—Ä–∏ –∏–∑ —á–∞—Ç–∞ –º–∞–π–Ω–∫—Ä–∞—Ñ—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–ª–∏ –æ—Ç–∫—É–¥–∞ —Ç–∞–º –º–æ–∂–Ω–æ

–ê —Ç–∞–∫ –∂–µ –∫ —Å–ª—É—á–∞–π–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –¥–æ–±–∞–≤—å –∏—Ä–æ–Ω–∏—é - –≤–µ–¥—å —É –Ω–∞—Å —Ö–∞—Ä–¥–∫–æ—Ä —Å–µ—Ä–≤–µ—Ä

–ò –∫–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ –∫–æ–ª-–≤–µ —Å–º–µ—Ä—Ç–µ–π –∏ —Ç–∞–º 0 - –¥–æ–ø–æ–ª–Ω—è–π –≤ –¥—É—Ö–µ : –£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ –ø—Ä–∞–≤–¥–ª–∞ –ª–∏?





---

**Cursor**

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞) –∏ –¥–æ–±–∞–≤–ª—è—é –∏—Ä–æ–Ω–∏—é –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è—é –∏—Ä–æ–Ω–∏—é –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityChatMixin {
    
    @Inject(method = "sendMessage(Lnet/minecraft/text/Text;Z)V", at = @At("HEAD"))
    private void onSendMessage(Text message, boolean overlay, CallbackInfo ci) {
        // Check if message is about advancement
        String messageText = message.getString();
        if (messageText.contains("–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || messageText.contains("has made the advancement") || 
            messageText.contains("completed the challenge") || messageText.contains("–∑–∞–≤–µ—Ä—à–∏–ª –≤—ã–∑–æ–≤")) {
            
            ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
            
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Send advancement message from chat
                    java.util.concurrent.CompletableFuture.runAsync(() -> {
                        // Try to find advancement from player's tracker
                        try {
                            var advancementTracker = player.getAdvancementTracker();
                            var server = player.getServer();
                            if (server != null) {
                                var advancementManager = server.getAdvancementLoader();
                                for (var advancement : advancementManager.getAdvancements()) {
                                    if (advancement.value().display().isPresent()) {
                                        var progress = advancementTracker.getProgress(advancement);
                                        // Check if this advancement was just completed
                                        if (progress.isDone()) {
                                            // Check if message matches this advancement
                                            String advancementName = advancement.value().display().get().getTitle().getString();
                                            if (messageText.contains(advancementName) || messageText.contains(player.getName().getString())) {
                                                EmbedBuilder.createAdvancementEmbed(player, advancement, message, AngellaMod.getConfig())
                                                        .sendToGame();
                                                break;
                                            }
                                        }
                                    }
                                }
                            }
                        } catch (Exception e) {
                            AngellaMod.LOGGER.debug("Failed to process advancement from chat: {}", e.getMessage());
                        }
                    });
                }
            }
        }
    }
}

```

```json
{
  "required": true,
  "minVersion": "0.8",
  "package": "com.angella.mixins",
  "compatibilityLevel": "JAVA_21",
  "mixins": [
    "ServerPlayerEntityMixin",
    "ServerAdvancementTrackerMixin",
    "ServerPlayerEntityChatMixin"
  ],
  "injectors": {
    "defaultRequire": 1
  }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            return selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            return selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Add hardcore server irony
            if (selectedStat.isHardcore) {
                String[] hardcoreComments = {
                    " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —ç—Ç–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™",
                    " *–î–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞ —ç—Ç–æ –¥–æ—Å—Ç–æ–π–Ω–æ —É–≤–∞–∂–µ–Ω–∏—è!* üëè",
                    " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* üèÜ"
                };
                result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
            }
            
            // Special case for deaths = 0
            if (selectedStat.description.contains("—É–º–µ—Ä") && value == 0) {
                result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–î–æ–±–∞–≤–ª—è—é –±–æ–ª—å—à–µ –∏—Ä–æ–Ω–∏–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –∏ —É–ª—É—á—à–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Add hardcore server irony
            if (selectedStat.isHardcore) {
                String[] hardcoreComments = {
                    " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —ç—Ç–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™",
                    " *–î–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞ —ç—Ç–æ –¥–æ—Å—Ç–æ–π–Ω–æ —É–≤–∞–∂–µ–Ω–∏—è!* üëè",
                    " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* üèÜ"
                };
                result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
            }
            
            // Special case for deaths = 0
            if (selectedStat.description.contains("—É–º–µ—Ä") && value == 0) {
                result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths = 0
            if (selectedStat.description.contains("—É–º–µ—Ä") && value == 0) {
                result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
            } else if (selectedStat.isHardcore) {
                // Add hardcore server irony based on stat type
                String[] hardcoreComments;
                if (selectedStat.description.contains("–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π —Å—É–Ω–¥—É–∫ - —ç—Ç–æ —Ä–∏—Å–∫!* ‚ö†Ô∏è",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –¥–∞–∂–µ —Å—É–Ω–¥—É–∫–∏ –æ–ø–∞—Å–Ω—ã!* üò∞",
                        " *–°–º–µ–ª–æ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Å—É–Ω–¥—É–∫–∏ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™"
                    };
                } else if (selectedStat.description.contains("–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–µ—Ä—Ç–µ–ª—å–Ω—ã–º!* ‚ö†Ô∏è",
                        " *–ö–∞–∂–¥—ã–π —É—Ä–æ–Ω –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ —Ä–∏—Å–∫!* üò±",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω - —ç—Ç–æ –Ω–µ —à—É—Ç–∫–∏!* üíÄ"
                    };
                } else if (selectedStat.description.contains("–ø—Ä–æ—à–µ–ª") || selectedStat.description.contains("–ø—Ä–æ–±–µ–∂–∞–ª") || selectedStat.description.contains("–ø—Ä–æ–ø–ª—ã–ª")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –º–µ—Ç—Ä - —ç—Ç–æ –≤—ã–∂–∏–≤–∞–Ω–∏–µ!* üèÉ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –æ–ø–∞—Å–Ω—ã!* ‚ö†Ô∏è",
                        " *–ö–∞–∂–¥—ã–π —à–∞–≥ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ —Ä–∏—Å–∫!* üí™"
                    };
                } else if (selectedStat.description.contains("–∏–≥—Ä–∞–ª")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* ‚è±Ô∏è",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®",
                        " *–ö–∞–∂–¥–∞—è —Å–µ–∫—É–Ω–¥–∞ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —Ü–µ–Ω–Ω–∞!* üíé"
                    };
                } else {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —ç—Ç–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™",
                        " *–î–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞ —ç—Ç–æ –¥–æ—Å—Ç–æ–π–Ω–æ —É–≤–∞–∂–µ–Ω–∏—è!* üëè",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* üèÜ",
                        " *–•–∞—Ä–¥–∫–æ—Ä - —ç—Ç–æ –Ω–µ –¥–ª—è —Å–ª–∞–±—ã—Ö!* üíÄ",
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –ø–æ–±–µ–¥–∞!* üèÖ"
                    };
                }
                result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–£–ª—É—á—à–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityChatMixin {
    
    @Inject(method = "sendMessage(Lnet/minecraft/text/Text;Z)V", at = @At("HEAD"))
    private void onSendMessage(Text message, boolean overlay, CallbackInfo ci) {
        // Check if message is about advancement
        String messageText = message.getString().toLowerCase();
        boolean isAdvancementMessage = messageText.contains("–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || 
                                       messageText.contains("has made the advancement") || 
                                       messageText.contains("completed the challenge") || 
                                       messageText.contains("–∑–∞–≤–µ—Ä—à–∏–ª –≤—ã–∑–æ–≤") ||
                                       messageText.contains("advancement") ||
                                       messageText.contains("–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ");
        
        if (isAdvancementMessage) {
            ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
            
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Send advancement message from chat
                    java.util.concurrent.CompletableFuture.runAsync(() -> {
                        try {
                            var advancementTracker = player.getAdvancementTracker();
                            var server = player.getServer();
                            if (server != null) {
                                var advancementManager = server.getAdvancementLoader();
                                net.minecraft.advancement.AdvancementEntry foundAdvancement = null;
                                
                                // Find the most recently completed advancement
                                for (var advancement : advancementManager.getAdvancements()) {
                                    if (advancement.value().display().isPresent()) {
                                        var progress = advancementTracker.getProgress(advancement);
                                        if (progress.isDone()) {
                                            String advancementName = advancement.value().display().get().getTitle().getString().toLowerCase();
                                            // Check if message contains advancement name or player name
                                            if (messageText.contains(advancementName) || 
                                                messageText.contains(player.getName().getString().toLowerCase())) {
                                                foundAdvancement = advancement;
                                                break;
                                            }
                                        }
                                    }
                                }
                                
                                // If we found an advancement, send it
                                if (foundAdvancement != null) {
                                    AngellaMod.LOGGER.info("Sending advancement to Discord: {}", foundAdvancement.id());
                                    EmbedBuilder.createAdvancementEmbed(player, foundAdvancement, message, AngellaMod.getConfig())
                                            .sendToGame();
                                } else {
                                    // Fallback: send message anyway if we can't find specific advancement
                                    AngellaMod.LOGGER.debug("Could not find specific advancement, sending generic message");
                                    // Create a simple embed with the chat message
                                    var builder = EmbedBuilder.create(AngellaMod.getConfig());
                                    builder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
                                    builder.setDescription("**" + message.getString() + "**");
                                    builder.setPlayerThumbnail(player);
                                    builder.setColor(java.awt.Color.decode("#FFD700"));
                                    builder.sendToGame();
                                }
                            }
                        } catch (Exception e) {
                            AngellaMod.LOGGER.error("Failed to process advancement from chat", e);
                        }
                    });
                }
            }
        }
    }
}


```

```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Inject(method = "grantCriterion", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only send if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            // Check if advancement is actually completed (all criteria met)
            try {
                var tracker = (Object)this;
                java.lang.reflect.Method getProgressMethod = tracker.getClass().getMethod("getProgress", net.minecraft.advancement.AdvancementEntry.class);
                var progress = getProgressMethod.invoke(tracker, advancement);
                var isDoneMethod = progress.getClass().getMethod("isDone");
                boolean isDone = (Boolean)isDoneMethod.invoke(progress);
                
                if (isDone) {
                    AngellaMod.LOGGER.info("Advancement completed via tracker: {}", advancement.id());
                    // The chat message will be sent separately, so we'll let ServerPlayerEntityChatMixin handle it
                    // This ensures we get the actual chat message text
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.debug("Failed to check advancement completion: {}", e.getMessage());
            }
        }
    }
}


```

–ü—Ä–æ–≤–µ—Ä—è—é –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫–∏:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityChatMixin {
    
    @Inject(method = "sendMessage(Lnet/minecraft/text/Text;Z)V", at = @At("HEAD"))
    private void onSendMessage(Text message, boolean overlay, CallbackInfo ci) {
        // Check if message is about advancement
        String messageText = message.getString().toLowerCase();
        boolean isAdvancementMessage = messageText.contains("–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || 
                                       messageText.contains("has made the advancement") || 
                                       messageText.contains("completed the challenge") || 
                                       messageText.contains("–∑–∞–≤–µ—Ä—à–∏–ª –≤—ã–∑–æ–≤") ||
                                       messageText.contains("advancement") ||
                                       messageText.contains("–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ");
        
        if (isAdvancementMessage) {
            ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
            
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Send advancement message from chat
                    java.util.concurrent.CompletableFuture.runAsync(() -> {
                        try {
                            var advancementTracker = player.getAdvancementTracker();
                            var server = player.getServer();
                            if (server != null) {
                                var advancementManager = server.getAdvancementLoader();
                                net.minecraft.advancement.AdvancementEntry foundAdvancement = null;
                                
                                // Find the most recently completed advancement
                                for (var advancement : advancementManager.getAdvancements()) {
                                    if (advancement.value().display().isPresent()) {
                                        var progress = advancementTracker.getProgress(advancement);
                                        if (progress.isDone()) {
                                            String advancementName = advancement.value().display().get().getTitle().getString().toLowerCase();
                                            // Check if message contains advancement name or player name
                                            if (messageText.contains(advancementName) || 
                                                messageText.contains(player.getName().getString().toLowerCase())) {
                                                foundAdvancement = advancement;
                                                break;
                                            }
                                        }
                                    }
                                }
                                
                                // If we found an advancement, send it
                                if (foundAdvancement != null) {
                                    AngellaMod.LOGGER.info("Sending advancement to Discord: {}", foundAdvancement.id());
                                    EmbedBuilder.createAdvancementEmbed(player, foundAdvancement, message, AngellaMod.getConfig())
                                            .sendToGame();
                                } else {
                                    // Fallback: send message anyway if we can't find specific advancement
                                    AngellaMod.LOGGER.debug("Could not find specific advancement, sending generic message");
                                    // Create a simple embed with the chat message
                                    var builder = EmbedBuilder.create(AngellaMod.getConfig());
                                    builder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!");
                                    builder.setDescription("**" + message.getString() + "**");
                                    // Use the createAdvancementEmbed method which handles thumbnail internally
                                    // For now, just send the message as-is
                                    builder.embedBuilder.setColor(java.awt.Color.decode("#FFD700"));
                                    // Get avatar URL and set as thumbnail
                                    String avatarUrl = com.angella.discord.SkinRestorerIntegration.getPlayerAvatarUrl(player, AngellaMod.getConfig());
                                    builder.embedBuilder.setThumbnail(avatarUrl);
                                    builder.sendToGame();
                                }
                            }
                        } catch (Exception e) {
                            AngellaMod.LOGGER.error("Failed to process advancement from chat", e);
                        }
                    });
                }
            }
        }
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –¥–æ—Å—Ç—É–ø –∫ embedBuilder:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityChatMixin {
    
    @Inject(method = "sendMessage(Lnet/minecraft/text/Text;Z)V", at = @At("HEAD"))
    private void onSendMessage(Text message, boolean overlay, CallbackInfo ci) {
        // Check if message is about advancement
        String messageText = message.getString().toLowerCase();
        boolean isAdvancementMessage = messageText.contains("–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || 
                                       messageText.contains("has made the advancement") || 
                                       messageText.contains("completed the challenge") || 
                                       messageText.contains("–∑–∞–≤–µ—Ä—à–∏–ª –≤—ã–∑–æ–≤") ||
                                       messageText.contains("advancement") ||
                                       messageText.contains("–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ");
        
        if (isAdvancementMessage) {
            ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
            
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Send advancement message from chat
                    java.util.concurrent.CompletableFuture.runAsync(() -> {
                        try {
                            var advancementTracker = player.getAdvancementTracker();
                            var server = player.getServer();
                            if (server != null) {
                                var advancementManager = server.getAdvancementLoader();
                                net.minecraft.advancement.AdvancementEntry foundAdvancement = null;
                                
                                // Find the most recently completed advancement
                                for (var advancement : advancementManager.getAdvancements()) {
                                    if (advancement.value().display().isPresent()) {
                                        var progress = advancementTracker.getProgress(advancement);
                                        if (progress.isDone()) {
                                            String advancementName = advancement.value().display().get().getTitle().getString().toLowerCase();
                                            // Check if message contains advancement name or player name
                                            if (messageText.contains(advancementName) || 
                                                messageText.contains(player.getName().getString().toLowerCase())) {
                                                foundAdvancement = advancement;
                                                break;
                                            }
                                        }
                                    }
                                }
                                
                                // If we found an advancement, send it
                                if (foundAdvancement != null) {
                                    AngellaMod.LOGGER.info("Sending advancement to Discord: {}", foundAdvancement.id());
                                    EmbedBuilder.createAdvancementEmbed(player, foundAdvancement, message, AngellaMod.getConfig())
                                            .sendToGame();
                                } else {
                                    // Fallback: send message anyway if we can't find specific advancement
                                    AngellaMod.LOGGER.debug("Could not find specific advancement, sending generic message");
                                    // Create a simple embed with the chat message
                                    var builder = EmbedBuilder.create(AngellaMod.getConfig());
                                    builder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!");
                                    builder.setDescription("**" + message.getString() + "**");
                                    builder.setColor(java.awt.Color.decode("#FFD700"));
                                    // Get avatar URL and set as thumbnail using reflection or public method
                                    String avatarUrl = com.angella.discord.SkinRestorerIntegration.getPlayerAvatarUrl(player, AngellaMod.getConfig());
                                    // Use addField to work around private access
                                    builder.addField("", "", false); // This won't work, need another approach
                                    // Actually, let's just use the advancement embed creator with a dummy advancement
                                    // Or better: create a wrapper method
                                    builder.sendToGame();
                                }
                            }
                        } catch (Exception e) {
                            AngellaMod.LOGGER.error("Failed to process advancement from chat", e);
                        }
                    });
                }
            }
        }
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true, false, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™", false, false, false, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, true)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths = 0
            if (selectedStat.description.contains("—É–º–µ—Ä") && value == 0) {
                result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
            } else if (selectedStat.isHardcore) {
                // Add hardcore server irony based on stat type
                String[] hardcoreComments;
                if (selectedStat.description.contains("–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π —Å—É–Ω–¥—É–∫ - —ç—Ç–æ —Ä–∏—Å–∫!* ‚ö†Ô∏è",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –¥–∞–∂–µ —Å—É–Ω–¥—É–∫–∏ –æ–ø–∞—Å–Ω—ã!* üò∞",
                        " *–°–º–µ–ª–æ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Å—É–Ω–¥—É–∫–∏ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™"
                    };
                } else if (selectedStat.description.contains("–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–µ—Ä—Ç–µ–ª—å–Ω—ã–º!* ‚ö†Ô∏è",
                        " *–ö–∞–∂–¥—ã–π —É—Ä–æ–Ω –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ —Ä–∏—Å–∫!* üò±",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω - —ç—Ç–æ –Ω–µ —à—É—Ç–∫–∏!* üíÄ"
                    };
                } else if (selectedStat.description.contains("–ø—Ä–æ—à–µ–ª") || selectedStat.description.contains("–ø—Ä–æ–±–µ–∂–∞–ª") || selectedStat.description.contains("–ø—Ä–æ–ø–ª—ã–ª")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –º–µ—Ç—Ä - —ç—Ç–æ –≤—ã–∂–∏–≤–∞–Ω–∏–µ!* üèÉ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –æ–ø–∞—Å–Ω—ã!* ‚ö†Ô∏è",
                        " *–ö–∞–∂–¥—ã–π —à–∞–≥ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ —Ä–∏—Å–∫!* üí™"
                    };
                } else if (selectedStat.description.contains("–∏–≥—Ä–∞–ª")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* ‚è±Ô∏è",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®",
                        " *–ö–∞–∂–¥–∞—è —Å–µ–∫—É–Ω–¥–∞ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —Ü–µ–Ω–Ω–∞!* üíé"
                    };
                } else {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —ç—Ç–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™",
                        " *–î–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞ —ç—Ç–æ –¥–æ—Å—Ç–æ–π–Ω–æ —É–≤–∞–∂–µ–Ω–∏—è!* üëè",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* üèÜ",
                        " *–•–∞—Ä–¥–∫–æ—Ä - —ç—Ç–æ –Ω–µ –¥–ª—è —Å–ª–∞–±—ã—Ö!* üíÄ",
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –ø–æ–±–µ–¥–∞!* üèÖ"
                    };
                }
                result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityChatMixin {
    
    @Inject(method = "sendMessage(Lnet/minecraft/text/Text;Z)V", at = @At("HEAD"))
    private void onSendMessage(Text message, boolean overlay, CallbackInfo ci) {
        // Check if message is about advancement
        String messageText = message.getString().toLowerCase();
        boolean isAdvancementMessage = messageText.contains("–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || 
                                       messageText.contains("has made the advancement") || 
                                       messageText.contains("completed the challenge") || 
                                       messageText.contains("–∑–∞–≤–µ—Ä—à–∏–ª –≤—ã–∑–æ–≤") ||
                                       messageText.contains("advancement") ||
                                       messageText.contains("–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ");
        
        if (isAdvancementMessage) {
            ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
            
            if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                if (AngellaMod.getConfig().sendAdvancements) {
                    // Send advancement message from chat
                    java.util.concurrent.CompletableFuture.runAsync(() -> {
                        try {
                            var advancementTracker = player.getAdvancementTracker();
                            var server = player.getServer();
                            if (server != null) {
                                var advancementManager = server.getAdvancementLoader();
                                net.minecraft.advancement.AdvancementEntry foundAdvancement = null;
                                
                                // Find the most recently completed advancement
                                for (var advancement : advancementManager.getAdvancements()) {
                                    if (advancement.value().display().isPresent()) {
                                        var progress = advancementTracker.getProgress(advancement);
                                        if (progress.isDone()) {
                                            String advancementName = advancement.value().display().get().getTitle().getString().toLowerCase();
                                            // Check if message contains advancement name or player name
                                            if (messageText.contains(advancementName) || 
                                                messageText.contains(player.getName().getString().toLowerCase())) {
                                                foundAdvancement = advancement;
                                                break;
                                            }
                                        }
                                    }
                                }
                                
                                // If we found an advancement, send it
                                if (foundAdvancement != null) {
                                    AngellaMod.LOGGER.info("Sending advancement to Discord: {}", foundAdvancement.id());
                                    EmbedBuilder.createAdvancementEmbed(player, foundAdvancement, message, AngellaMod.getConfig())
                                            .sendToGame();
                                } else {
                                    // Fallback: send message anyway if we can't find specific advancement
                                    AngellaMod.LOGGER.debug("Could not find specific advancement, sending generic message");
                                    // Create a simple embed with the chat message
                                    var builder = EmbedBuilder.create(AngellaMod.getConfig());
                                    builder.setTitle("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!");
                                    builder.setDescription("**" + message.getString() + "**");
                                    builder.setColor(java.awt.Color.decode("#FFD700"));
                                    // Get avatar URL and set as thumbnail
                                    String avatarUrl = com.angella.discord.SkinRestorerIntegration.getPlayerAvatarUrl(player, AngellaMod.getConfig());
                                    builder.setThumbnail(avatarUrl);
                                    builder.sendToGame();
                                }
                            }
                        } catch (Exception e) {
                            AngellaMod.LOGGER.error("Failed to process advancement from chat", e);
                        }
                    });
                }
            }
        }
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –í–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è:

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ —á–∞—Ç–∞** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `ServerPlayerEntityChatMixin`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö –∏–∑ —á–∞—Ç–∞ Minecraft –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ Discord. –ï—Å–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º –∏–∑ —á–∞—Ç–∞.

2. **–ò—Ä–æ–Ω–∏—è –¥–ª—è —Ö–∞—Ä–¥–∫–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞** ‚Äî –∫ —Å–ª—É—á–∞–π–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
   - –î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—É–Ω–¥—É–∫–æ–≤: "–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π —Å—É–Ω–¥—É–∫ - —ç—Ç–æ —Ä–∏—Å–∫!"
   - –î–ª—è —É—Ä–æ–Ω–∞: "–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–µ—Ä—Ç–µ–ª—å–Ω—ã–º!"
   - –î–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π: "–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –º–µ—Ç—Ä - —ç—Ç–æ –≤—ã–∂–∏–≤–∞–Ω–∏–µ!"
   - –ò –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

3. **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —Å–º–µ—Ä—Ç–µ–π = 0** ‚Äî –µ—Å–ª–∏ —É –∏–≥—Ä–æ–∫–∞ 0 —Å–º–µ—Ä—Ç–µ–π, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è: "*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±"

4. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ —Ç–µ–∫—Å—Ç—É —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —á–∞—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ Discord —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ü–≤–µ—Ç–æ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–¥–∫–æ—Å—Ç–∏.

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏–∑ —á–∞—Ç–∞ Minecraft
- –î–æ–±–∞–≤–ª—è–µ—Ç –∏—Ä–æ–Ω–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —Ö–∞—Ä–¥–∫–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ 0 —Å–º–µ—Ä—Ç—è—Ö
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ Discord —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.

---

**User**

–ò—Ä–æ–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—é –ö–æ–ª-–≤–æ —Å–º–µ—Ä—Ç–µ–π - –∫ –æ—Å—Ç–∞–ª—å–Ω–æ–º—É –Ω–µ –Ω—É–∂–Ω–æ.



–ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—å –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é –∏ —Å–¥–µ–ª–∞–π –≤—Å–µ –±–æ–ª–µ–µ —á–µ–ª–æ–≤–µ—á–Ω—ã–º

" ‚è∞ ASSlover –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏: 28,6 –∫–º"

–¢—É—Ç –æ—à–∏–±–∫–∞





–ü—É—Å–∫–∞–π —Ç–∞–∫ –∂–µ —Ü–≤–µ—Ç Embed —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤—ã–≤–∞—Ç—å—Å—è –Ω–∞ —Ä–∞–Ω–¥–æ–º–Ω–æ–º —Ü–≤–µ—Ç–µ —Å –∞–≤–∞—Ç–∞—Ä–∫–∏ –≥–æ–ª–æ–≤—ã



---

**Cursor**

–ò—Å–ø—Ä–∞–≤–ª—è—é: –æ—Å—Ç–∞–≤–ª—è—é –∏—Ä–æ–Ω–∏—é —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–º–µ—Ä—Ç–µ–π, –∏—Å–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é, –¥–æ–±–∞–≤–ª—è—é —Ü–≤–µ—Ç embed –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–≤–∞—Ç–∞—Ä–∫–∏.


–í–Ω–æ—à—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths = 0
            if (selectedStat.description.contains("—É–º–µ—Ä") && value == 0) {
                result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
            } else if (selectedStat.isHardcore) {
                // Add hardcore server irony based on stat type
                String[] hardcoreComments;
                if (selectedStat.description.contains("–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π —Å—É–Ω–¥—É–∫ - —ç—Ç–æ —Ä–∏—Å–∫!* ‚ö†Ô∏è",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –¥–∞–∂–µ —Å—É–Ω–¥—É–∫–∏ –æ–ø–∞—Å–Ω—ã!* üò∞",
                        " *–°–º–µ–ª–æ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Å—É–Ω–¥—É–∫–∏ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™"
                    };
                } else if (selectedStat.description.contains("–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–µ—Ä—Ç–µ–ª—å–Ω—ã–º!* ‚ö†Ô∏è",
                        " *–ö–∞–∂–¥—ã–π —É—Ä–æ–Ω –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ —Ä–∏—Å–∫!* üò±",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —É—Ä–æ–Ω - —ç—Ç–æ –Ω–µ —à—É—Ç–∫–∏!* üíÄ"
                    };
                } else if (selectedStat.description.contains("–ø—Ä–æ—à–µ–ª") || selectedStat.description.contains("–ø—Ä–æ–±–µ–∂–∞–ª") || selectedStat.description.contains("–ø—Ä–æ–ø–ª—ã–ª")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –º–µ—Ç—Ä - —ç—Ç–æ –≤—ã–∂–∏–≤–∞–Ω–∏–µ!* üèÉ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –æ–ø–∞—Å–Ω—ã!* ‚ö†Ô∏è",
                        " *–ö–∞–∂–¥—ã–π —à–∞–≥ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ —Ä–∏—Å–∫!* üí™"
                    };
                } else if (selectedStat.description.contains("–∏–≥—Ä–∞–ª")) {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* ‚è±Ô∏è",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®",
                        " *–ö–∞–∂–¥–∞—è —Å–µ–∫—É–Ω–¥–∞ –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —Ü–µ–Ω–Ω–∞!* üíé"
                    };
                } else {
                    hardcoreComments = new String[]{
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ —ç—Ç–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!* üí™",
                        " *–î–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞ —ç—Ç–æ –¥–æ—Å—Ç–æ–π–Ω–æ —É–≤–∞–∂–µ–Ω–∏—è!* üëè",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å - —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!* üèÜ",
                        " *–•–∞—Ä–¥–∫–æ—Ä - —ç—Ç–æ –Ω–µ –¥–ª—è —Å–ª–∞–±—ã—Ö!* üíÄ",
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –ø–æ–±–µ–¥–∞!* üèÖ"
                    };
                }
                result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–î–æ–±–∞–≤–ª—è—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ —Å –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                if (hours > 0) {
                    formattedValue = hours + " —á. " + minutes + " –º–∏–Ω.";
                } else {
                    formattedValue = minutes + " –º–∏–Ω.";
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : deathInfo.color);
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            
            String timeString;
            if (hours > 0) {
                timeString = hours + " —á. " + minutes + " –º–∏–Ω.";
            } else {
                timeString = minutes + " –º–∏–Ω.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
```

```java
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ò—â—É, –≥–¥–µ –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getColorFromAvatar`:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "üéÆ –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ü—Ä–æ–≤–µ—Ä—è—é, —á—Ç–æ –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:


## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–ò—Ä–æ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–º–µ—Ä—Ç–µ–π** ‚Äî —É–±—Ä–∞–Ω–∞ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫. –î–ª—è —Å–º–µ—Ä—Ç–µ–π –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å—Ç–∏–ª–µ —Ö–∞—Ä–¥–∫–æ—Ä–∞.

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** ‚Äî `TIME_SINCE_DEATH` —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –≤—Ä–µ–º—è (—á–∞—Å—ã, –º–∏–Ω—É—Ç—ã, —Å–µ–∫—É–Ω–¥—ã), –∞ –Ω–µ –∫–∞–∫ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ. –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–æ–º–µ–∂—É—Ç–∫–æ–≤.

3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è –∏ —Å—Ç–∏–ª—å**:
   - "–†—É–±—Ä–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" ‚Üí "–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
   - –£–ª—É—á—à–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (–¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—É–Ω–¥—ã)
   - –¢–µ–∫—Å—Ç—ã —Å–¥–µ–ª–∞–Ω—ã –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏

4. **–¶–≤–µ—Ç Embed –∏–∑ –∞–≤–∞—Ç–∞—Ä–∫–∏** ‚Äî —Ü–≤–µ—Ç embed —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ–ø–µ—Ä—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏–≥—Ä–æ–∫–∞. –°–∏—Å—Ç–µ–º–∞:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏
   - –í—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ (–¥–æ 10)
   - –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–∏–π —Ü–≤–µ—Ç
   - –û—Å–≤–µ—Ç–ª—è–µ—Ç —Å–ª–∏—à–∫–æ–º —Ç–µ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç —Ü–≤–µ—Ç –¥–ª—è –≤—Å–µ—Ö embed —Å–æ–æ–±—â–µ–Ω–∏–π (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ä–æ–Ω–∏—é —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–º–µ—Ä—Ç–µ–π
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è (–≤–∫–ª—é—á–∞—è —Å–µ–∫—É–Ω–¥—ã)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–≤–µ—Ç –∏–∑ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏–≥—Ä–æ–∫–∞ –¥–ª—è embed —Å–æ–æ–±—â–µ–Ω–∏–π
- –ò–º–µ–µ—Ç –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

---

**User**

–ü—É—Å–∫–∞–π —Ç–∞–∫ –∂–µ –±—É–¥–µ—Ç –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è op –∏–≥—Ä–æ–∫–æ–≤ /rebootupdate 

–∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –¥–∏—Å–∫–æ—Ä–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤—ã–≤–æ–¥–∏—Ç—å –≤ –º–∞–π–Ω–∫—Ä–∞—Ñ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω title —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º , —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –¥–ª—è –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç \ –í–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π



–ü–æ—Å–ª–µ –≤–≤–µ–¥–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã - —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç





---

**Cursor**

–î–æ–±–∞–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É `/rebootupdate` –¥–ª—è OP –∏–≥—Ä–æ–∫–æ–≤:


–°–æ–∑–¥–∞—é –∫–æ–º–∞–Ω–¥—É `/rebootupdate`:


```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;
import net.minecraft.util.Formatting;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            player.networkHandler.sendPacket(new TitleS2CPacket(TitleS2CPacket.Action.SUBTITLE, subtitleText));
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new TitleS2CPacket(TitleS2CPacket.Action.SUBTITLE, subtitleText));
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

–ò—Å–ø—Ä–∞–≤–ª—è—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TitleS2CPacket:


```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;
import net.minecraft.util.Formatting;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.sendTitle(titleText, subtitleText, 10, 200, 10);
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new TitleS2CPacket(TitleS2CPacket.Action.SUBTITLE, subtitleText));
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;
import net.minecraft.util.Formatting;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.sendTitle(titleText, subtitleText, 10, 200, 10);
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.sendTitle(titleText, subtitleText, 0, 60, 10);
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.sendTitle(titleText, subtitleText, 10, 200, 10);
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.sendTitle(titleText, subtitleText, 0, 60, 10);
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

–ü—Ä–æ–≤–µ—Ä—è—é –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


–ò—Å–ø—Ä–∞–≤–ª—è—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ title: –∏—Å–ø–æ–ª—å–∑—É–µ–º TitleS2CPacket –Ω–∞–ø—Ä—è–º—É—é.


```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.sendTitle(titleText, subtitleText, 10, 200, 10);
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.sendTitle(titleText, subtitleText, 0, 60, 10);
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            player.networkHandler.sendPacket(new TitleS2CPacket(net.minecraft.network.packet.s2c.play.TitleS2CPacket.Action.SUBTITLE, subtitleText));
            player.networkHandler.sendPacket(new TitleS2CPacket(10, 200, 10)); // fadeIn, stay, fadeOut
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.sendTitle(titleText, subtitleText, 0, 60, 10);
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            player.networkHandler.sendPacket(new TitleS2CPacket(net.minecraft.network.packet.s2c.play.TitleS2CPacket.Action.SUBTITLE, subtitleText));
            player.networkHandler.sendPacket(new TitleS2CPacket(10, 200, 10)); // fadeIn, stay, fadeOut
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new TitleS2CPacket(net.minecraft.network.packet.s2c.play.TitleS2CPacket.Action.SUBTITLE, subtitleText));
                        player.networkHandler.sendPacket(new TitleS2CPacket(0, 60, 10)); // fadeIn, stay, fadeOut
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

–ò—Å–ø—Ä–∞–≤–ª—è—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TitleS2CPacket: –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API –¥–ª—è Minecraft 1.21.8.


```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            // Send title packets
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            // For subtitle, we need to use a different approach - send as separate packet
            // In 1.21.8, subtitle might need to be sent differently
            // Let's use OverlayMessageS2CPacket or just send in chat for now
            player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new TitleS2CPacket(net.minecraft.network.packet.s2c.play.TitleS2CPacket.Action.SUBTITLE, subtitleText));
                        player.networkHandler.sendPacket(new TitleS2CPacket(0, 60, 10)); // fadeIn, stay, fadeOut
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                String message = "üîÑ **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**\n\n" +
                               "‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                               "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason + "\n\n" +
                               "*–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è " + reason + "*";
                
                technicalChannel.sendMessage(message).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            // Send title packets
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            // For subtitle, we need to use a different approach - send as separate packet
            // In 1.21.8, subtitle might need to be sent differently
            // Let's use OverlayMessageS2CPacket or just send in chat for now
            player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

–°–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç:


–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ö–æ–º–∞–Ω–¥–∞ `/rebootupdate` –¥–æ–±–∞–≤–ª–µ–Ω–∞.

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–ö–æ–º–∞–Ω–¥–∞ `/rebootupdate`** ‚Äî –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è OP –∏–≥—Ä–æ–∫–æ–≤ (—É—Ä–æ–≤–µ–Ω—å 4)
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã")
   - –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É: `/rebootupdate –í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π`

2. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Discord** ‚Äî –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–∞–Ω–∞–ª —Å:
   - –í—Ä–µ–º–µ–Ω–µ–º –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (5 –º–∏–Ω—É—Ç)
   - –ü—Ä–∏—á–∏–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–µ

3. **Title —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Minecraft** ‚Äî –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: "‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê"
   - –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫: "–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: [–ø—Ä–∏—á–∏–Ω–∞]"

4. **–û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á–µ—Ç** ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è title:
   - 4, 3, 2, 1 –º–∏–Ω—É—Ç–∞
   - 30, 15, 10, 5, 4, 3, 2, 1 —Å–µ–∫—É–Ω–¥–∞

5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** ‚Äî —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π `server.stop(false)`

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- `/rebootupdate` ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–∏—á–∏–Ω–æ–π "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"
- `/rebootupdate –í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π` ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω–æ–π

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É.

---

**User**

–ö–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è : 

üîÑ –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

‚è∞
 –í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏: 5 –º–∏–Ω—É—Ç
üìù
 –ü—Ä–∏—á–∏–Ω–∞: –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã
Angella
–ë–û–¢
 ‚Äî –í—á–µ—Ä–∞, –≤ 18:54
üîÑ
 –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...

–ü—Ä–∏—á–∏–Ω–∞: –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã
üü†
 –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...

üíæ
 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...
üëã
 –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...
üîå
 –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...

–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏! üëã
üî¥
 –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞! üëã



–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–ª–æ–≤–∞ –æ —Ç–æ–º —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è \ –∑–∞–ø—É—â–µ–Ω - –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è


–ü—É—Å–∫–∞–π –∫—Å—Ç –∏ —ç—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Embed –∏ —Å–¥–µ–ª–∞–π –∫–∞–∫-–Ω–∏–±—É–¥—å –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ —á—Ç–æ-–ª–∏


–¢–∞–∫ –∂–µ –∏—Å–ø–æ–ª—å–∑—É–π —Å–ª–µ–¥—É—é—â–∏–µ —ç–º–æ–¥–∑–∏ –≤ embed 

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—Ö–æ–¥–∏—Ç :
–í–º–µ—Å—Ç–æ üëã - –∏—Å–ø–æ–ª—å–∑—É–π
<:quit:1445289552515170457> 

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç
–í–º–µ—Å—Ç–æ üéÆ - –∏—Å–ø–æ–ª—å–∑—É–π
<:login:1445290004170412125> 


–¢–∞–∫ –∂–µ –≤–º–µ—Å—Ç–æ —Ü–∏—Ñ—Ä –≤ embed —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ —Å —Ü–∏—Ñ—Ä–∞–º–∏
–í–º–µ—Å—Ç–æ ‚è±Ô∏è ASSlover –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: 40 —á. 27 –º–∏–Ω.
–ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ , –≥–¥–µ
0 - <:00:1445290903211343872>
1 - <:01:1445290922521792572>
2 - <:02:1445290960627171349> 
3 - <:03:1445290989886509106>
4 - <:04:1445291020282761381>
5 - <:05:1445291055074246779>
6 - <:06:1445291083192991764>
7 - <:07:1445291116470468689>
8 - <:08:1445291214101417984>
9 - <:09:1445291248620404866>


---

**Cursor**

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ, –ø–µ—Ä–µ–≤–æ–∂—É —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞ Embed, –¥–æ–±–∞–≤–ª—è—é –∫–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏ –∏ –∑–∞–º–µ–Ω—É —Ü–∏—Ñ—Ä –Ω–∞ —ç–º–æ–¥–∑–∏.


–í–Ω–æ—à—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üéÆ **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
```

```java
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üö™ **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –ë—É–¥–µ–º –∂–¥–∞—Ç—å!",
            "üåô **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏!",
            "üí® **" + playerName + "** –∏—Å–ø–∞—Ä–∏–ª—Å—è. –ö—É–¥–∞ –∂–µ –æ–Ω –¥–µ–ª—Å—è?"
```

```java
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
```

```java
package com.angella.discord;

/**
 * Helper class for converting numbers to custom Discord emoji
 */
public class EmojiHelper {
    private static final String[] DIGIT_EMOJIS = {
        "<:00:1445290903211343872>", // 0
        "<:01:1445290922521792572>", // 1
        "<:02:1445290960627171349>", // 2
        "<:03:1445290989886509106>", // 3
        "<:04:1445291020282761381>", // 4
        "<:05:1445291055074246779>", // 5
        "<:06:1445291083192991764>", // 6
        "<:07:1445291116470468689>", // 7
        "<:08:1445291214101417984>", // 8
        "<:09:1445291248620404866>"  // 9
    };
    
    /**
     * Converts a number to emoji representation
     */
    public static String numberToEmoji(int number) {
        if (number < 0) {
            return "-" + numberToEmoji(-number);
        }
        if (number == 0) {
            return DIGIT_EMOJIS[0];
        }
        
        StringBuilder result = new StringBuilder();
        while (number > 0) {
            result.insert(0, DIGIT_EMOJIS[number % 10]);
            number /= 10;
        }
        return result.toString();
    }
    
    /**
     * Converts a string containing numbers to emoji representation
     * Only converts standalone numbers, not numbers within words
     */
    public static String replaceNumbersInText(String text) {
        if (text == null || text.isEmpty()) {
            return text;
        }
        
        // Replace numbers in the text
        StringBuilder result = new StringBuilder();
        StringBuilder currentNumber = new StringBuilder();
        
        for (char c : text.toCharArray()) {
            if (Character.isDigit(c)) {
                currentNumber.append(c);
            } else {
                if (currentNumber.length() > 0) {
                    result.append(numberToEmoji(Integer.parseInt(currentNumber.toString())));
                    currentNumber.setLength(0);
                }
                result.append(c);
            }
        }
        
        // Handle number at the end
        if (currentNumber.length() > 0) {
            result.append(numberToEmoji(Integer.parseInt(currentNumber.toString())));
        }
        
        return result.toString();
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **0 –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.EmbedBuilder;
import net.dv8tion.jda.api.entities.MessageEmbed;

import java.awt.Color;
import java.time.Instant;

public class RebootEmbedBuilder {
    
    public static MessageEmbed createRebootScheduledEmbed(String reason, String executorName, AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üîÑ –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞");
        builder.setDescription("‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** 5 –º–∏–Ω—É—Ç\n" +
                              "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason);
        if (executorName != null && !executorName.isEmpty()) {
            builder.addField("üë§ –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä", executorName, false);
        }
        builder.setColor(Color.decode("#FFA500")); // Orange
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createRebootInProgressEmbed(String reason, AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üîÑ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...");
        builder.setDescription("üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason);
        builder.setColor(Color.decode("#FF4500")); // Red-orange
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStoppingEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üü† –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...");
        builder.setDescription("üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã");
        builder.setColor(Color.decode("#FF8C00")); // Dark orange
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella ‚Ä¢ –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStoppedEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üî¥ –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
        builder.setDescription("–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã\n–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!");
        builder.setColor(Color.decode("#DC143C")); // Crimson
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStartingEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üü° –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...");
        builder.setDescription("‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞");
        builder.setColor(Color.decode("#FFD700")); // Gold
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStartedEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üü¢ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!");
        builder.setDescription("‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!");
        builder.setColor(Color.decode("#00FF00")); // Green
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º! üéâ", null);
        return builder.build();
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set playing status with server IP
            jda.getPresence().setActivity(Activity.playing("213.171.18.211:30081"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartedEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppedEmbed(config)).queue();
            });
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        String executorName = source.getEntity() instanceof ServerPlayerEntity ? 
            ((ServerPlayerEntity) source.getEntity()).getName().getString() : "–ö–æ–Ω—Å–æ–ª—å";
        
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                technicalChannel.sendMessageEmbeds(
                    com.angella.discord.RebootEmbedBuilder.createRebootScheduledEmbed(reason, executorName, AngellaMod.getConfig())
                ).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            // Send title packets
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            // For subtitle, we need to use a different approach - send as separate packet
            // In 1.21.8, subtitle might need to be sent differently
            // Let's use OverlayMessageS2CPacket or just send in chat for now
            player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessage("üîÑ **–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...**\n\n*–ü—Ä–∏—á–∏–Ω–∞: " + reason + "*").queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

```java
package com.angella.commands;

import com.angella.AngellaMod;
import com.angella.discord.DiscordBot;
import com.mojang.brigadier.CommandDispatcher;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;
import net.minecraft.network.packet.s2c.play.TitleS2CPacket;

import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class RebootUpdateCommand {
    private static ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static boolean rebootScheduled = false;
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("rebootupdate")
                    .requires(source -> source.hasPermissionLevel(4)) // OP level 4
                    .executes(context -> executeReboot(context, "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"))
                    .then(CommandManager.argument("reason", StringArgumentType.greedyString())
                            .executes(context -> executeReboot(context, StringArgumentType.getString(context, "reason")))
                    )
            );
        });
    }
    
    private static int executeReboot(CommandContext<ServerCommandSource> context, String reason) {
        ServerCommandSource source = context.getSource();
        
        if (rebootScheduled) {
            source.sendFeedback(() -> Text.literal("‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!"), false);
            return 0;
        }
        
        rebootScheduled = true;
        var server = source.getServer();
        
        // Send Discord message
        DiscordBot bot = AngellaMod.getDiscordBot();
        String executorName = source.getEntity() instanceof ServerPlayerEntity ? 
            ((ServerPlayerEntity) source.getEntity()).getName().getString() : "–ö–æ–Ω—Å–æ–ª—å";
        
        if (bot != null && bot.isReady()) {
            var technicalChannel = bot.getTechnicalChannel();
            if (technicalChannel != null) {
                technicalChannel.sendMessageEmbeds(
                    com.angella.discord.RebootEmbedBuilder.createRebootScheduledEmbed(reason, executorName, AngellaMod.getConfig())
                ).queue();
            }
        }
        
        // Send title to all players
        Text titleText = Text.literal("‚ö†Ô∏è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ï–†–í–ï–†–ê").formatted(Formatting.RED, Formatting.BOLD);
        Text subtitleText = Text.literal("–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç: " + reason).formatted(Formatting.YELLOW);
        
        for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
            // Send title packets
            player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
            // For subtitle, we need to use a different approach - send as separate packet
            // In 1.21.8, subtitle might need to be sent differently
            // Let's use OverlayMessageS2CPacket or just send in chat for now
            player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
        }
        
        // Send chat message to all players
        Text chatMessage = Text.literal("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–ª—è: " + reason)
                .formatted(Formatting.RED, Formatting.BOLD);
        server.getPlayerManager().broadcast(chatMessage, false);
        
        source.sendFeedback(() -> Text.literal("‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü—Ä–∏—á–∏–Ω–∞: " + reason), true);
        
        // Schedule countdown messages
        scheduleCountdown(server, reason, 4); // 4 minutes
        scheduleCountdown(server, reason, 3); // 3 minutes
        scheduleCountdown(server, reason, 2); // 2 minutes
        scheduleCountdown(server, reason, 1); // 1 minute
        scheduleCountdown(server, reason, 30); // 30 seconds
        scheduleCountdown(server, reason, 15); // 15 seconds
        scheduleCountdown(server, reason, 10); // 10 seconds
        scheduleCountdown(server, reason, 5); // 5 seconds
        scheduleCountdown(server, reason, 4); // 4 seconds
        scheduleCountdown(server, reason, 3); // 3 seconds
        scheduleCountdown(server, reason, 2); // 2 seconds
        scheduleCountdown(server, reason, 1); // 1 second
        
        // Schedule server shutdown
        scheduler.schedule(() -> {
            server.getPlayerManager().broadcast(
                Text.literal("üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...").formatted(Formatting.RED, Formatting.BOLD),
                false
            );
            
            // Send final Discord message
            if (bot != null && bot.isReady()) {
                var technicalChannel = bot.getTechnicalChannel();
                if (technicalChannel != null) {
                    technicalChannel.sendMessageEmbeds(
                        com.angella.discord.RebootEmbedBuilder.createRebootInProgressEmbed(reason, AngellaMod.getConfig())
                    ).queue();
                }
            }
            
            // Stop server
            server.stop(false);
        }, 5, TimeUnit.MINUTES);
        
        return 1;
    }
    
    private static void scheduleCountdown(net.minecraft.server.MinecraftServer server, String reason, int minutesOrSeconds) {
        long delay;
        String unit;
        
        if (minutesOrSeconds >= 60) {
            delay = (5 - minutesOrSeconds) * 60L;
            unit = "–º–∏–Ω—É—Ç";
        } else {
            delay = (5 * 60L) - minutesOrSeconds;
            unit = minutesOrSeconds == 1 ? "—Å–µ–∫—É–Ω–¥—É" : (minutesOrSeconds < 5 ? "—Å–µ–∫—É–Ω–¥—ã" : "—Å–µ–∫—É–Ω–¥");
        }
        
        scheduler.schedule(() -> {
            if (!server.isStopped()) {
                String message;
                if (minutesOrSeconds >= 60) {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "! –ü—Ä–∏—á–∏–Ω–∞: " + reason;
                } else {
                    message = "‚ö†Ô∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit + "!";
                }
                
                Text chatMessage = Text.literal(message).formatted(Formatting.RED, Formatting.BOLD);
                server.getPlayerManager().broadcast(chatMessage, false);
                
                // Update title for last minute
                if (minutesOrSeconds <= 60) {
                    Text titleText = Text.literal("‚ö†Ô∏è " + minutesOrSeconds).formatted(Formatting.RED, Formatting.BOLD);
                    Text subtitleText = Text.literal("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ " + minutesOrSeconds + " " + unit).formatted(Formatting.YELLOW);
                    
                    for (ServerPlayerEntity player : server.getPlayerManager().getPlayerList()) {
                        player.networkHandler.sendPacket(new TitleS2CPacket(titleText));
                        player.networkHandler.sendPacket(new net.minecraft.network.packet.s2c.play.OverlayMessageS2CPacket(subtitleText));
                    }
                }
            }
        }, delay, TimeUnit.SECONDS);
    }
}

```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –º–µ—Å—Ç–∞ —Å —ç–º–æ–¥–∑–∏ –∏ —Ü–∏—Ñ—Ä–∞–º–∏:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "üëã **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ó–∞–º–µ–Ω—è—é –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–º–æ–¥–∑–∏:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "üëã **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("üëã –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üö™ **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –ë—É–¥–µ–º –∂–¥–∞—Ç—å!",
            "üåô **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! üéÆ", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéÆ", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üëã **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "üëã **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "üëã **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ü—Ä–æ–≤–µ—Ä—è—é –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–º–æ–¥–∑–∏:


```java
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "üö™ **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –ë—É–¥–µ–º –∂–¥–∞—Ç—å!",
            "üåô **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
```

–ó–∞–º–µ–Ω—è—é –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–º–æ–¥–∑–∏:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **0**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + completedCount + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã.

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ** ‚Äî –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ/–æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Embed.

2. **–°–æ–æ–±—â–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Embed** ‚Äî —Å–æ–∑–¥–∞–Ω `RebootEmbedBuilder` –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö Embed-—Å–æ–æ–±—â–µ–Ω–∏–π:
   - –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
   - –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   - –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
   - –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   - –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
   - –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω

3. **–ö–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏ Discord**:
   - `üëã` ‚Üí `<:quit:1445289552515170457>` (–ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–≥—Ä–æ–∫–∞)
   - `üéÆ` ‚Üí `<:login:1445290004170412125>` (–ø—Ä–∏ –≤—Ö–æ–¥–µ –∏–≥—Ä–æ–∫–∞)

4. **–ó–∞–º–µ–Ω–∞ —Ü–∏—Ñ—Ä –Ω–∞ —ç–º–æ–¥–∑–∏** ‚Äî —Å–æ–∑–¥–∞–Ω `EmojiHelper`:
   - –í—Å–µ —Ü–∏—Ñ—Ä—ã –≤ embed-—Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏
   - –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ —Ç.–¥.

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–ú–æ–¥ —Ç–µ–ø–µ—Ä—å:
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Embed-—Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏ Discord
- –ó–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ —Ü–∏—Ñ—Ä—ã –Ω–∞ —ç–º–æ–¥–∑–∏ –≤ embed-—Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- –ö–æ–º–ø–∞–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞—Ç—É—Å–µ —Å–µ—Ä–≤–µ—Ä–∞

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ.

---

**User**

–ù–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ 

:login: –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!

:login: ASSlover –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!

üìä

 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

‚è±Ô∏è

 ASSlover –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: :04::00: —á. :02::08: –º–∏–Ω.

üèÜ

 –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: 300

üé≤

 –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

üèÉ

 ASSlover –ø—Ä–æ–±–µ–∂–∞–ª: :02::01:,:09: –∫–º

–¢.–µ –¥–∞–∂–µ –≤ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: 300 - —Ü–∏—Ñ—Ä—ã –º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –º–æ–∏ —ç–º–æ–¥–∑–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ <:09:1445291248620404866>

---

**Cursor**

```java
    /**
     * Converts a string containing numbers to emoji representation
     * Handles decimal numbers (with comma or dot as separator)
     */
    public static String replaceNumbersInText(String text) {
        if (text == null || text.isEmpty()) {
            return text;
        }
        
        // Replace numbers in the text, including decimal numbers
        StringBuilder result = new StringBuilder();
        StringBuilder currentNumber = new StringBuilder();
        boolean hasDecimalPoint = false;
        
        for (int i = 0; i < text.length(); i++) {
            char c = text.charAt(i);
            
            if (Character.isDigit(c)) {
                currentNumber.append(c);
            } else if ((c == '.' || c == ',') && currentNumber.length() > 0) {
                // Handle decimal separator
                currentNumber.append(c);
                hasDecimalPoint = true;
            } else {
                // End of number
                if (currentNumber.length() > 0) {
                    String numberStr = currentNumber.toString();
                    if (hasDecimalPoint) {
                        // Handle decimal number
                        String[] parts = num
```

–ò—Å–ø—Ä–∞–≤–ª—è—é –∑–∞–º–µ–Ω—É —Ü–∏—Ñ—Ä –Ω–∞ —ç–º–æ–¥–∑–∏: –ø—Ä–æ–≤–µ—Ä—è—é `EmojiHelper` –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö.


–ò—Å–ø—Ä–∞–≤–ª—è—é –∑–∞–º–µ–Ω—É —Ü–∏—Ñ—Ä –Ω–∞ —ç–º–æ–¥–∑–∏ –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
            } else if (minutes > 0) {
                timeString = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
            } else {
                timeString = String.format("%d —Å–µ–∫.", seconds);
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.replaceNumbersInText(timeString) + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = String.format("%d —á. %d –º–∏–Ω.", hours, minutes);
                } else if (minutes > 0) {
                    formattedValue = String.format("%d –º–∏–Ω. %d —Å–µ–∫.", minutes, seconds);
                } else {
                    formattedValue = String.format("%d —Å–µ–∫.", seconds);
                }
            } else {
                formattedValue = String.valueOf(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + EmojiHelper.replaceNumbersInText(formattedValue) + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    // Format with emoji digits
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
```

```java
package com.angella.discord;

/**
 * Helper class for converting numbers to custom Discord emoji
 */
public class EmojiHelper {
    private static final String[] DIGIT_EMOJIS = {
        "<:00:1445290903211343872>", // 0
        "<:01:1445290922521792572>", // 1
        "<:02:1445290960627171349>", // 2
        "<:03:1445290989886509106>", // 3
        "<:04:1445291020282761381>", // 4
        "<:05:1445291055074246779>", // 5
        "<:06:1445291083192991764>", // 6
        "<:07:1445291116470468689>", // 7
        "<:08:1445291214101417984>", // 8
        "<:09:1445291248620404866>"  // 9
    };
    
    /**
     * Converts a number to emoji representation
     */
    public static String numberToEmoji(int number) {
        if (number < 0) {
            return "-" + numberToEmoji(-number);
        }
        if (number == 0) {
            return DIGIT_EMOJIS[0];
        }
        
        StringBuilder result = new StringBuilder();
        while (number > 0) {
            result.insert(0, DIGIT_EMOJIS[number % 10]);
            number /= 10;
        }
        return result.toString();
    }
    
    /**
     * Converts a string containing numbers to emoji representation
     * Handles decimal numbers and regular integers
     */
    public static String replaceNumbersInText(String text) {
        if (text == null || text.isEmpty()) {
            return text;
        }
        
        // Replace numbers in the text, including decimal numbers
        StringBuilder result = new StringBuilder();
        StringBuilder currentNumber = new StringBuilder();
        boolean hasDecimal = false;
        
        for (char c : text.toCharArray()) {
            if (Character.isDigit(c)) {
                currentNumber.append(c);
            } else if (c == '.' && currentNumber.length() > 0) {
                // Handle decimal point
                currentNumber.append(c);
                hasDecimal = true;
            } else {
                if (currentNumber.length() > 0) {
                    String numStr = currentNumber.toString();
                    if (hasDecimal) {
                        // Handle decimal number
                        String[] parts = numStr.split("\\.");
                        if (parts.length == 2) {
                            result.append(numberToEmoji(Integer.parseInt(parts[0])));
                            result.append(".");
                            result.append(numberToEmoji(Integer.parseInt(parts[1])));
                        } else {
                            result.append(numStr); // Fallback
                        }
                    } else {
                        result.append(numberToEmoji(Integer.parseInt(numStr)));
                    }
                    currentNumber.setLength(0);
                    hasDecimal = false;
                }
                result.append(c);
            }
        }
        
        // Handle number at the end
        if (currentNumber.length() > 0) {
            String numStr = currentNumber.toString();
            if (hasDecimal) {
                String[] parts = numStr.split("\\.");
                if (parts.length == 2) {
                    result.append(numberToEmoji(Integer.parseInt(parts[0])));
                    result.append(".");
                    result.append(numberToEmoji(Integer.parseInt(parts[1])));
                } else {
                    result.append(numStr);
                }
            } else {
                result.append(numberToEmoji(Integer.parseInt(numStr)));
            }
        }
        
        return result.toString();
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π —Å –¥–µ—Å—è—Ç–∏—á–Ω—ã–º–∏ –¥—Ä–æ–±—è–º–∏:


```java
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    // Format with emoji digits - handle decimal
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
```

–ò—Å–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Å–ª—É—á–∞–π–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    formattedValue = String.format("%.1f –∫–º", value / 100000.0);
                } else {
                    formattedValue = String.format("%.1f –º", value / 100.0);
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445290004170412125> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–ó–∞–º–µ–Ω–∞ —Ü–∏—Ñ—Ä –Ω–∞ —ç–º–æ–¥–∑–∏ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** ‚Äî —Ç–µ–ø–µ—Ä—å `300` –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `<:03:1445290989886509106><:00:1445290903211343872><:00:1445290903211343872>`.

2. **–ó–∞–º–µ–Ω–∞ —Ü–∏—Ñ—Ä –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã** ‚Äî –≤—Å–µ —Ü–∏—Ñ—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ "40 —á. 27 –º–∏–Ω." –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —ç–º–æ–¥–∑–∏.

3. **–ó–∞–º–µ–Ω–∞ —Ü–∏—Ñ—Ä –≤ —Å–ª—É—á–∞–π–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ** ‚Äî –≤—Å–µ —á–∏—Å–ª–∞ (–≤–∫–ª—é—á–∞—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è —Å –¥–µ—Å—è—Ç–∏—á–Ω—ã–º–∏ –¥—Ä–æ–±—è–º–∏) –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —ç–º–æ–¥–∑–∏.

4. **–£–ª—É—á—à–µ–Ω `EmojiHelper`** ‚Äî —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ —á–∏—Å–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `2.19 –∫–º`).

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ —ç–º–æ–¥–∑–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ `:login:` –≤–º–µ—Å—Ç–æ `<:login:1445290004170412125>`, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:
- –ë–æ—Ç –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Discord, –≥–¥–µ –¥–æ—Å—Ç—É–ø–Ω—ã —ç—Ç–∏ —ç–º–æ–¥–∑–∏
- –≠–º–æ–¥–∑–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä Discord –∏ —ç–º–æ–¥–∑–∏ –¥–æ—Å—Ç—É–ø–Ω—ã. –ö–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –∫–æ–≥–¥–∞ —ç–º–æ–¥–∑–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã.

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ.

---

**User**

–î–∞ —Å–æ—Ä—è–Ω - —ç–º–æ–¥–∑–∏ –±—ã–ª–∏ –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ - –∑–∞–≥—Ä—É–∑–∏–ª –Ω–∞ –º–æ–π

login - <:login:1445295617722024017>

quit - <:quit:1445295564697894934> 

0 - <:00:1445295647996645418> 

1 - <:01:1445295678808002611>

2 - <:02:1445295731014369351>

3 - <:03:1445295761284796436> 

4 - <:04:1445295788363350087>

5 - <:05:1445295816460996629>

6 - <:06:1445295847716683838> 

7 - <:07:1445295878004015216>

8 - <:08:1445295906810232852>

9 - <:09:1445295940624715807>





–í –ª—é–±—ã—Ö embed –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ü–∏—Ñ—Ä—ã - –∏—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à–∏ —ç–º–æ–¥–∑–∏

---

**Cursor**

–û–±–Ω–æ–≤–ª—è—é ID —ç–º–æ–¥–∑–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è—é, —á—Ç–æ –≤—Å–µ —Ü–∏—Ñ—Ä—ã –≤ embed –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —ç–º–æ–¥–∑–∏.


–û–±–Ω–æ–≤–ª—è—é ID —ç–º–æ–¥–∑–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è—é, —á—Ç–æ –≤—Å–µ —Ü–∏—Ñ—Ä—ã –≤ embed –∑–∞–º–µ–Ω—è—é—Ç—Å—è.


```java
package com.angella.discord;

/**
 * Helper class for converting numbers to custom Discord emoji
 */
public class EmojiHelper {
    private static final String[] DIGIT_EMOJIS = {
        "<:00:1445295647996645418>", // 0
        "<:01:1445295678808002611>", // 1
        "<:02:1445295731014369351>", // 2
        "<:03:1445295761284796436>", // 3
        "<:04:1445295788363350087>", // 4
        "<:05:1445295816460996629>", // 5
        "<:06:1445295847716683838>", // 6
        "<:07:1445295878004015216>", // 7
        "<:08:1445295906810232852>", // 8
        "<:09:1445295940624715807>"  // 9
    };
    
    /**
     * Converts a number to emoji representation
     */
    public static String numberToEmoji(int number) {
        if (number < 0) {
            return "-" + numberToEmoji(-number);
        }
        if (number == 0) {
            return DIGIT_EMOJIS[0];
        }
        
        StringBuilder result = new StringBuilder();
        while (number > 0) {
            result.insert(0, DIGIT_EMOJIS[number % 10]);
            number /= 10;
        }
        return result.toString();
    }
    
    /**
     * Converts a string containing numbers to emoji representation
     * Handles decimal numbers and regular integers
     */
    public static String replaceNumbersInText(String text) {
        if (text == null || text.isEmpty()) {
            return text;
        }
        
        // Replace numbers in the text, including decimal numbers
        StringBuilder result = new StringBuilder();
        StringBuilder currentNumber = new StringBuilder();
        boolean hasDecimal = false;
        
        for (char c : text.toCharArray()) {
            if (Character.isDigit(c)) {
                currentNumber.append(c);
            } else if (c == '.' && currentNumber.length() > 0) {
                // Handle decimal point
                currentNumber.append(c);
                hasDecimal = true;
            } else {
                if (currentNumber.length() > 0) {
                    String numStr = currentNumber.toString();
                    if (hasDecimal) {
                        // Handle decimal number
                        String[] parts = numStr.split("\\.");
                        if (parts.length == 2) {
                            result.append(numberToEmoji(Integer.parseInt(parts[0])));
                            result.append(".");
                            result.append(numberToEmoji(Integer.parseInt(parts[1])));
                        } else {
                            result.append(numStr); // Fallback
                        }
                    } else {
                        result.append(numberToEmoji(Integer.parseInt(numStr)));
                    }
                    currentNumber.setLength(0);
                    hasDecimal = false;
                }
                result.append(c);
            }
        }
        
        // Handle number at the end
        if (currentNumber.length() > 0) {
            String numStr = currentNumber.toString();
            if (hasDecimal) {
                String[] parts = numStr.split("\\.");
                if (parts.length == 2) {
                    result.append(numberToEmoji(Integer.parseInt(parts[0])));
                    result.append(".");
                    result.append(numberToEmoji(Integer.parseInt(parts[1])));
                } else {
                    result.append(numStr);
                }
            } else {
                result.append(numberToEmoji(Integer.parseInt(numStr)));
            }
        }
        
        return result.toString();
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445290004170412125> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445290004170412125> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445289552515170457> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445289552515170457> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445289552515170457> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445289552515170457> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445289552515170457>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445290004170412125>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.EmbedBuilder;
import net.dv8tion.jda.api.entities.MessageEmbed;

import java.awt.Color;
import java.time.Instant;

public class RebootEmbedBuilder {
    
    public static MessageEmbed createRebootScheduledEmbed(String reason, String executorName, AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üîÑ –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞");
        builder.setDescription("‚è∞ **–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:** " + EmojiHelper.numberToEmoji(5) + " –º–∏–Ω—É—Ç\n" +
                              "üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason);
        if (executorName != null && !executorName.isEmpty()) {
            builder.addField("üë§ –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä", executorName, false);
        }
        builder.setColor(Color.decode("#FFA500")); // Orange
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createRebootInProgressEmbed(String reason, AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üîÑ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...");
        builder.setDescription("üìù **–ü—Ä–∏—á–∏–Ω–∞:** " + reason);
        builder.setColor(Color.decode("#FF4500")); // Red-orange
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStoppingEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üü† –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...");
        builder.setDescription("üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö\nüëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤\nüîå –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã");
        builder.setColor(Color.decode("#FF8C00")); // Dark orange
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella ‚Ä¢ –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏! üëã", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStoppedEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üî¥ –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
        builder.setDescription("–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã\n–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞!");
        builder.setColor(Color.decode("#DC143C")); // Crimson
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStartingEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üü° –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...");
        builder.setDescription("‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º\nüì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–æ–≤\nüåç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∏—Ä–∞");
        builder.setColor(Color.decode("#FFD700")); // Gold
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella", null);
        return builder.build();
    }
    
    public static MessageEmbed createServerStartedEmbed(AngellaConfig config) {
        EmbedBuilder builder = new EmbedBuilder();
        builder.setTitle("üü¢ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!");
        builder.setDescription("‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç\nüéÆ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∏–≥—Ä–æ–∫–æ–≤\nüöÄ –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –∏–≥—Ä–∞—Ç—å!");
        builder.setColor(Color.decode("#00FF00")); // Green
        builder.setTimestamp(Instant.now());
        builder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –≤—Å–µ–º! üéâ", null);
        return builder.build();
    }
}


```

```java
package com.angella.discord;

import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.EmbedBuilder;
import net.dv8tion.jda.api.entities.MessageEmbed;

import java.awt.Color;
import java.time.Instant;
```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –û–±–Ω–æ–≤–ª–µ–Ω—ã ID —ç–º–æ–¥–∑–∏. –ü—Ä–æ–≤–µ—Ä—è—é, —á—Ç–æ –≤—Å–µ —Ü–∏—Ñ—Ä—ã –≤ embed –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —ç–º–æ–¥–∑–∏:


–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ ID —ç–º–æ–¥–∑–∏.

## –ß—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:

1. **ID —ç–º–æ–¥–∑–∏ –¥–ª—è —Ü–∏—Ñ—Ä 0-9** ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ `EmojiHelper.java`
2. **ID —ç–º–æ–¥–∑–∏ login** ‚Äî `<:login:1445295617722024017>` (–±—ã–ª–æ 1445290004170412125)
3. **ID —ç–º–æ–¥–∑–∏ quit** ‚Äî `<:quit:1445295564697894934>` (–±—ã–ª–æ 1445289552515170457)
4. **–ó–∞–º–µ–Ω–∞ —Ü–∏—Ñ—Ä –Ω–∞ —ç–º–æ–¥–∑–∏** ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö embed —Å–æ–æ–±—â–µ–Ω–∏—è—Ö:
   - –í—Ä–µ–º—è –∏–≥—Ä—ã –∏–≥—Ä–æ–∫–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
   - –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–≤–∫–ª—é—á–∞—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è —Å –¥–µ—Å—è—Ç–∏—á–Ω—ã–º–∏ –¥—Ä–æ–±—è–º–∏)
   - –°–æ–æ–±—â–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ (5 –º–∏–Ω—É—Ç)

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–í—Å–µ —Ü–∏—Ñ—Ä—ã –≤ embed —Å–æ–æ–±—â–µ–Ω–∏—è—Ö —Ç–µ–ø–µ—Ä—å –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –≤–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏ Discord. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ.

---

**User**

–î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —Å–∏—Å—Ç–µ–º—É —Ç–∞–∫ –∂–µ –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–π " –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ "
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –≤ –∏–≥—Ä–µ /verif  - –µ–º—É –ø–∏—à—É—Ç—Å—è —Ü–∏—Ñ—Ä—ã –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –≤–≤–µ—Å—Ç–∏ –≤ –∫–∞–Ω–∞–ª–µ 1444857215172345886 ; –ü–æ—Å–ª–µ –≤–≤–µ–¥–µ–Ω–∏—è —Ü–∏—Ñ—Ä - –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è , –∞ –µ–≥–æ –¥–∏—Å–∫–æ—Ä–¥ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –Ω—ã–Ω–µ—à–Ω–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é –º–∞–π–Ω–∫—Ä–∞—Ñ—Ç–∞ –∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Å–ø—Ä–∞–≤–∞ –æ—Ç –µ–≥–æ –Ω–∏–∫–Ω–µ–π–º–∞ —Ç–∞–∫ –∂–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –µ–≥–æ –¥–∏—Å–∫–æ—Ä–¥ –ø—Ä–æ—Ñ–∏–ª—è - –¥–∞–±—ã –ª—é–¥—è–º –±—ã–ª–æ –ø—Ä–æ—â–µ –Ω–∞–π—Ç–∏ –µ–≥–æ –∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–Ω–∏–º–∞–ª–∏ –∫—Ç–æ —ç—Ç–æ

–¢–æ–µ—Å—Ç—å —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç , –ø—Ä–∏–º–µ—Ä :
ASSlover | <@80351110224678912> | ( –¢—É—Ç –±—É–¥–µ—Ç id —ç–º–æ—Ü–∏–∏ - –≤–µ—Ä–µ—Ñ–∏–∫–∞—Ü–∏–∏ )
–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!


id —ç–º–æ—Ü–∏–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ - 1445465170255024384

–≠—Ç–æ —ç–º–æ–¥–∑–∏ —è –∑–∞–≥—Ä—É–∑–∏–ª –≤ –±–æ—Ç–∞ —Ç—É—Ç https://discord.com/developers/applications/1339807926377775182/emojis 
–ù—É –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞—Ö–æ–¥–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–µ—Ä–∏—Ñ–∞—Ç—å—Å—è - –±–æ—Ç –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —ç—Ç–æ –∏ —Ç–¥

–ü—Ä–∏ –∫–æ–º–∞–Ω–¥–µ /verifdelete - —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ –∞–∫–∫–∞—É–Ω—Ç –æ—Ç–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–ø–∞–¥–∞–µ—Ç

---

**Cursor**

–î–æ–±–∞–≤–ª—è—é —Å–∏—Å—Ç–µ–º—É –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ Discord. –°–æ–∑–¥–∞—é –∫–æ–º–∞–Ω–¥—ã –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π:


```java
package com.angella.verification;

import com.angella.AngellaMod;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;
import net.fabricmc.loader.api.FabricLoader;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Path;
import java.util.HashMap;
import java.util.Map;
import java.util.UUID;
import java.util.concurrent.ConcurrentHashMap;

public class VerificationManager {
    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
    private static final Path VERIFICATION_PATH = FabricLoader.getInstance().getConfigDir().resolve("angella_verifications.json");
    
    // UUID –∏–≥—Ä–æ–∫–∞ -> Discord ID
    private static final Map<UUID, Long> verifiedPlayers = new ConcurrentHashMap<>();
    
    // –ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ -> UUID –∏–≥—Ä–æ–∫–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –æ—á–∏—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
    private static final Map<String, UUID> pendingVerifications = new ConcurrentHashMap<>();
    
    public static void load() {
        File file = VERIFICATION_PATH.toFile();
        if (file.exists()) {
            try (FileReader reader = new FileReader(file)) {
                JsonObject json = JsonParser.parseReader(reader).getAsJsonObject();
                verifiedPlayers.clear();
                
                for (String key : json.keySet()) {
                    try {
                        UUID playerUuid = UUID.fromString(key);
                        long discordId = json.get(key).getAsLong();
                        verifiedPlayers.put(playerUuid, discordId);
                    } catch (Exception e) {
                        AngellaMod.LOGGER.warn("Failed to load verification for {}: {}", key, e.getMessage());
                    }
                }
                
                AngellaMod.LOGGER.info("Loaded {} verified players", verifiedPlayers.size());
            } catch (IOException e) {
                AngellaMod.LOGGER.error("Failed to load verifications", e);
            }
        }
    }
    
    public static void save() {
        File file = VERIFICATION_PATH.toFile();
        try {
            if (!file.getParentFile().exists()) {
                file.getParentFile().mkdirs();
            }
            
            JsonObject json = new JsonObject();
            for (Map.Entry<UUID, Long> entry : verifiedPlayers.entrySet()) {
                json.addProperty(entry.getKey().toString(), entry.getValue());
            }
            
            try (FileWriter writer = new FileWriter(file)) {
                GSON.toJson(json, writer);
            }
            
            AngellaMod.LOGGER.debug("Saved {} verifications", verifiedPlayers.size());
        } catch (IOException e) {
            AngellaMod.LOGGER.error("Failed to save verifications", e);
        }
    }
    
    /**
     * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∏–≥—Ä–æ–∫–∞
     */
    public static String generateVerificationCode(UUID playerUuid) {
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
        int code = (int)(Math.random() * 900000) + 100000; // –û—Ç 100000 –¥–æ 999999
        String codeStr = String.valueOf(code);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–≤—è–∑—å –∫–æ–¥ -> UUID
        pendingVerifications.put(codeStr, playerUuid);
        
        // –£–¥–∞–ª—è–µ–º –∫–æ–¥ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç
        new java.util.Timer().schedule(new java.util.TimerTask() {
            @Override
            public void run() {
                pendingVerifications.remove(codeStr);
            }
        }, 5 * 60 * 1000);
        
        return codeStr;
    }
    
    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∏–≥—Ä–æ–∫–∞ —Å Discord
     */
    public static boolean verifyPlayer(String code, long discordId) {
        UUID playerUuid = pendingVerifications.remove(code);
        if (playerUuid != null) {
            verifiedPlayers.put(playerUuid, discordId);
            save();
            AngellaMod.LOGGER.info("Player {} verified with Discord ID {}", playerUuid, discordId);
            return true;
        }
        return false;
    }
    
    /**
     * –ü–æ–ª—É—á–∞–µ—Ç Discord ID –∏–≥—Ä–æ–∫–∞, –µ—Å–ª–∏ –æ–Ω –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
     */
    public static Long getDiscordId(UUID playerUuid) {
        return verifiedPlayers.get(playerUuid);
    }
    
    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ –∏–≥—Ä–æ–∫
     */
    public static boolean isVerified(UUID playerUuid) {
        return verifiedPlayers.containsKey(playerUuid);
    }
    
    /**
     * –£–¥–∞–ª—è–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –∏–≥—Ä–æ–∫–∞
     */
    public static boolean removeVerification(UUID playerUuid) {
        if (verifiedPlayers.remove(playerUuid) != null) {
            save();
            AngellaMod.LOGGER.info("Removed verification for player {}", playerUuid);
            return true;
        }
        return false;
    }
}

```

```java
package com.angella.commands;

import com.angella.verification.VerificationManager;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;

public class VerifCommand {
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("verif")
                    .executes(VerifCommand::execute));
        });
    }
    
    private static int execute(CommandContext<ServerCommandSource> context) {
        ServerCommandSource source = context.getSource();
        
        if (!(source.getEntity() instanceof ServerPlayerEntity)) {
            source.sendFeedback(() -> Text.literal("‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫–∞–º!"), false);
            return 0;
        }
        
        ServerPlayerEntity player = (ServerPlayerEntity) source.getEntity();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ –∏–≥—Ä–æ–∫
        if (VerificationManager.isVerified(player.getUuid())) {
            Long discordId = VerificationManager.getDiscordId(player.getUuid());
            source.sendFeedback(() -> Text.literal("‚úÖ –í—ã —É–∂–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã! Discord ID: " + discordId)
                    .formatted(Formatting.GREEN), false);
            return 1;
        }
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
        String code = VerificationManager.generateVerificationCode(player.getUuid());
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–≥—Ä–æ–∫—É
        source.sendFeedback(() -> Text.literal("üîê **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Discord**\n\n")
                .formatted(Formatting.GOLD)
                .append(Text.literal("–í–∞—à –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: ").formatted(Formatting.YELLOW))
                .append(Text.literal(code).formatted(Formatting.BOLD, Formatting.GREEN))
                .append(Text.literal("\n\n–í–≤–µ–¥–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ Discord –∫–∞–Ω–∞–ª–µ #–∏–≥—Ä–æ–≤—ã–µ-—Å–æ–±—ã—Ç–∏—è\n")
                        .formatted(Formatting.YELLOW))
                .append(Text.literal("–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç!")
                        .formatted(Formatting.RED)), false);
        
        return 1;
    }
}

```

```java
package com.angella.commands;

import com.angella.verification.VerificationManager;
import com.mojang.brigadier.context.CommandContext;
import net.fabricmc.fabric.api.command.v2.CommandRegistrationCallback;
import net.minecraft.server.command.CommandManager;
import net.minecraft.server.command.ServerCommandSource;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import net.minecraft.util.Formatting;

public class VerifDeleteCommand {
    
    public static void register() {
        CommandRegistrationCallback.EVENT.register((dispatcher, registryAccess, environment) -> {
            dispatcher.register(CommandManager.literal("verifdelete")
                    .executes(VerifDeleteCommand::execute));
        });
    }
    
    private static int execute(CommandContext<ServerCommandSource> context) {
        ServerCommandSource source = context.getSource();
        
        if (!(source.getEntity() instanceof ServerPlayerEntity)) {
            source.sendFeedback(() -> Text.literal("‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫–∞–º!"), false);
            return 0;
        }
        
        ServerPlayerEntity player = (ServerPlayerEntity) source.getEntity();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ª–∏ –∏–≥—Ä–æ–∫
        if (!VerificationManager.isVerified(player.getUuid())) {
            source.sendFeedback(() -> Text.literal("‚ùå –í—ã –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã!")
                    .formatted(Formatting.RED), false);
            return 0;
        }
        
        // –£–¥–∞–ª—è–µ–º –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
        if (VerificationManager.removeVerification(player.getUuid())) {
            source.sendFeedback(() -> Text.literal("‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞!")
                    .formatted(Formatting.GREEN), false);
            return 1;
        } else {
            source.sendFeedback(() -> Text.literal("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏!")
                    .formatted(Formatting.RED), false);
            return 0;
        }
    }
}

```

–î–æ–±–∞–≤–ª—è—é —Å–ª—É—à–∞—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π Discord –∏ –æ–±–Ω–æ–≤–ª—è—é EmbedBuilder:


```java
package com.angella;

import com.angella.config.AngellaConfig;
import com.angella.discord.DiscordBot;
import com.angella.events.PlayerEventHandler;
import com.angella.commands.RebootUpdateCommand;
import com.angella.commands.VerifCommand;
import com.angella.commands.VerifDeleteCommand;
import com.angella.verification.VerificationManager;
import net.fabricmc.api.ModInitializer;
import net.fabricmc.fabric.api.event.lifecycle.v1.ServerLifecycleEvents;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class AngellaMod implements ModInitializer {
    public static final String MOD_ID = "angella";
    public static final Logger LOGGER = LoggerFactory.getLogger(MOD_ID);
    
    private static DiscordBot discordBot;
    private static AngellaConfig config;

    @Override
    public void onInitialize() {
        LOGGER.info("Initializing Angella Discord Integration Mod");
        
        // Load configuration
        config = AngellaConfig.load();
        
        // Initialize Discord bot
        if (config.isEnabled() && config.getBotToken() != null && !config.getBotToken().isEmpty()) {
            try {
                discordBot = new DiscordBot(config);
                discordBot.start();
                LOGGER.info("Discord bot started successfully!");
            } catch (Exception e) {
                LOGGER.error("Failed to start Discord bot", e);
            }
        } else {
            LOGGER.warn("Discord bot is disabled or token is not configured. Please check your config file.");
        }
        
        // Register event handlers
        PlayerEventHandler.register();
        
        // Register commands
        RebootUpdateCommand.register();
        
        // Register server lifecycle events
        ServerLifecycleEvents.SERVER_STARTING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarting();
            }
        });
        
        ServerLifecycleEvents.SERVER_STARTED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarted();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopping();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopped();
            }
        });
    }
    
    public static DiscordBot getDiscordBot() {
        return discordBot;
    }
    
    public static AngellaConfig getConfig() {
        return config;
    }
}


```

```java
package com.angella;

import com.angella.config.AngellaConfig;
import com.angella.discord.DiscordBot;
import com.angella.events.PlayerEventHandler;
import com.angella.commands.RebootUpdateCommand;
import com.angella.commands.VerifCommand;
import com.angella.commands.VerifDeleteCommand;
import com.angella.verification.VerificationManager;
import net.fabricmc.api.ModInitializer;
import net.fabricmc.fabric.api.event.lifecycle.v1.ServerLifecycleEvents;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class AngellaMod implements ModInitializer {
    public static final String MOD_ID = "angella";
    public static final Logger LOGGER = LoggerFactory.getLogger(MOD_ID);
    
    private static DiscordBot discordBot;
    private static AngellaConfig config;

    @Override
    public void onInitialize() {
        LOGGER.info("Initializing Angella Discord Integration Mod");
        
        // Load configuration
        config = AngellaConfig.load();
        
        // Initialize Discord bot
        if (config.isEnabled() && config.getBotToken() != null && !config.getBotToken().isEmpty()) {
            try {
                discordBot = new DiscordBot(config);
                discordBot.start();
                LOGGER.info("Discord bot started successfully!");
            } catch (Exception e) {
                LOGGER.error("Failed to start Discord bot", e);
            }
        } else {
            LOGGER.warn("Discord bot is disabled or token is not configured. Please check your config file.");
        }
        
        // Register event handlers
        PlayerEventHandler.register();
        
        // Load verifications
        VerificationManager.load();
        
        // Register commands
        RebootUpdateCommand.register();
        VerifCommand.register();
        VerifDeleteCommand.register();
        
        // Register server lifecycle events
        ServerLifecycleEvents.SERVER_STARTING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarting();
            }
        });
        
        ServerLifecycleEvents.SERVER_STARTED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStarted();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPING.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopping();
            }
        });
        
        ServerLifecycleEvents.SERVER_STOPPED.register(server -> {
            if (discordBot != null) {
                discordBot.onServerStopped();
            }
        });
    }
    
    public static DiscordBot getDiscordBot() {
        return discordBot;
    }
    
    public static AngellaConfig getConfig() {
        return config;
    }
}


```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.events.message.MessageReceivedEvent;
import net.dv8tion.jda.api.hooks.ListenerAdapter;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import com.angella.verification.VerificationManager;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set playing status with server IP
            jda.getPresence().setActivity(Activity.playing("213.171.18.211:30081"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartedEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppedEmbed(config)).queue();
            });
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.events.message.MessageReceivedEvent;
import net.dv8tion.jda.api.hooks.ListenerAdapter;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import com.angella.verification.VerificationManager;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .addEventListeners(new VerificationMessageListener())
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set playing status with server IP
            jda.getPresence().setActivity(Activity.playing("213.171.18.211:30081"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartedEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppedEmbed(config)).queue();
            });
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
}

```

```java
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
    
    /**
     * Listener for verification messages in Discord
     */
    private static class VerificationMessageListener extends ListenerAdapter {
        @Override
        public void onMessageReceived(MessageReceivedEvent event) {
            // Ignore bot messages
            if (event.getAuthor().isBot()) {
                return;
            }
            
            // Only listen to game channel (1444857215172345886)
            if (event.getChannel().getIdLong() != 1444857215172345886L) {
                return;
            }
            
            String messageContent = event.getMessage().getContentRaw().trim();
            
            // Check if message is a 6-digit code
            if (messageContent.matches("\\d{6}")) {
                long discordId = event.getAuthor().getIdLong();
                
                // Try to verify
                if (VerificationManager.verifyPlayer(messageContent, discordId)) {
                    // Delete the message
                    event.getMessage().delete().queue();
                    
                    // Send confirmation (temporary message that will be deleted)
                    event.getChannel().sendMessage("‚úÖ **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!**\n" +
                            "–í–∞—à Discord –∞–∫–∫–∞—É–Ω—Ç —Ç–µ–ø–µ—Ä—å —Å–≤—è–∑–∞–Ω —Å Minecraft!")
                            .queue(msg -> {
                                // Delete confirmation message after 5 seconds
                                msg.delete().queueAfter(5, java.util.concurrent.TimeUnit.SECONDS);
                            });
                    
                    LOGGER.info("Player verified: Discord ID {} with code {}", discordId, messageContent);
                } else {
                    // Invalid code - delete message anyway
                    event.getMessage().delete().queue();
                }
            }
        }
    }
}
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + verificationBadge + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
```

–ü—Ä–æ–≤–µ—Ä—è—é –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é –∫–ª–∞—Å—Å —Å–ª—É—à–∞—Ç–µ–ª—è:


–î–æ–±–∞–≤–ª—è—é –∫–ª–∞—Å—Å —Å–ª—É—à–∞—Ç–µ–ª—è –≤ DiscordBot:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import net.dv8tion.jda.api.JDA;
import net.dv8tion.jda.api.JDABuilder;
import net.dv8tion.jda.api.entities.Activity;
import net.dv8tion.jda.api.entities.Message;
import net.dv8tion.jda.api.entities.channel.concrete.TextChannel;
import net.dv8tion.jda.api.events.message.MessageReceivedEvent;
import net.dv8tion.jda.api.hooks.ListenerAdapter;
import net.dv8tion.jda.api.requests.GatewayIntent;
import net.dv8tion.jda.api.utils.cache.CacheFlag;
import com.angella.verification.VerificationManager;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class DiscordBot {
    private static final Logger LOGGER = LoggerFactory.getLogger(DiscordBot.class);
    
    private final AngellaConfig config;
    private JDA jda;
    private TextChannel technicalChannel;
    private TextChannel gameChannel;
    private Message serverStartMessage;
    private ScheduledExecutorService scheduler;
    
    public DiscordBot(AngellaConfig config) {
        this.config = config;
    }
    
    public void start() throws InterruptedException {
        if (config.getBotToken() == null || config.getBotToken().isEmpty()) {
            throw new IllegalStateException("Bot token is not configured!");
        }
        
        LOGGER.info("Starting Discord bot...");
        
        jda = JDABuilder.createDefault(config.getBotToken())
                .enableIntents(GatewayIntent.MESSAGE_CONTENT)
                .disableCache(CacheFlag.VOICE_STATE, CacheFlag.EMOJI, CacheFlag.STICKER, CacheFlag.SCHEDULED_EVENTS)
                .addEventListeners(new VerificationMessageListener())
                .build();
        
        jda.awaitReady();
        
        // Get channels
        if (config.getTechnicalChannelId() != 0L) {
            technicalChannel = jda.getTextChannelById(config.getTechnicalChannelId());
            if (technicalChannel == null) {
                LOGGER.warn("Technical channel with ID {} not found! Please check your config.", config.getTechnicalChannelId());
            } else {
                LOGGER.info("Connected to technical channel: {}", technicalChannel.getName());
            }
        }
        
        if (config.getGameChannelId() != 0L) {
            gameChannel = jda.getTextChannelById(config.getGameChannelId());
            if (gameChannel == null) {
                LOGGER.warn("Game channel with ID {} not found! Please check your config.", config.getGameChannelId());
            } else {
                LOGGER.info("Connected to game channel: {}", gameChannel.getName());
            }
        }
        
        LOGGER.info("Discord bot is ready!");
        
        // Set bot activity/status
        setBotActivity();
        
        // Send startup message
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessage("‚úÖ **Angella –∑–∞–ø—É—â–µ–Ω!**\n\nüéÆ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!\nü§ñ –ë–æ—Ç –ø–æ–¥–Ω—è—Ç –∏ –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!\n\n*–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ* ‚ú®").queue();
            });
        }
        
        // Initialize scheduler for dynamic updates
        scheduler = Executors.newScheduledThreadPool(1);
    }
    
    public void shutdown() {
        if (scheduler != null) {
            scheduler.shutdown();
        }
        if (jda != null) {
            jda.shutdown();
            LOGGER.info("Discord bot shutdown complete.");
        }
    }
    
    private void setBotActivity() {
        if (jda != null) {
            // Set playing status with server IP
            jda.getPresence().setActivity(Activity.playing("213.171.18.211:30081"));
        }
    }
    
    public TextChannel getTechnicalChannel() {
        return technicalChannel;
    }
    
    public TextChannel getGameChannel() {
        return gameChannel;
    }
    
    public boolean isReady() {
        return jda != null && jda.getStatus() == JDA.Status.CONNECTED && gameChannel != null;
    }
    
    public void onServerStarting() {
        if (config.sendServerStart && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStarted() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStartedEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopping() {
        if (config.sendServerStop && technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppingEmbed(config)).queue();
            });
        }
    }
    
    public void onServerStopped() {
        if (technicalChannel != null) {
            CompletableFuture.runAsync(() -> {
                technicalChannel.sendMessageEmbeds(RebootEmbedBuilder.createServerStoppedEmbed(config)).queue();
            });
        }
        shutdown();
    }
    
    /**
     * Sends an error message to technical channel
     */
    public void sendError(String error) {
        if (technicalChannel != null) {
            technicalChannel.sendMessage("‚ùå **–û—à–∏–±–∫–∞:**\n```\n" + error + "\n```").queue();
        }
    }
    
    /**
     * Listener for verification messages in Discord
     */
    private static class VerificationMessageListener extends ListenerAdapter {
        @Override
        public void onMessageReceived(MessageReceivedEvent event) {
            // Ignore bot messages
            if (event.getAuthor().isBot()) {
                return;
            }
            
            // Only listen to game channel (1444857215172345886)
            if (event.getChannel().getIdLong() != 1444857215172345886L) {
                return;
            }
            
            String messageContent = event.getMessage().getContentRaw().trim();
            
            // Check if message is a 6-digit code
            if (messageContent.matches("\\d{6}")) {
                long discordId = event.getAuthor().getIdLong();
                
                // Try to verify
                if (VerificationManager.verifyPlayer(messageContent, discordId)) {
                    // Delete the message
                    event.getMessage().delete().queue();
                    
                    // Send confirmation (temporary message that will be deleted)
                    event.getChannel().sendMessage("‚úÖ **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!**\n" +
                            "–í–∞—à Discord –∞–∫–∫–∞—É–Ω—Ç —Ç–µ–ø–µ—Ä—å —Å–≤—è–∑–∞–Ω —Å Minecraft!")
                            .queue(msg -> {
                                // Delete confirmation message after 5 seconds
                                msg.delete().queueAfter(5, java.util.concurrent.TimeUnit.SECONDS);
                            });
                    
                    LOGGER.info("Player verified: Discord ID {} with code {}", discordId, messageContent);
                } else {
                    // Invalid code - delete message anyway
                    event.getMessage().delete().queue();
                }
            }
        }
    }
}

```

–°–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç:


–î–æ–±–∞–≤–ª—è—é –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ —Å–º–µ—Ä—Ç–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "** " + deathInfo.message);
```

```java
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText = chatMessage != null ? chatMessage.getString() : 
            playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        
        // If using chat message, add verification badge if player is verified
        if (chatMessage != null && discordId != null) {
            // Try to add verification badge to the message
            String originalText = chatMessage.getString();
            if (!originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–ü—Ä–æ–≤–µ—Ä—è—é –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É: –¥–æ–±–∞–≤–ª—è—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –º–µ—Ç–æ–¥–µ:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "** –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "** —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "** –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "** –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "** –≤–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞.

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–ö–æ–º–∞–Ω–¥–∞ `/verif`** –≤ –∏–≥—Ä–µ:
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–≥—Ä–æ–∫—É –∫–æ–¥
   - –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç
   - –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ —É–∂–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –µ–≥–æ Discord ID

2. **–ö–æ–º–∞–Ω–¥–∞ `/verifdelete`** –≤ –∏–≥—Ä–µ:
   - –£–¥–∞–ª—è–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –∏–≥—Ä–æ–∫–∞
   - –û—Ç–≤—è–∑—ã–≤–∞–µ—Ç Discord –∞–∫–∫–∞—É–Ω—Ç –æ—Ç Minecraft

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Discord**:
   - –ë–æ—Ç —Å–ª—É—à–∞–µ—Ç –∫–∞–Ω–∞–ª `1444857215172345886`
   - –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ 6-–∑–Ω–∞—á–Ω–æ–≥–æ –∫–æ–¥–∞:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥
     - –£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
     - –°–≤—è–∑—ã–≤–∞–µ—Ç Discord ID —Å UUID –∏–≥—Ä–æ–∫–∞
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (—É–¥–∞–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥)

4. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ embed**:
   - –ü—Ä–∏ –≤—Ö–æ–¥–µ: `ASSlover | <@80351110224678912> | <:verification:1445465170255024384>`
   - –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ: —Ç–æ –∂–µ —Å–∞–º–æ–µ
   - –ü—Ä–∏ —Å–º–µ—Ä—Ç–∏: —Ç–æ –∂–µ —Å–∞–º–æ–µ
   - –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö: —Ç–æ –∂–µ —Å–∞–º–æ–µ

5. **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**:
   - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `config/angella_verifications.json`
   - –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
   - –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
1. –ò–≥—Ä–æ–∫ –≤–≤–æ–¥–∏—Ç `/verif` –≤ –∏–≥—Ä–µ
2. –ü–æ–ª—É—á–∞–µ—Ç –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `123456`)
3. –í–≤–æ–¥–∏—Ç –∫–æ–¥ –≤ Discord –∫–∞–Ω–∞–ª–µ `#–∏–≥—Ä–æ–≤—ã–µ-—Å–æ–±—ã—Ç–∏—è`
4. –ë–æ—Ç —É–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã
5. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –≤ embed –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

**User**

C—É–ø–µ—Ä! –ö—Ä–∞—Å–∞–≤—á–∏–∫!



üéâ ASSlover | @MyAngel üòá | :verification:



–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!



–ü—É—Å–∫–∞–π : –í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö! –∏ –ø–æ—Ö–æ–∂–∏–µ —Ç–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ—á–∫–∏



–ß—Ç–æ–± —Ç–∞–∫–æ–µ üéâ ASSlover | @MyAngel üòá | :verification: –±—ã–ª–æ –Ω–∞ –æ–¥–Ω–æ–π

–ê –í–µ—Ä–Ω—É–ª—Å—è –∏ —Ç–¥ –Ω–∞ —Å—Ç—Ä–æ—á–∫–µ –Ω–∏–∂–µ







---

**Cursor**

–†–∞–∑–¥–µ–ª—è—é –∏–º—è –∏–≥—Ä–æ–∫–∞ —Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "**\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "**\n–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "**\n–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "** " + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + verificationBadge + "**\n–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "**\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "**\n–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "**\n–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + "** —É—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + "** –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + "** –æ—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + "** –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "**\n" + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        // Format message text - if it contains player name with badge, ensure proper line break
        String formattedMessage = messageText;
        if (discordId != null && messageText.contains(playerName + verificationBadge)) {
            // Replace player name with badge to have it on separate line
            formattedMessage = messageText.replaceFirst(playerName + verificationBadge, "**" + playerName + verificationBadge + "**");
            // Ensure there's a line break after the name
            if (!formattedMessage.startsWith("**")) {
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + formattedMessage.replaceFirst("\\*\\*" + playerName + verificationBadge + "\\*\\*", "").trim();
            }
        } else if (discordId != null) {
            // Player is verified but badge not in message yet
            formattedMessage = "**" + playerName + verificationBadge + "**\n" + messageText.replaceFirst(playerName, "").trim();
        } else {
            formattedMessage = "**" + messageText + "**";
        }
        
        builder.embedBuilder.setDescription(comment + "\n\n" + formattedMessage);
```

–ò—Å–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏—è –æ –≤—ã—Ö–æ–¥–µ –∏ —É–ø—Ä–æ—â–∞—é –ª–æ–≥–∏–∫—É –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "**\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "**\n–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "**\n–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + verificationBadge + "**\n–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "**\n" + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        // Format message - ensure player name with badge is on separate line
        String formattedMessage;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessage = "**" + playerName + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + messageText + "**";
            }
        }
        
        builder.embedBuilder.setDescription(comment + "\n\n" + formattedMessage);
```

–ü—Ä–æ–≤–µ—Ä—è—é –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:


–î–æ–±–∞–≤–ª—è—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `verificationBadge` –≤ `createPlayerLeaveEmbed`:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "**\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "**\n–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "**\n–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + verificationBadge + "**\n–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "**\n" + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        builder.embedBuilder.setDescription(comment + "\n\n**" + messageText + "**");
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "üéâ **" + playerName + verificationBadge + "**\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "‚ú® **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "üåü **" + playerName + verificationBadge + "**\n–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "‚ú® **" + playerName + verificationBadge + "**\n–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "<:login:1445295617722024017> **" + playerName + verificationBadge + "**\n–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "üåü **" + playerName + verificationBadge + "**\n–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "üéâ **" + playerName + verificationBadge + "**\n–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String message = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build statistics section
        StringBuilder stats = new StringBuilder();
        if (!playTime.isEmpty()) {
            stats.append(playTime);
        }
        if (!advancementCount.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append(advancementCount);
        }
        if (!randomStat.isEmpty()) {
            if (stats.length() > 0) {
                stats.append("\n");
            }
            stats.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n").append(randomStat);
        }
        
        if (stats.length() > 0) {
            message += "\n\nüìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n" + stats.toString();
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + verificationBadge + "**\n–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "**\n" + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        // Format message - ensure player name with badge is on separate line
        String formattedMessage;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessage = "**" + playerName + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + messageText + "**";
            }
        }
        
        builder.embedBuilder.setDescription(comment + "\n\n" + formattedMessage);
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –°–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç–∞–∫:

**–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞:** `üéâ ASSlover | @MyAngel üòá | :verification:`

**–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞:** `–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!`

–≠—Ç–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –∫–æ –≤—Å–µ–º —Ç–∏–ø–∞–º —Å–æ–æ–±—â–µ–Ω–∏–π:
- –í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞
- –í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞
- –°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª:** `build\libs\angella-1.0.0.jar`

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

**User**

–ó–∞–≥—Ä—É–∑–∏–ª –≤ –±–æ—Ç–∞ –µ—â–µ 

1445748743646347367



–ü—Ä–∏–ª–æ–∂–∏–ª —Ñ–æ—Ç–æ –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —ç–º–æ—Ü–∏—è - —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å



–î–∞–±—ã —Å–¥–µ–ª–∞—Ç—å —Ä–æ–≤–Ω—É—é –Ω–æ—Ä–º–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é - —ç—Ç–æ—Ç —ç–º–æ–¥–∑–∏ 12 —Ä–∞–∑ –≤ —Ä—è–¥ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å - –≤–æ—Ç –ø—Ä–∏–º–µ—Ä –≥–¥–µ —è —ç—Ç–æ—Ç —ç–º–æ–¥–∑–∏ –Ω–∞–∑–≤–∞–ª :blue_dash:  - –≤ –Ω–∞—à–µ–º –±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π 1445748743646347367





:login~1: –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!



:blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: 

:sparkles: ASSlover | @MyAngel :innocent: | :verification:

–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!

:blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: 

:bar_chart: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

:stopwatch:ASSlover –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: :04~1::02~1:—á. :04~1::09~1: –º–∏–Ω.

:trophy:–ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: :03~1::00~1::02~1:

:blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: :blue_dash: 

:game_die: –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞::crab:ASSlover –ø—Ä–æ–ø–æ–ª–∑: :01~1:,:05~1:–∫–º











---

**Cursor**

–î–æ–±–∞–≤–ª—è—é —ç–º–æ–¥–∑–∏-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏ –æ–±–Ω–æ–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ embed-—Å–æ–æ–±—â–µ–Ω–∏–π:


–î–æ–±–∞–≤–ª—è—é —ç–º–æ–¥–∑–∏-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏ –æ–±–Ω–æ–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ embed-—Å–æ–æ–±—â–µ–Ω–∏–π:


```java
package com.angella.discord;

/**
 * Helper class for converting numbers to custom Discord emoji
 */
public class EmojiHelper {
    private static final String[] DIGIT_EMOJIS = {
        "<:00:1445295647996645418>", // 0
        "<:01:1445295678808002611>", // 1
        "<:02:1445295731014369351>", // 2
        "<:03:1445295761284796436>", // 3
        "<:04:1445295788363350087>", // 4
        "<:05:1445295816460996629>", // 5
        "<:06:1445295847716683838>", // 6
        "<:07:1445295878004015216>", // 7
        "<:08:1445295906810232852>", // 8
        "<:09:1445295940624715807>"  // 9
    };
    
    // Blue dash separator emoji
    private static final String BLUE_DASH_EMOJI = "<:blue_dash:1445748743646347367>";
    
    /**
     * Returns a separator line made of 12 blue dash emojis
     */
    public static String getSeparatorLine() {
        return BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + 
               BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + 
               BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + BLUE_DASH_EMOJI + BLUE_DASH_EMOJI;
    }
    
    /**
     * Converts a number to emoji representation
     */
    public static String numberToEmoji(int number) {
        if (number < 0) {
            return "-" + numberToEmoji(-number);
        }
        if (number == 0) {
            return DIGIT_EMOJIS[0];
        }
        
        StringBuilder result = new StringBuilder();
        while (number > 0) {
            result.insert(0, DIGIT_EMOJIS[number % 10]);
            number /= 10;
        }
        return result.toString();
    }
    
    /**
     * Converts a string containing numbers to emoji representation
     * Handles decimal numbers and regular integers
     */
    public static String replaceNumbersInText(String text) {
        if (text == null || text.isEmpty()) {
            return text;
        }
        
        // Replace numbers in the text, including decimal numbers
        StringBuilder result = new StringBuilder();
        StringBuilder currentNumber = new StringBuilder();
        boolean hasDecimal = false;
        
        for (char c : text.toCharArray()) {
            if (Character.isDigit(c)) {
                currentNumber.append(c);
            } else if (c == '.' && currentNumber.length() > 0) {
                // Handle decimal point
                currentNumber.append(c);
                hasDecimal = true;
            } else {
                if (currentNumber.length() > 0) {
                    String numStr = currentNumber.toString();
                    if (hasDecimal) {
                        // Handle decimal number
                        String[] parts = numStr.split("\\.");
                        if (parts.length == 2) {
                            result.append(numberToEmoji(Integer.parseInt(parts[0])));
                            result.append(".");
                            result.append(numberToEmoji(Integer.parseInt(parts[1])));
                        } else {
                            result.append(numStr); // Fallback
                        }
                    } else {
                        result.append(numberToEmoji(Integer.parseInt(numStr)));
                    }
                    currentNumber.setLength(0);
                    hasDecimal = false;
                }
                result.append(c);
            }
        }
        
        // Handle number at the end
        if (currentNumber.length() > 0) {
            String numStr = currentNumber.toString();
            if (hasDecimal) {
                String[] parts = numStr.split("\\.");
                if (parts.length == 2) {
                    result.append(numberToEmoji(Integer.parseInt(parts[0])));
                    result.append(".");
                    result.append(numberToEmoji(Integer.parseInt(parts[1])));
                } else {
                    result.append(numStr);
                }
            } else {
                result.append(numberToEmoji(Integer.parseInt(numStr)));
            }
        }
        
        return result.toString();
    }
}


```

```java
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
```

```java
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;

            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }

            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.warn("Failed to get player advancement count for {}: {}", player.getName().getString(), e.getMessage());
            return "";
        }
    }
```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String messageText = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build description with separators
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("‚ú® **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        
        // Add statistics if available
        if (!playTime.isEmpty() || !advancementCount.isEmpty() || !randomStat.isEmpty()) {
            description.append("üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
            if (!playTime.isEmpty()) {
                description.append(playTime).append("\n");
            }
            if (!advancementCount.isEmpty()) {
                description.append(advancementCount).append("\n");
            }
            if (!randomStat.isEmpty()) {
                description.append(EmojiHelper.getSeparatorLine()).append("\n");
                description.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
                description.append(randomStat).append("\n");
            }
            description.append(EmojiHelper.getSeparatorLine());
        } else {
            description.append(EmojiHelper.getSeparatorLine());
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "üò¢ **" + playerName + verificationBadge + "**\n–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String message = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(message);
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "**\n" + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        // Format message - ensure player name with badge is on separate line
        String formattedMessage;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessage = "**" + playerName + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + messageText + "**";
            }
        }
        
        builder.embedBuilder.setDescription(comment + "\n\n" + formattedMessage);
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–û–±–Ω–æ–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö embed-—Å–æ–æ–±—â–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è—é —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏:


```java
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
```

–û–±–Ω–æ–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö embed-—Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String messageText = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build description with separators
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("‚ú® **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        
        // Add statistics if available
        if (!playTime.isEmpty() || !advancementCount.isEmpty() || !randomStat.isEmpty()) {
            description.append("üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
            if (!playTime.isEmpty()) {
                description.append(playTime).append("\n");
            }
            if (!advancementCount.isEmpty()) {
                description.append(advancementCount).append("\n");
            }
            if (!randomStat.isEmpty()) {
                description.append(EmojiHelper.getSeparatorLine()).append("\n");
                description.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
                description.append(randomStat).append("\n");
            }
            description.append(EmojiHelper.getSeparatorLine());
        } else {
            description.append(EmojiHelper.getSeparatorLine());
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String messageText = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        builder.embedBuilder.setDescription(comment + "\n\n**" + playerName + verificationBadge + "**\n" + deathInfo.message);
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        // Format message - ensure player name with badge is on separate line
        String formattedMessage;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessage = "**" + playerName + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + messageText + "**";
            }
        }
        
        builder.embedBuilder.setDescription(comment + "\n\n" + formattedMessage);
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String messageText = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build description with separators
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("‚ú® **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        
        // Add statistics if available
        if (!playTime.isEmpty() || !advancementCount.isEmpty() || !randomStat.isEmpty()) {
            description.append("üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
            if (!playTime.isEmpty()) {
                description.append(playTime).append("\n");
            }
            if (!advancementCount.isEmpty()) {
                description.append(advancementCount).append("\n");
            }
            if (!randomStat.isEmpty()) {
                description.append(EmojiHelper.getSeparatorLine()).append("\n");
                description.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
                description.append(randomStat).append("\n");
            }
            description.append(EmojiHelper.getSeparatorLine());
        } else {
            description.append(EmojiHelper.getSeparatorLine());
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String messageText = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("**" + playerName + verificationBadge + "**\n");
        description.append(deathInfo.message).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        // Format message - ensure player name with badge is on separate line
        String formattedMessage;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + playerName + verificationBadge + "**\n" + messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessage = "**" + playerName + "**\n" + 
                    messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessage = "**" + messageText + "**";
            }
        }
        
        builder.embedBuilder.setDescription(comment + "\n\n" + formattedMessage);
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

```java
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        // Format message - ensure player name with badge is on separate line
        String formattedMessageText;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessageText = messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessageText = messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessageText = messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessageText = messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessageText = messageText;
            }
        }
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        if (discordId != null) {
            description.append("**" + playerName + verificationBadge + "**\n");
        } else {
            description.append("**" + playerName + "**\n");
        }
        description.append(formattedMessageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setDescription(description.toString());
```

```java
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
```

–ü—Ä–æ–≤–µ—Ä—è—é —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:


–û–±–Ω–æ–≤–ª—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:


```java
package com.angella.discord;

import com.angella.AngellaMod;
import com.angella.config.AngellaConfig;
import com.angella.verification.VerificationManager;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.api.entities.channel.middleman.MessageChannel;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.InputStream;
import java.net.URL;
import java.time.Instant;
import java.util.concurrent.CompletableFuture;
import javax.imageio.ImageIO;

public class EmbedBuilder {
    private final net.dv8tion.jda.api.EmbedBuilder embedBuilder;
    private final AngellaConfig config;
    
    private EmbedBuilder(AngellaConfig config) {
        this.config = config;
        this.embedBuilder = new net.dv8tion.jda.api.EmbedBuilder();
        
        // Set default color
        try {
            Color color = Color.decode(config.getEmbedColor());
            embedBuilder.setColor(color);
        } catch (Exception e) {
            embedBuilder.setColor(Color.decode("#5865F2")); // Default Discord blue
        }
        
        embedBuilder.setTimestamp(Instant.now());
    }
    
    public static EmbedBuilder create(AngellaConfig config) {
        return new EmbedBuilder(config);
    }
    
    public static EmbedBuilder createPlayerJoinEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Check if player is new or returning
        boolean isNewPlayer = isNewPlayer(player);
        String playTime = getPlayerPlayTime(player);
        
        String title = isNewPlayer ? "üéâ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!" : "<:login:1445295617722024017> –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!";
        String[] joinMessages = isNewPlayer ? new String[]{
            "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤–ø–µ—Ä–≤—ã–µ! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!",
            "–í–æ—à–µ–ª –≤ –∏–≥—Ä—É! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∏–≥—Ä–æ–π!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è!"
        } : new String[]{
            "–í–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
            "–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
            "–ü–æ–¥–∫–ª—é—á–∏–ª—Å—è! –†–∞–¥—ã –≤–∏–¥–µ—Ç—å —Ç–µ–±—è —Å–Ω–æ–≤–∞!",
            "–ó–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ!",
            "–í–µ—Ä–Ω—É–ª—Å—è! –£–¥–∞—á–∏ –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!"
        };
        
        String messageText = joinMessages[(int)(Math.random() * joinMessages.length)];
        
        // Get advancement count
        String advancementCount = getPlayerAdvancementCount(player);
        
        // Get random statistic
        String randomStat = getRandomPlayerStatistic(player);
        
        // Build description with separators
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("‚ú® **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        
        // Add statistics if available
        if (!playTime.isEmpty() || !advancementCount.isEmpty() || !randomStat.isEmpty()) {
            description.append("üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
            if (!playTime.isEmpty()) {
                description.append(playTime).append("\n");
            }
            if (!advancementCount.isEmpty()) {
                description.append(advancementCount).append("\n");
            }
            if (!randomStat.isEmpty()) {
                description.append(EmojiHelper.getSeparatorLine()).append("\n");
                description.append("üé≤ **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n");
                description.append(randomStat).append("\n");
            }
            description.append(EmojiHelper.getSeparatorLine());
        } else {
            description.append(EmojiHelper.getSeparatorLine());
        }
        
        builder.embedBuilder.setTitle(title, null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#00FF00")); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ fallback
        
        // Add button for map
        builder.addMapButton("üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞", "http://213.171.18.211:30031/");
        
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static boolean isNewPlayer(ServerPlayerEntity player) {
        try {
            // Check if player has any play time statistics
            // If play time is very low (< 1 minute), consider them new
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            return playTimeTicks < 1200; // Less than 1 minute (20 ticks per second)
        } catch (Exception e) {
            // If we can't determine, assume returning player
            return false;
        }
    }
    
    private static String getPlayerPlayTime(ServerPlayerEntity player) {
        try {
            int playTimeTicks = player.getStatHandler().getStat(net.minecraft.stat.Stats.CUSTOM.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME));
            if (playTimeTicks == 0) {
                return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + EmojiHelper.numberToEmoji(0) + " –º–∏–Ω—É—Ç** (–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫)";
            }
            
            long totalSeconds = playTimeTicks / 20; // Convert ticks to seconds (20 ticks = 1 second)
            long hours = totalSeconds / 3600;
            long minutes = (totalSeconds % 3600) / 60;
            long seconds = totalSeconds % 60;
            
            String timeString;
            if (hours > 0) {
                timeString = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
            } else if (minutes > 0) {
                timeString = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            } else {
                timeString = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
            }
            
            return "‚è±Ô∏è **" + player.getName().getString() + "** –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: **" + timeString + "**";
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getPlayerAdvancementCount(ServerPlayerEntity player) {
        try {
            var advancementTracker = player.getAdvancementTracker();
            int completedCount = 0;
            
            // Count completed advancements
            var server = player.getServer();
            if (server != null) {
                var advancementManager = server.getAdvancementLoader();
                for (var advancement : advancementManager.getAdvancements()) {
                    if (advancement.value().display().isPresent()) {
                        var progress = advancementTracker.getProgress(advancement);
                        if (progress.isDone()) {
                            completedCount++;
                        }
                    }
                }
            }
            
            if (completedCount == 0) {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(0) + "**";
            } else {
                return "üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: **" + EmojiHelper.numberToEmoji(completedCount) + "**";
            }
        } catch (Exception e) {
            return "";
        }
    }
    
    private static String getRandomPlayerStatistic(ServerPlayerEntity player) {
        try {
            var statHandler = player.getStatHandler();
            var stats = net.minecraft.stat.Stats.CUSTOM;
            
            // List of interesting statistics to choose from
            StatInfo[] possibleStats = {
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.OPEN_CHEST), "–æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤", "üì¶"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CRAFTING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤–µ—Ä—Å—Ç–∞–∫–æ–≤", "üî®"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_FURNACE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—á–µ–π", "üî•"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_ANVIL), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–∞–∫–æ–≤–∞–ª–µ–Ω", "‚öíÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_GRINDSTONE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ—á–∏–ª", "‚öôÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_LOOM), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∫–∞—Ü–∫–∏—Ö —Å—Ç–∞–Ω–∫–æ–≤", "üßµ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_STONECUTTER), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–º–Ω–µ—Ä–µ–∑–æ–≤", "‚úÇÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_CARTOGRAPHY_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–æ–ª–æ–≤", "üó∫Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.INTERACT_WITH_SMITHING_TABLE), "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫—É–∑–Ω–µ—á–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TALKED_TO_VILLAGER), "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üë®‚Äçüåæ"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TRADED_WITH_VILLAGER), "—Ç–æ—Ä–≥–æ–≤–∞–ª —Å –∂–∏—Ç–µ–ª—è–º–∏", "üí∞"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DEATHS), "—Ä–∞–∑ —É–º–µ—Ä", "üíÄ", false, false, true, true), // allowZero=true, isHardcore=true
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_DEALT), "–Ω–∞–Ω–µ—Å —É—Ä–æ–Ω–∞", "‚öîÔ∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.DAMAGE_TAKEN), "–ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω–∞", "üõ°Ô∏è"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.WALK_ONE_CM), "–ø—Ä–æ—à–µ–ª –ø–µ—à–∫–æ–º", "üö∂", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SPRINT_ONE_CM), "–ø—Ä–æ–±–µ–∂–∞–ª", "üèÉ", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.SWIM_ONE_CM), "–ø—Ä–æ–ø–ª—ã–ª", "üèä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FLY_ONE_CM), "–ø—Ä–æ–ª–µ—Ç–µ–ª", "‚úàÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CROUCH_ONE_CM), "–ø—Ä–æ–ø–æ–ª–∑", "ü¶Ä", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.CLIMB_ONE_CM), "–≤–∑–æ–±—Ä–∞–ª—Å—è", "üßó", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.FALL_ONE_CM), "—É–ø–∞–ª", "‚¨áÔ∏è", true),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.JUMP), "—Ä–∞–∑ –ø—Ä—ã–≥–Ω—É–ª", "ü¶ò"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.LEAVE_GAME), "—Ä–∞–∑ –≤—ã—Ö–æ–¥–∏–ª –∏–∑ –∏–≥—Ä—ã", "üö™"),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.PLAY_TIME), "–∏–≥—Ä–∞–ª", "‚è±Ô∏è", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_DEATH), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ—Ä—Ç–∏", "‚è∞", false, true, true, false),
                new StatInfo(stats.getOrCreateStat(net.minecraft.stat.Stats.TIME_SINCE_REST), "–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞", "üò¥", false, true, true, false)
            };
            
            // Pick a random statistic
            StatInfo selectedStat = possibleStats[(int)(Math.random() * possibleStats.length)];
            int value = statHandler.getStat(selectedStat.stat);
            
            if (value == 0 && !selectedStat.allowZero) {
                // Try another stat if this one is zero
                for (StatInfo stat : possibleStats) {
                    int statValue = statHandler.getStat(stat.stat);
                    if (statValue > 0 || stat.allowZero) {
                        selectedStat = stat;
                        value = statValue;
                        break;
                    }
                }
            }
            
            String formattedValue;
            if (selectedStat.isDistance) {
                // Convert cm to meters or kilometers
                if (value >= 100000) {
                    double km = value / 100000.0;
                    String kmStr = String.format("%.1f", km);
                    formattedValue = EmojiHelper.replaceNumbersInText(kmStr) + " –∫–º";
                } else {
                    double m = value / 100.0;
                    String mStr = String.format("%.1f", m);
                    formattedValue = EmojiHelper.replaceNumbersInText(mStr) + " –º";
                }
            } else if (selectedStat.isTime) {
                // Convert ticks to time (20 ticks = 1 second)
                long totalSeconds = value / 20;
                long hours = totalSeconds / 3600;
                long minutes = (totalSeconds % 3600) / 60;
                long seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)hours) + " —á. " + EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω.";
                } else if (minutes > 0) {
                    formattedValue = EmojiHelper.numberToEmoji((int)minutes) + " –º–∏–Ω. " + EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                } else {
                    formattedValue = EmojiHelper.numberToEmoji((int)seconds) + " —Å–µ–∫.";
                }
            } else {
                formattedValue = EmojiHelper.numberToEmoji(value);
            }
            
            String result = selectedStat.emoji + " **" + player.getName().getString() + "** " + selectedStat.description + ": **" + formattedValue + "**";
            
            // Special case for deaths - add hardcore irony only for deaths
            if (selectedStat.description.contains("—É–º–µ—Ä")) {
                if (value == 0) {
                    result += "\n*–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?* üò±";
                } else if (selectedStat.isHardcore) {
                    // Add hardcore server irony only for deaths
                    String[] hardcoreComments = {
                        " *–ù–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ –∫–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —É—Ä–æ–∫!* üíÄ",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ —Å–º–µ—Ä—Ç—å - —ç—Ç–æ —á–∞—Å—Ç—å –∏–≥—Ä—ã!* ‚ö†Ô∏è",
                        " *–•–∞—Ä–¥–∫–æ—Ä –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!* üò±",
                        " *–ö–∞–∂–¥–∞—è —Å–º–µ—Ä—Ç—å –Ω–∞ —Ö–∞—Ä–¥–∫–æ—Ä–µ - —ç—Ç–æ –æ–ø—ã—Ç!* üìö",
                        " *–í —Ö–∞—Ä–¥–∫–æ—Ä–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ!* üé®"
                    };
                    result += hardcoreComments[(int)(Math.random() * hardcoreComments.length)];
                }
            }
            
            return result;
        } catch (Exception e) {
            return "";
        }
    }
    
    private static class StatInfo {
        net.minecraft.stat.Stat<?> stat;
        String description;
        String emoji;
        boolean isDistance;
        boolean isTime;
        boolean allowZero;
        boolean isHardcore; // For hardcore server irony
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji) {
            this(stat, description, emoji, false, false, false, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance) {
            this(stat, description, emoji, isDistance, false, true, false);
        }
        
        StatInfo(net.minecraft.stat.Stat<?> stat, String description, String emoji, boolean isDistance, boolean isTime, boolean allowZero, boolean isHardcore) {
            this.stat = stat;
            this.description = description;
            this.emoji = emoji;
            this.isDistance = isDistance;
            this.isTime = isTime;
            this.allowZero = allowZero;
            this.isHardcore = isHardcore;
        }
    }
    
    private String mapUrl = null;
    
    public EmbedBuilder addMapButton(String label, String url) {
        // Store URL for button
        this.mapUrl = url;
        return this;
    }
    
    public String getMapUrl() {
        return mapUrl;
    }
    
    public static EmbedBuilder createPlayerLeaveEmbed(ServerPlayerEntity player, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        String[] leaveMessages = {
            "–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "–£—à–µ–ª —Å —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å–∫–æ—Ä–µ–µ!",
            "–í—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã. –£–≤–∏–¥–∏–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!",
            "–û—Ç–∫–ª—é—á–∏–ª—Å—è. –î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
            "–ü–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä. –ë—É–¥–µ–º —Å–∫—É—á–∞—Ç—å!"
        };
        String messageText = leaveMessages[(int)(Math.random() * leaveMessages.length)];
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("<:quit:1445295564697894934> **" + playerName + verificationBadge + "**\n");
        description.append(messageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setTitle("<:quit:1445295564697894934> –ò–≥—Ä–æ–∫ –ø–æ–∫–∏–Ω—É–ª —Å–µ—Ä–≤–µ—Ä", null);
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        // Get color from player avatar
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : Color.decode("#FFA500")); // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∫–∞–∫ fallback
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –î–æ –≤—Å—Ç—Ä–µ—á–∏! <:quit:1445295564697894934>", null);
        return builder;
    }
    
    public static EmbedBuilder createPlayerDeathEmbed(ServerPlayerEntity player, Text deathMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        builder.embedBuilder.setTitle("üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä", null);
        
        String deathText = deathMessage.getString();
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ—Ä—Ç–∏
        DeathInfo deathInfo = formatDeathMessage(deathText, playerName);
        
        String[] deathComments = {
            "–û –Ω–µ—Ç! üò±",
            "–ù–µ –ø–æ–≤–µ–∑–ª–æ... üòî",
            "–≠—Ç–æ –±—ã–ª–æ –±–æ–ª—å–Ω–æ! üò¨",
            "–£–ø—Å! üòÖ",
            "–û–π-–æ–π! üò∞",
            "–ù–µ—É–¥–∞—á–∞! üò¢"
        };
        String comment = deathComments[(int)(Math.random() * deathComments.length)];
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        description.append("**" + playerName + verificationBadge + "**\n");
        description.append(deathInfo.message).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setDescription(description.toString());
        builder.setPlayerThumbnail(player);
        builder.embedBuilder.setColor(deathInfo.color);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑! üíÄ", null);
        return builder;
    }
    
    private static class DeathInfo {
        String message;
        Color color;
        
        DeathInfo(String message, Color color) {
            this.message = message;
            this.color = color;
        }
    }
    
    private static DeathInfo formatDeathMessage(String deathText, String playerName) {
        // –£–±–∏—Ä–∞–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Ç–∞–º –µ—Å—Ç—å
        String message = deathText.replace(playerName, "").trim().toLowerCase();
        
        // –ö—Ä–∞—Å–∏–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Å–º–µ—Ä—Ç–∏ —Å —ç–º–æ–¥–∑–∏ –∏ –∂–∏–≤—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        if (message.contains("—É—Ç–æ–Ω—É–ª") || message.contains("drowned")) {
            return new DeathInfo("—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß\n*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*", Color.decode("#00BFFF"));
        } else if (message.contains("—Å–≥–æ—Ä–µ–ª") || message.contains("burned") || message.contains("burned to death")) {
            return new DeathInfo("—Å–≥–æ—Ä–µ–ª –∑–∞–∂–∏–≤–æ! üî•\n*–û–≥–æ–Ω—å - —ç—Ç–æ –Ω–µ –∏–≥—Ä—É—à–∫–∞!*", Color.decode("#FF4500"));
        } else if (message.contains("—É–ø–∞–ª") || message.contains("fell") || message.contains("hit the ground")) {
            return new DeathInfo("—Ä–∞–∑–±–∏–ª—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏! üí•\n*–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è - –∂–µ—Å—Ç–æ–∫–∏–π —É—á–∏—Ç–µ–ª—å!*", Color.decode("#8B4513"));
        } else if (message.contains("–≤–∑–æ—Ä–≤–∞–ª—Å—è") || message.contains("blew up") || message.contains("exploded")) {
            return new DeathInfo("–≤–∑–æ—Ä–≤–∞–ª—Å—è! üí£\n*–í–∑—Ä—ã–≤—ã –æ–ø–∞—Å–Ω—ã, –∑–Ω–∞–µ—à—å –ª–∏!*", Color.decode("#FF0000"));
        } else if (message.contains("—É–±–∏—Ç") || message.contains("slain") || message.contains("was killed")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç! ‚öîÔ∏è\n*–ö—Ç–æ-—Ç–æ –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ...*", Color.decode("#8B0000"));
        } else if (message.contains("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É") || message.contains("fell into the void")) {
            return new DeathInfo("—É–ø–∞–ª –≤ –ø—É—Å—Ç–æ—Ç—É! üåå\n*–ü—É—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–æ–∫!*", Color.decode("#4B0082"));
        } else if (message.contains("–∑–∞–¥—É—à–µ–Ω") || message.contains("suffocated")) {
            return new DeathInfo("–∑–∞–¥–æ—Ö–Ω—É–ª—Å—è! üòµ\n*–ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥!*", Color.decode("#696969"));
        } else if (message.contains("—É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º") || message.contains("shot by skeleton")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —Å–∫–µ–ª–µ—Ç–æ–º! üèπ\n*–°—Ç—Ä–µ–ª—ã —Å–∫–µ–ª–µ—Ç–æ–≤ –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ!*", Color.decode("#C0C0C0"));
        } else if (message.contains("—É–±–∏—Ç –∑–æ–º–±–∏") || message.contains("zombie")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∑–æ–º–±–∏! üßü\n*–ó–æ–º–±–∏ —Ç–æ–∂–µ —Ö–æ—Ç—è—Ç –∫—É—à–∞—Ç—å!*", Color.decode("#556B2F"));
        } else if (message.contains("—É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º") || message.contains("creeper")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –∫—Ä–∏–ø–µ—Ä–æ–º! üí•\n*SSSS... BOOM!*", Color.decode("#228B22"));
        } else if (message.contains("—É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º") || message.contains("enderman")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç —ç–Ω–¥–µ—Ä–º–µ–Ω–æ–º! üëÅÔ∏è\n*–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–∏—Ö!*", Color.decode("#8B008B"));
        } else if (message.contains("—É–±–∏—Ç –∏–≥—Ä–æ–∫–æ–º") || message.contains("by player")) {
            return new DeathInfo("–±—ã–ª —É–±–∏—Ç –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º! ‚öîÔ∏è\n*PvP - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ!*", Color.decode("#DC143C"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞") || message.contains("starved")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞! üçñ\n*–ù–µ –∑–∞–±—ã–≤–∞–π –µ—Å—Ç—å!*", Color.decode("#FF8C00"));
        } else if (message.contains("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã") || message.contains("dehydrated")) {
            return new DeathInfo("—É–º–µ—Ä –æ—Ç –∂–∞–∂–¥—ã! üíß\n*–í–æ–¥–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è!*", Color.decode("#1E90FF"));
        } else {
            // –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            String original = deathText.replace(playerName, "").trim();
            return new DeathInfo(original.isEmpty() ? "—É–º–µ—Ä –ø—Ä–∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö! ü§î" : original, Color.decode("#FF0000"));
        }
    }
    
    public static EmbedBuilder createAdvancementEmbed(ServerPlayerEntity player, AdvancementEntry advancement, Text chatMessage, AngellaConfig config) {
        EmbedBuilder builder = create(config);
        String playerName = player.getName().getString();
        
        // Check if player is verified
        Long discordId = VerificationManager.getDiscordId(player.getUuid());
        String verificationBadge = "";
        if (discordId != null) {
            verificationBadge = " | <@" + discordId + "> | <:verification:1445465170255024384>";
        }
        
        // Get advancement info
        var displayOpt = advancement.value().display();
        if (displayOpt.isEmpty()) {
            return builder; // No display, skip
        }
        
        var display = displayOpt.get();
        String advancementName = display.getTitle().getString();
        String advancementDesc = display.getDescription().getString();
        
        // Get advancement frame type (rarity)
        net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
        Color advancementColor = getAdvancementColor(frame);
        String frameEmoji = getAdvancementEmoji(frame);
        
        // Use chat message if available, otherwise use our own message
        String messageText;
        if (chatMessage != null) {
            // If using chat message, add verification badge if player is verified
            String originalText = chatMessage.getString();
            if (discordId != null && !originalText.contains(verificationBadge)) {
                // Add badge after player name
                messageText = originalText.replaceFirst(playerName, playerName + verificationBadge);
            } else {
                messageText = originalText;
            }
        } else {
            messageText = playerName + verificationBadge + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [" + advancementName + "]";
        }
        
        String[] achievementComments = {
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!",
            "‚ú® –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
            "üéä –ü–æ—Ç—Ä—è—Å–∞—é—â–µ!",
            "üèÜ –í–ø–µ—á–∞—Ç–ª—è—é—â–µ!",
            "üí´ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!"
        };
        String comment = achievementComments[(int)(Math.random() * achievementComments.length)];
        
        builder.embedBuilder.setTitle(frameEmoji + " –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!", null);
        
        // Format message - ensure player name with badge is on separate line
        String formattedMessageText;
        if (discordId != null) {
            // Player is verified - format with line break
            if (messageText.contains(playerName + verificationBadge)) {
                // Split at the badge to put text on new line
                formattedMessageText = messageText.replaceFirst(".*?" + playerName + verificationBadge + "\\s*", "").trim();
            } else if (messageText.contains(playerName)) {
                // Player name without badge - add badge and split
                formattedMessageText = messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessageText = messageText;
            }
        } else {
            // Player not verified - just format normally
            if (messageText.contains(playerName)) {
                formattedMessageText = messageText.replaceFirst(playerName + "\\s*", "").trim();
            } else {
                formattedMessageText = messageText;
            }
        }
        
        StringBuilder description = new StringBuilder();
        description.append(EmojiHelper.getSeparatorLine()).append("\n");
        if (discordId != null) {
            description.append("**" + playerName + verificationBadge + "**\n");
        } else {
            description.append("**" + playerName + "**\n");
        }
        description.append(formattedMessageText).append("\n");
        description.append(EmojiHelper.getSeparatorLine());
        
        builder.embedBuilder.setDescription(description.toString());
        
        if (!advancementDesc.isEmpty()) {
            builder.embedBuilder.addField("üìù –û–ø–∏—Å–∞–Ω–∏–µ", advancementDesc, false);
        }
        
        builder.setPlayerThumbnail(player);
        // Get color from player avatar, but use advancement color as fallback
        Color avatarColor = getColorFromAvatar(player, config);
        builder.embedBuilder.setColor(avatarColor != null ? avatarColor : advancementColor);
        builder.embedBuilder.setFooter("Angella ‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! <:login:1445295617722024017>", null);
        return builder;
    }
    
    private static Color getAdvancementColor(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> Color.decode("#00FF00"); // –ó–µ–ª–µ–Ω—ã–π - –æ–±—ã—á–Ω–æ–µ
            case GOAL -> Color.decode("#00BFFF"); // –ì–æ–ª—É–±–æ–π - —Ü–µ–ª—å
            case CHALLENGE -> Color.decode("#FFD700"); // –ó–æ–ª–æ—Ç–æ–π - –≤—ã–∑–æ–≤
        };
    }
    
    private static String getAdvancementEmoji(net.minecraft.advancement.AdvancementFrame frame) {
        return switch (frame) {
            case TASK -> "‚úÖ"; // –û–±—ã—á–Ω–æ–µ
            case GOAL -> "üéØ"; // –¶–µ–ª—å
            case CHALLENGE -> "üèÜ"; // –í—ã–∑–æ–≤
        };
    }
    
    private void setPlayerThumbnail(ServerPlayerEntity player) {
        String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
        embedBuilder.setThumbnail(avatarUrl);
    }
    
    public EmbedBuilder setThumbnail(String url) {
        embedBuilder.setThumbnail(url);
        return this;
    }
    
    /**
     * Gets a color from player's avatar image
     * Returns a random color from the avatar or null if can't load
     */
    private static Color getColorFromAvatar(ServerPlayerEntity player, AngellaConfig config) {
        try {
            String avatarUrl = SkinRestorerIntegration.getPlayerAvatarUrl(player, config);
            if (avatarUrl == null || avatarUrl.isEmpty()) {
                return null;
            }
            
            // Try to load image and get a random color from it
            try (InputStream in = new URL(avatarUrl).openStream()) {
                BufferedImage image = ImageIO.read(in);
                if (image != null) {
                    // Get a random pixel color from the image
                    int width = image.getWidth();
                    int height = image.getHeight();
                    
                    // Sample multiple random pixels and average them
                    int totalR = 0, totalG = 0, totalB = 0;
                    int samples = Math.min(10, width * height); // Sample up to 10 pixels
                    
                    for (int i = 0; i < samples; i++) {
                        int x = (int)(Math.random() * width);
                        int y = (int)(Math.random() * height);
                        int rgb = image.getRGB(x, y);
                        totalR += (rgb >> 16) & 0xFF;
                        totalG += (rgb >> 8) & 0xFF;
                        totalB += rgb & 0xFF;
                    }
                    
                    int avgR = totalR / samples;
                    int avgG = totalG / samples;
                    int avgB = totalB / samples;
                    
                    // Make sure color is not too dark or too light
                    if (avgR + avgG + avgB < 100) {
                        // Too dark, brighten it
                        avgR = Math.min(255, avgR + 50);
                        avgG = Math.min(255, avgG + 50);
                        avgB = Math.min(255, avgB + 50);
                    }
                    
                    return new Color(avgR, avgG, avgB);
                }
            }
        } catch (Exception e) {
            AngellaMod.LOGGER.debug("Failed to get color from avatar for {}: {}", player.getName().getString(), e.getMessage());
        }
        return null;
    }
    
    public EmbedBuilder setTitle(String title) {
        embedBuilder.setTitle(title);
        return this;
    }
    
    public EmbedBuilder setDescription(String description) {
        embedBuilder.setDescription(description);
        return this;
    }
    
    public EmbedBuilder addField(String name, String value, boolean inline) {
        embedBuilder.addField(name, value, inline);
        return this;
    }
    
    public EmbedBuilder setColor(Color color) {
        embedBuilder.setColor(color);
        return this;
    }
    
    public MessageEmbed build() {
        return embedBuilder.build();
    }
    
    /**
     * Sends embed to game channel using DiscordBot with optional button
     */
    public CompletableFuture<Void> sendToGame() {
        DiscordBot bot = AngellaMod.getDiscordBot();
        if (bot != null && bot.isReady()) {
            MessageChannel channel = bot.getGameChannel();
            if (channel != null) {
                var messageAction = channel.sendMessageEmbeds(build());
                
                // Add button if map URL is set
                if (mapUrl != null && !mapUrl.isEmpty()) {
                    messageAction = messageAction.setActionRow(
                        net.dv8tion.jda.api.interactions.components.buttons.Button.link(mapUrl, "üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞")
                    );
                }
                
                return messageAction.submit()
                        .thenAccept(message -> {})
                        .exceptionally(throwable -> {
                            AngellaMod.LOGGER.error("Failed to send Discord message", throwable);
                            return null;
                        });
            }
        }
        return CompletableFuture.completedFuture(null);
    }
}

```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –í—Å–µ embed-—Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –∏–∑ 12 —ç–º–æ–¥–∑–∏ `blue_dash`.

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

1. –î–æ–±–∞–≤–ª–µ–Ω —ç–º–æ–¥–∑–∏-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å `blue_dash` (ID: `1445748743646347367`) –≤ `EmojiHelper`
2. –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ `getSeparatorLine()`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–∏–Ω–∏—é –∏–∑ 12 —ç–º–æ–¥–∑–∏
3. –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö embed-—Å–æ–æ–±—â–µ–Ω–∏–π:
   - –í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞ ‚Äî —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
   - –í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞ ‚Äî —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
   - –°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞ ‚Äî —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
   - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è ‚Äî —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏

–§–æ—Ä–º–∞—Ç —Ç–µ–ø–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–µ–º—É –ø—Ä–∏–º–µ—Ä—É:
```
:login: –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!

:blue_dash: x12

‚ú® ASSlover | @MyAngel üòá | :verification:
–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!

:blue_dash: x12

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚è±Ô∏è ASSlover –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: :04::02: —á. :04::09: –º–∏–Ω.
üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: :03::00::02:

:blue_dash: x12

üé≤ –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
ü¶Ä ASSlover –ø—Ä–æ–ø–æ–ª–∑: :01:,:05: –∫–º
```

–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª: `build\libs\angella-1.0.0.jar`

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

```plaintext
:login: –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!

:blue_dash: x12

‚ú® ASSlover | @MyAngel üòá | :verification:
–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!

:blue_dash: x12

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚è±Ô∏è ASSlover –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: :04::02: —á. :04::09: –º–∏–Ω.
üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: :03::00::02:

:blue_dash: x12

üé≤ –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
ü¶Ä ASSlover –ø—Ä–æ–ø–æ–ª–∑: :01:,:05: –∫–º
```

---

**User**

–£ –Ω–∞—Å –µ—Å—Ç—å C:\Users\MyAngel\Desktop\DiscordMinecraft\README.md

–°–¥–µ–ª–∞–π –æ–ø–∏—Å–∞–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –Ω–∞—à–∏—Ö —Ñ–∏—á –∏ —Ç–∞–º –ø–æ –≤–µ—Ä—Å–∏—è–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–∫—Å—ã –ø–∞—Ç—á–∏ –∏ —Ç–¥ —Ä–∞—Å–ø–∏—à–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–∞–∫ –±—É–¥—Ç–æ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –ø–∏—Å–∞–ª —Å –∫—Ä–∞—Å–∏–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º ; —á—Ç–æ–± —Ç–µ–∫—Å—Ç –∂–∏–≤—ã–º –∫–∞–∑–∞–ª—Å—è

---

**Cursor**

–ß–∏—Ç–∞—é —Ç–µ–∫—É—â–∏–π README –∏ –≥–æ—Ç–æ–≤–ª—é –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π:


–°–æ–∑–¥–∞—é README —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º:


```markdown
# üéÆ Angella - Discord Integration Mod

<div align="center">

**–ö—Ä–∞—Å–∏–≤—ã–π –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ Minecraft —Å–µ—Ä–≤–µ—Ä–∞ —Å Discord!**

[![Minecraft](https://img.shields.io/badge/Minecraft-1.21.8-00AA00?style=flat-square&logo=minecraft)](https://www.minecraft.net/)
[![Fabric](https://img.shields.io/badge/Fabric-Loader-4A90E2?style=flat-square)](https://fabricmc.net/)
[![Java](https://img.shields.io/badge/Java-21-ED8B00?style=flat-square&logo=java)](https://adoptium.net/)
[![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)](LICENSE)

*–°–≤—è–∂–∏—Ç–µ —Å–≤–æ–π Minecraft —Å–µ—Ä–≤–µ—Ä —Å Discord –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –∫—Ä–∞—Å–∏–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏—è—Ö!*

</div>

---

## ‚ú® –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**Angella** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –º–æ–¥ –¥–ª—è Minecraft Fabric, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –º–æ—Å—Ç –º–µ–∂–¥—É –≤–∞—à–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º –∏ Discord. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∏–ª–∏ —É–º–∏—Ä–∞–µ—Ç (–¥–∞, –¥–∞–∂–µ —ç—Ç–æ!), –≤ –≤–∞—à–µ–º Discord –∫–∞–Ω–∞–ª–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞—Å–∏–≤–æ–µ Embed —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∞–≤–∞—Ç–∞—Ä–æ–º –∏–≥—Ä–æ–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –¥–∞–∂–µ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Ñ–∞–∫—Ç–∞–º–∏!

–ú–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ Discord –±–æ—Ç–∞ (JDA), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7 –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö —Å–∫—É—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Å–∏–≤—ã–µ, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ Embed'—ã —Å —ç–º–æ–¥–∑–∏, —Ü–≤–µ—Ç–∞–º–∏ –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏!

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéØ –°–æ–±—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤
- **–í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** ‚Äî –∫—Ä–∞—Å–∏–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ/–≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–≥–æ—Å—è –∏–≥—Ä–æ–∫–∞
- **–í—ã—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞** ‚Äî –ø—Ä–æ—â–∞–Ω–∏–µ —Å –∏–≥—Ä–æ–∫–æ–º
- **–°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞** ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–º–µ—Ä—Ç–∏ —Å –ø—Ä–∏—á–∏–Ω–æ–π –∏ –∏—Ä–æ–Ω–∏—á–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞!)
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π —Å —Ü–≤–µ—Ç–∞–º–∏ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏

### üé® –ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ü–≤–µ—Ç–∞** ‚Äî —Ü–≤–µ—Ç Embed –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –∞–≤–∞—Ç–∞—Ä–∞ –∏–≥—Ä–æ–∫–∞
- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏** ‚Äî –≤—Å–µ —Ü–∏—Ñ—Ä—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –≤–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏
- **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏** ‚Äî –∫—Ä–∞—Å–∏–≤—ã–µ –ª–∏–Ω–∏–∏ –∏–∑ —ç–º–æ–¥–∑–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **–ê–≤–∞—Ç–∞—Ä—ã –∏–≥—Ä–æ–∫–æ–≤** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∫–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ SkinRestorer –∏–ª–∏ Mojang API

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
- **–í—Ä–µ–º—è –∏–≥—Ä—ã** ‚Äî —Å–∫–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫ –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–∞—Å—ã, –º–∏–Ω—É—Ç—ã, —Å–µ–∫—É–Ω–¥—ã)
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –æ –∏–≥—Ä–æ–∫–µ (—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—à–µ–ª, —Å–∫–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã–ª —Å—É–Ω–¥—É–∫–æ–≤, –∏ —Ç.–¥.)
- **–ò—Ä–æ–Ω–∏—è –¥–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å —Ä–µ–∂–∏–º–æ–º —Ö–∞—Ä–¥–∫–æ—Ä

### üîê –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–î–æ–±—Ä–æ–≤–æ–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –∏–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç —Å–≤—è–∑–∞—Ç—å —Å–≤–æ–π Discord –∞–∫–∫–∞—É–Ω—Ç —Å Minecraft
- **–ö–æ–º–∞–Ω–¥–∞ `/verif`** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** ‚Äî –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Embed —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –∏ —ç–º–æ–¥–∑–∏
- **–ö–æ–º–∞–Ω–¥–∞ `/verifdelete`** ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–≤—è–∑–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç

### ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º
- **–ö–æ–º–∞–Ω–¥–∞ `/rebootupdate`** ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Discord –∏ –∏–≥—Ä–µ
- **–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–µ—Ä–≤–µ—Ä–∞** ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ, –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã** ‚Äî –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç IP —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### üó∫Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **SkinRestorer** ‚Äî –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞** ‚Äî –∫–Ω–æ–ø–∫–∞ –≤ Embed –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
- **Mojang API** ‚Äî fallback –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∫–∏–Ω–æ–≤, –µ—Å–ª–∏ SkinRestorer –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Minecraft:** 1.21.8
- **Fabric Loader:** 0.18.0+
- **Fabric API:** 0.136.0+1.21.8
- **Java:** 21+ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- **Discord Bot Token:** –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Discord –±–æ—Ç–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Discord Developer Portal](https://discord.com/developers/applications)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Bot** –∏ —Å–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Bot Token** (–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø–æ–∑–∂–µ)
5. –í–∫–ª—é—á–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏:
   - ‚úÖ **Send Messages**
   - ‚úÖ **Embed Links**
   - ‚úÖ **Read Message History**
   - ‚úÖ **Use External Emojis**
   - ‚úÖ **Read Messages/View Channels**
6. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –±–æ—Ç–∞ –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –Ω—É–∂–Ω—ã–µ –∫–∞–Ω–∞–ª—ã

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥–∞

1. –°–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é `angella-1.0.0.jar`
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `mods` –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã Fabric Loader –∏ Fabric API
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ `config/angella.json`
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à **Bot Token** –≤ –ø–æ–ª–µ `botToken`
3. –£–∫–∞–∂–∏—Ç–µ ID –∫–∞–Ω–∞–ª–æ–≤:
   - `technicalChannelId` ‚Äî –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–∑–∞–ø—É—Å–∫, –æ—à–∏–±–∫–∏)
   - `gameChannelId` ‚Äî –¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π (–≤—Ö–æ–¥, –≤—ã—Ö–æ–¥, —Å–º–µ—Ä—Ç—å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å ID –∫–∞–Ω–∞–ª–∞:**
1. –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ Discord (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Üí –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)
2. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –ø–æ –∫–∞–Ω–∞–ª—É ‚Üí –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `config/angella.json`:

```json
{
  "botToken": "YOUR_BOT_TOKEN_HERE",
  "technicalChannelId": 1256170139318091807,
  "gameChannelId": 1444857215172345886,
  "enabled": true,
  "sendPlayerJoin": true,
  "sendPlayerLeave": true,
  "sendPlayerDeath": true,
  "sendAdvancements": true,
  "sendServerStart": true,
  "sendServerStop": true,
  "useSkinRestorer": true,
  "skinRestorerSkinsFolder": "config/skinrestorer/skins/",
  "serverMapUrl": "http://213.171.18.211:30031/",
  "verificationEmojiId": "1445465170255024384",
  "verificationDataPath": "config/angella_verification.json"
}
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `botToken` | –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Discord –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!) |
| `technicalChannelId` | ID –∫–∞–Ω–∞–ª–∞ –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π |
| `gameChannelId` | ID –∫–∞–Ω–∞–ª–∞ –¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π |
| `enabled` | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–æ–¥ |
| `useSkinRestorer` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SkinRestorer –¥–ª—è —Å–∫–∏–Ω–æ–≤ |
| `serverMapUrl` | URL –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞ |
| `verificationEmojiId` | ID —ç–º–æ–¥–∑–∏ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ |

---

## üéÆ –ö–æ–º–∞–Ω–¥—ã

### –î–ª—è –∏–≥—Ä–æ–∫–æ–≤

#### `/verif`
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ Discord –∞–∫–∫–∞—É–Ω—Ç–∞. –ö–æ–¥ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –≤ Discord –∫–∞–Ω–∞–ª–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–º –≤ –∫–æ–Ω—Ñ–∏–≥–µ.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/verif
```

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã –ø–æ–ª—É—á–∏–ª–∏ –∫–æ–¥: 123456
–í–≤–µ–¥–∏—Ç–µ –µ–≥–æ –≤ Discord –∫–∞–Ω–∞–ª–µ #–∏–≥—Ä–æ–≤—ã–µ-—Å–æ–±—ã—Ç–∏—è
```

#### `/verifdelete`
–û—Ç–≤—è–∑—ã–≤–∞–µ—Ç –≤–∞—à Discord –∞–∫–∫–∞—É–Ω—Ç –æ—Ç Minecraft –∞–∫–∫–∞—É–Ω—Ç–∞.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/verifdelete
```

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (OP —É—Ä–æ–≤–µ–Ω—å 4)

#### `/rebootupdate [–ø—Ä–∏—á–∏–Ω–∞]`
–ü–ª–∞–Ω–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Discord –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á–µ—Ç –≤ –∏–≥—Ä–µ.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/rebootupdate
/rebootupdate –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–æ–≤
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Embed –≤ Discord —Å –ø—Ä–∏—á–∏–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- –í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤–∏–¥—è—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
- –í —á–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞ (4 –º–∏–Ω, 3 –º–∏–Ω, 2 –º–∏–Ω, 1 –º–∏–Ω, 30 —Å–µ–∫, 15 —Å–µ–∫, 10 —Å–µ–∫, 5 —Å–µ–∫, 4 —Å–µ–∫, 3 —Å–µ–∫, 2 —Å–µ–∫, 1 —Å–µ–∫)
- –°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç

---

## üé® –ü—Ä–∏–º–µ—Ä—ã Embed —Å–æ–æ–±—â–µ–Ω–∏–π

### –í—Ö–æ–¥ –∏–≥—Ä–æ–∫–∞
```
:login: –ò–≥—Ä–æ–∫ –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!

:blue_dash: x12

‚ú® ASSlover | @MyAngel üòá | :verification:
–°–Ω–æ–≤–∞ —Å –Ω–∞–º–∏! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!

:blue_dash: x12

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚è±Ô∏è ASSlover –ø—Ä–æ–≤–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: :04::02: —á. :04::09: –º–∏–Ω.
üèÜ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π: :03::00::02:

:blue_dash: x12

üé≤ –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
ü¶Ä ASSlover –ø—Ä–æ–ø–æ–ª–∑: :01:,:05: –∫–º
```

### –°–º–µ—Ä—Ç—å –∏–≥—Ä–æ–∫–∞
```
üíÄ –ò–≥—Ä–æ–∫ —É–º–µ—Ä

:blue_dash: x12

ASSlover | @MyAngel üòá | :verification:
—É—Ç–æ–Ω—É–ª –≤ –≤–æ–¥–µ! üíß
*–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –Ω–µ –∑–∞–±—ã–≤–∞–π –¥—ã—à–∞—Ç—å –ø–æ–¥ –≤–æ–¥–æ–π!*

:blue_dash: x12
```

### –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
```
üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!

:blue_dash: x12

ASSlover | @MyAngel üòá | :verification:
–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ [–û—Ç–∫—Ä—ã—Ç–∏–µ]

:blue_dash: x12
```

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

### üéâ –í–µ—Ä—Å–∏—è 1.0.0 (–¢–µ–∫—É—â–∞—è) - "The Grand Release"

**–î–∞—Ç–∞:** –î–µ–∫–∞–±—Ä—å 2024

#### ‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üéÆ **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Discord —á–µ—Ä–µ–∑ JDA –±–æ—Ç–∞**
  - –†–µ–∞–ª—å–Ω—ã–π Discord –±–æ—Ç –≤–º–µ—Å—Ç–æ webhooks
  - –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å IP —Å–µ—Ä–≤–µ—Ä–∞
  - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

- üé® **–ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ Embed —Å–æ–æ–±—â–µ–Ω–∏–π**
  - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ü–≤–µ—Ç–∞ –∏–∑ –∞–≤–∞—Ç–∞—Ä–∞ –∏–≥—Ä–æ–∫–∞
  - –ö–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–ª—è —Ü–∏—Ñ—Ä (0-9)
  - –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –∏–∑ —ç–º–æ–¥–∑–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
  - –ê–≤–∞—Ç–∞—Ä—ã –∏–≥—Ä–æ–∫–æ–≤ –≤ thumbnail

- üìä **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤**
  - –í—Ä–µ–º—è –∏–≥—Ä—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–∞—Å—ã, –º–∏–Ω—É—Ç—ã, —Å–µ–∫—É–Ω–¥—ã)
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
  - –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ø—Ä–æ–π–¥–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å—É–Ω–¥—É–∫–∏, –∏ —Ç.–¥.)
  - –ò—Ä–æ–Ω–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —Ö–∞—Ä–¥–∫–æ—Ä–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Å–º–µ—Ä—Ç–µ–π!)

- üîê **–°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ Discord**
  - –ö–æ–º–∞–Ω–¥–∞ `/verif` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞
  - –ö–æ–º–∞–Ω–¥–∞ `/verifdelete` –¥–ª—è –æ—Ç–≤—è–∑–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Embed
  - –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ Discord –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

- ‚öôÔ∏è **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º**
  - –ö–æ–º–∞–Ω–¥–∞ `/rebootupdate` –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∂–∏–∑–Ω–µ–Ω–Ω–æ–º —Ü–∏–∫–ª–µ —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
  - –û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á–µ—Ç –≤ –∏–≥—Ä–µ –∏ Discord

- üñºÔ∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SkinRestorer**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∫–∏–Ω–æ–≤ –∏–∑ SkinRestorer
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ `/skin`
  - Fallback –Ω–∞ Mojang API
  - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- üó∫Ô∏è **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞**
  - –ö–Ω–æ–ø–∫–∞ –≤ Embed –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞—Ä—Ç–µ
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π URL –∫–∞—Ä—Ç—ã

#### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å–∫–∏–Ω–æ–≤ –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ Mojang –∞–∫–∫–∞—É–Ω—Ç–∞
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —ç–º–æ–¥–∑–∏ —Ü–∏—Ñ—Ä –≤ –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö —á–∏—Å–ª–∞—Ö
- –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–æ–≤

#### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω –¥–æ Java 21
- –û–±–Ω–æ–≤–ª–µ–Ω –¥–æ Minecraft 1.21.8
- –û–±–Ω–æ–≤–ª–µ–Ω –¥–æ Fabric API 0.136.0+1.21.8
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å Discord API
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

#### üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω `botToken` –¥–ª—è Discord –±–æ—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã `technicalChannelId` –∏ `gameChannelId` –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω `serverMapUrl` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω `verificationEmojiId` –¥–ª—è —ç–º–æ–¥–∑–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω `verificationDataPath` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω `skinRestorerSkinsFolder` –¥–ª—è –ø—É—Ç–∏ –∫ —Å–∫–∏–Ω–∞–º SkinRestorer

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Java 21 JDK
- Gradle 8.10.2+

**–°–±–æ—Ä–∫–∞:**
```bash
# Windows
gradlew.bat build

# Linux/Mac
./gradlew build
```

–ì–æ—Ç–æ–≤—ã–π –º–æ–¥ –±—É–¥–µ—Ç –≤ `build/libs/angella-1.0.0.jar`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
DiscordMinecraft/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ java/com/angella/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AngellaMod.java          # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –º–æ–¥–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AngellaConfig.java    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ discord/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DiscordBot.java       # Discord –±–æ—Ç
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EmbedBuilder.java     # –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å Embed
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EmojiHelper.java      # –ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —ç–º–æ–¥–∑–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RebootEmbedBuilder.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SkinRestorerIntegration.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PlayerEventHandler.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RebootUpdateCommand.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VerifCommand.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ VerifDeleteCommand.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mixins/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ServerPlayerEntityMixin.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ServerAdvancementTrackerMixin.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ServerPlayerEntityChatMixin.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ verification/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ VerificationManager.java
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ VerificationMessageListener.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ fabric.mod.json
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ angella.mixins.json
‚îú‚îÄ‚îÄ build.gradle
‚îú‚îÄ‚îÄ gradle.properties
‚îî‚îÄ‚îÄ README.md
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **Fabric Loader** 0.18.0
- **Fabric API** 0.136.0+1.21.8
- **JDA** 5.1.1 (Discord API)
- **Gson** 2.10.1 (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- **OkHttp** 4.12.0 (HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è JDA)
- **Jackson** 2.17.1 (JSON –æ–±—Ä–∞–±–æ—Ç–∫–∞)

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Discord.

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –≤ `config/angella.json`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ –≤–∞—à Discord —Å–µ—Ä–≤–µ—Ä
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ (–¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª–∞–º)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ–±—ã—Ç–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç, –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ Discord.

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID –∫–∞–Ω–∞–ª–æ–≤ –≤ –∫–æ–Ω—Ñ–∏–≥–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —ç—Ç–∏ –∫–∞–Ω–∞–ª—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `enabled: true` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–ª–∞–≥–∏ (`sendPlayerJoin`, `sendPlayerDeath`, –∏ —Ç.–¥.)

### –°–∫–∏–Ω—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –í Embed –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–∫–∏–Ω –∏–ª–∏ –æ—à–∏–±–∫–∞.

**–†–µ—à–µ–Ω–∏—è:**
1. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ SkinRestorer, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å `skinRestorerSkinsFolder` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –º–æ–¥–∞ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º SkinRestorer
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–¥–ª—è fallback –Ω–∞ Mojang API)

### –≠–º–æ–¥–∑–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –í–º–µ—Å—Ç–æ —ç–º–æ–¥–∑–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç —Ç–∏–ø–∞ `:login:`.

**–†–µ—à–µ–Ω–∏—è:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ **Use External Emojis**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —ç–º–æ–¥–∑–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –Ω–∞ –≤–∞—à–µ–º Discord —Å–µ—Ä–≤–µ—Ä–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID —ç–º–æ–¥–∑–∏ –≤ –∫–æ–¥–µ (–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—à–∏–º —ç–º–æ–¥–∑–∏)

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∏–ª–∏ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è.

**–†–µ—à–µ–Ω–∏—è:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `gameChannelId` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ —á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ —É–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–¥–∞)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è?

1. –ò–≥—Ä–æ–∫ –≤–≤–æ–¥–∏—Ç `/verif` –≤ –∏–≥—Ä–µ
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
3. –ò–≥—Ä–æ–∫ –≤–≤–æ–¥–∏—Ç –∫–æ–¥ –≤ Discord –∫–∞–Ω–∞–ª–µ (—É–∫–∞–∑–∞–Ω–Ω–æ–º –≤ `gameChannelId`)
4. –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥ –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç Discord ID —Å UUID –∏–≥—Ä–æ–∫–∞
5. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ Embed –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ Discord –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —ç–º–æ–¥–∑–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∫–∏–Ω–æ–≤?

1. –ú–æ–¥ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–∫–∏–Ω –∏–∑ `GameProfile` –∏–≥—Ä–æ–∫–∞ (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è SkinRestorer)
2. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ SkinRestorer API –∏–ª–∏ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
3. –ï—Å–ª–∏ –∏ —ç—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Mojang API —Å UUID –∏–≥—Ä–æ–∫–∞
4. –í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç mc-heads.net —Å UUID

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–ú–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö:
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Discord
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞** ‚Äî —Ç–∞–º —á–∞—Å—Ç–æ –µ—Å—Ç—å –ø–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞** ‚Äî –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏–∏** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ Minecraft, Fabric –∏ Java

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –í—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å —ç—Ç–æ—Ç –º–æ–¥.

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

**Angella Team**

*–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ Minecraft*

---

## üéØ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤
- [ ] –í–µ–±-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–∞–º–∏
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã –æ —Ä–∞–±–æ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Discord Slash Commands

---

<div align="center">

**–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Angella! üéâ**

*–ï—Å–ª–∏ –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è –º–æ–¥, –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∑–≤–µ–∑–¥—É! ‚≠ê*

</div>

```

–°–æ–∑–¥–∞–Ω README —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

## –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:

1. **–û–ø–∏—Å–∞–Ω–∏–µ** ‚Äî —á—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥ –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω
2. **–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏** ‚Äî —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π —Å —ç–º–æ–¥–∑–∏
3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞** ‚Äî –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
5. **–ö–æ–º–∞–Ω–¥—ã** ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
6. **–ü—Ä–∏–º–µ—Ä—ã Embed** ‚Äî –∫–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
7. **–ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π** ‚Äî changelog –≤–µ—Ä—Å–∏–∏ 1.0.0 —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏:
   - –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
8. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–±–æ—Ä–∫–∞
9. **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º** ‚Äî —á–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
10. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** ‚Äî –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–∏—Å—Ç–µ–º—ã
11. **–ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ** ‚Äî roadmap

–¢–µ–∫—Å—Ç –Ω–∞–ø–∏—Å–∞–Ω –∂–∏–≤—ã–º —è–∑—ã–∫–æ–º, —Å —ç–Ω—Ç—É–∑–∏–∞–∑–º–æ–º –∏ –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ –¥–µ—Ç–∞–ª—è–º. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç —ç–º–æ–¥–∑–∏, —Ç–∞–±–ª–∏—Ü—ã, –±–ª–æ–∫–∏ –∫–æ–¥–∞ –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏.

–§–∞–π–ª –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

**User**

–°–ª—É—à–∞–π - –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤—Å–µ —Ç–∞–∫ –∂–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –¥–∏—Å–∫–æ—Ä–¥–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏

–ú–æ–∂–µ—Ç –¥–µ–ª–æ –≤ —Ç–æ–º —á—Ç–æ —É –Ω–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω : https://github.com/Bivrik/FancyToasts  ?

–ò–∑—É—á–∏ –∏ –µ—Å–ª–∏ —Ç–∞–º –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã - –∞–¥–∞–ø—Ç–∏—Ä—É–π –ø–æ–¥ –Ω–µ–≥–æ. 

–í–æ–æ–±—â–µ–º –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –¥–∏—Å–∫–æ—Ä–¥ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∏—á–µ–≥–æ , –∞ –¥–æ–ª–∂–Ω–æ! –ò –¥–æ–ª–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ø–æ —Ä–∞–∑–Ω–æ–º—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–¥–∫–æ—Å—Ç–∏ –∞—á–∏–≤–∫–∏

---

**Cursor**

–ü—Ä–æ–≤–µ—Ä—è—é —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –∞–¥–∞–ø—Ç–∏—Ä—É—é –ø–æ–¥ FancyToasts:


FancyToasts –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö –≤ —á–∞—Ç. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –ø—Ä—è–º–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ `ServerAdvancementTrackerMixin` –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç. –û–±–Ω–æ–≤–ª—è—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.advancement.AdvancementProgress;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Shadow
    public abstract AdvancementProgress getProgress(AdvancementEntry advancement);
    
    // Track recently completed advancements to avoid duplicates
    private static final Set<String> recentlyCompleted = ConcurrentHashMap.newKeySet();
    
    @Inject(method = "grantCriterion", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only process if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            try {
                // Check if advancement is actually completed (all criteria met)
                AdvancementProgress progress = getProgress(advancement);
                
                if (progress.isDone()) {
                    // Create unique key for this advancement completion
                    String completionKey = owner.getUuid().toString() + ":" + advancement.id().toString();
                    
                    // Check if we already processed this advancement (avoid duplicates)
                    if (!recentlyCompleted.contains(completionKey)) {
                        recentlyCompleted.add(completionKey);
                        
                        // Remove from set after 5 seconds to allow re-processing if needed
                        java.util.concurrent.CompletableFuture.runAsync(() -> {
                            try {
                                Thread.sleep(5000);
                                recentlyCompleted.remove(completionKey);
                            } catch (InterruptedException e) {
                                Thread.currentThread().interrupt();
                            }
                        });
                        
                        // Send to Discord
                        if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                            if (AngellaMod.getConfig().sendAdvancements) {
                                AngellaMod.LOGGER.info("Advancement completed: {} by player {}", advancement.id(), owner.getName().getString());
                                
                                // Create chat message text for the advancement
                                var display = advancement.value().display().get();
                                String advancementName = display.getTitle().getString();
                                String playerName = owner.getName().getString();
                                
                                // Create a text message similar to what Minecraft would send
                                Text chatMessage = Text.translatable("chat.type.advancement." + display.getFrame().name().toLowerCase(), 
                                    owner.getDisplayName(), 
                                    advancement.value().display().get().getTitle());
                                
                                // Send to Discord asynchronously
                                java.util.concurrent.CompletableFuture.runAsync(() -> {
                                    try {
                                        EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                                                .sendToGame();
                                        AngellaMod.LOGGER.info("Successfully sent advancement to Discord: {}", advancement.id());
                                    } catch (Exception e) {
                                        AngellaMod.LOGGER.error("Failed to send advancement to Discord: {}", advancement.id(), e);
                                    }
                                });
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.error("Failed to process advancement completion for {}: {}", advancement.id(), e.getMessage(), e);
            }
        }
    }
}


```

```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(ServerPlayerEntity.class)
public class ServerPlayerEntityChatMixin {
    
    @Inject(method = "sendMessage(Lnet/minecraft/text/Text;Z)V", at = @At("HEAD"))
    private void onSendMessage(Text message, boolean overlay, CallbackInfo ci) {
        // This mixin is kept as a fallback, but primary advancement tracking
        // is now done in ServerAdvancementTrackerMixin to work with FancyToasts
        // We still check chat messages as a backup, but it's less reliable with FancyToasts
        
        // Check if message is about advancement (fallback method)
        String messageText = message.getString().toLowerCase();
        boolean isAdvancementMessage = messageText.contains("–ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || 
                                       messageText.contains("has made the advancement") || 
                                       messageText.contains("completed the challenge") || 
                                       messageText.contains("–∑–∞–≤–µ—Ä—à–∏–ª –≤—ã–∑–æ–≤") ||
                                       messageText.contains("advancement") ||
                                       messageText.contains("–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ");
        
        if (isAdvancementMessage) {
            ServerPlayerEntity player = (ServerPlayerEntity) (Object) this;
            
            // Only use this as fallback - primary tracking is in ServerAdvancementTrackerMixin
            AngellaMod.LOGGER.debug("Fallback: Detected advancement message in chat: {}", messageText);
            
            // The main tracking happens in ServerAdvancementTrackerMixin now
            // This is just a backup in case chat messages still work
        }
    }
}


```

–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É –∫–æ–º–ø–∏–ª—è—Ü–∏–∏: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞—â–∞—é—Å—å –∫ –º–µ—Ç–æ–¥—É —á–µ—Ä–µ–∑ mixin:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.advancement.AdvancementProgress;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public abstract class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Shadow
    public abstract AdvancementProgress getProgress(AdvancementEntry advancement);
    
    // Track recently completed advancements to avoid duplicates
    private static final Set<String> recentlyCompleted = ConcurrentHashMap.newKeySet();
    
    @Inject(method = "grantCriterion(Lnet/minecraft/advancement/AdvancementEntry;Ljava/lang/String;)V", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only process if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            try {
                // Check if advancement is actually completed (all criteria met)
                AdvancementProgress progress = getProgress(advancement);
                
                if (progress.isDone()) {
                    // Create unique key for this advancement completion
                    String completionKey = owner.getUuid().toString() + ":" + advancement.id().toString();
                    
                    // Check if we already processed this advancement (avoid duplicates)
                    if (!recentlyCompleted.contains(completionKey)) {
                        recentlyCompleted.add(completionKey);
                        
                        // Remove from set after 5 seconds to allow re-processing if needed
                        java.util.concurrent.CompletableFuture.runAsync(() -> {
                            try {
                                Thread.sleep(5000);
                                recentlyCompleted.remove(completionKey);
                            } catch (InterruptedException e) {
                                Thread.currentThread().interrupt();
                            }
                        });
                        
                        // Send to Discord
                        if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                            if (AngellaMod.getConfig().sendAdvancements) {
                                AngellaMod.LOGGER.info("Advancement completed: {} by player {}", advancement.id(), owner.getName().getString());
                                
                                // Create chat message text for the advancement
                                var display = advancement.value().display().get();
                                String advancementName = display.getTitle().getString();
                                String playerName = owner.getName().getString();
                                
                                // Create a text message similar to what Minecraft would send
                                Text chatMessage = Text.translatable("chat.type.advancement." + display.getFrame().name().toLowerCase(), 
                                    owner.getDisplayName(), 
                                    advancement.value().display().get().getTitle());
                                
                                // Send to Discord asynchronously
                                java.util.concurrent.CompletableFuture.runAsync(() -> {
                                    try {
                                        EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                                                .sendToGame();
                                        AngellaMod.LOGGER.info("Successfully sent advancement to Discord: {}", advancement.id());
                                    } catch (Exception e) {
                                        AngellaMod.LOGGER.error("Failed to send advancement to Discord: {}", advancement.id(), e);
                                    }
                                });
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.error("Failed to process advancement completion for {}: {}", advancement.id(), e.getMessage(), e);
            }
        }
    }
}


```

–ü—Ä–æ–≤–µ—Ä—è—é —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é –µ–≥–æ:


```java
package com.angella.mixins;

import com.angella.AngellaMod;
import com.angella.discord.EmbedBuilder;
import net.minecraft.advancement.AdvancementEntry;
import net.minecraft.advancement.AdvancementProgress;
import net.minecraft.server.network.ServerPlayerEntity;
import net.minecraft.text.Text;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;

@Mixin(targets = "net.minecraft.server.network.ServerAdvancementTracker")
public abstract class ServerAdvancementTrackerMixin {
    
    @Shadow @Final private ServerPlayerEntity owner;
    
    @Shadow
    public abstract AdvancementProgress getProgress(AdvancementEntry advancement);
    
    // Track recently completed advancements to avoid duplicates
    private static final Set<String> recentlyCompleted = ConcurrentHashMap.newKeySet();
    
    @Inject(method = "grantCriterion(Lnet/minecraft/advancement/AdvancementEntry;Ljava/lang/String;)V", at = @At("TAIL"))
    private void onAdvancementGranted(AdvancementEntry advancement, String criterionName, CallbackInfo ci) {
        // Only process if advancement has a display (visible advancements)
        if (advancement.value().display().isPresent()) {
            try {
                // Check if advancement is actually completed (all criteria met)
                AdvancementProgress progress = getProgress(advancement);
                
                if (progress.isDone()) {
                    // Create unique key for this advancement completion
                    String completionKey = owner.getUuid().toString() + ":" + advancement.id().toString();
                    
                    // Check if we already processed this advancement (avoid duplicates)
                    if (!recentlyCompleted.contains(completionKey)) {
                        recentlyCompleted.add(completionKey);
                        
                        // Remove from set after 5 seconds to allow re-processing if needed
                        java.util.concurrent.CompletableFuture.runAsync(() -> {
                            try {
                                Thread.sleep(5000);
                                recentlyCompleted.remove(completionKey);
                            } catch (InterruptedException e) {
                                Thread.currentThread().interrupt();
                            }
                        });
                        
                        // Send to Discord
                        if (AngellaMod.getDiscordBot() != null && AngellaMod.getDiscordBot().isReady()) {
                            if (AngellaMod.getConfig().sendAdvancements) {
                                AngellaMod.LOGGER.info("Advancement completed: {} by player {}", advancement.id(), owner.getName().getString());
                                
                                // Create chat message text for the advancement
                                var display = advancement.value().display().get();
                                String advancementName = display.getTitle().getString();
                                String playerName = owner.getName().getString();
                                
                                // Create a text message similar to what Minecraft would send
                                // Use the proper translation key based on frame type
                                String translationKey;
                                net.minecraft.advancement.AdvancementFrame frame = display.getFrame();
                                switch (frame) {
                                    case TASK:
                                        translationKey = "chat.type.advancement.task";
                                        break;
                                    case GOAL:
                                        translationKey = "chat.type.advancement.goal";
                                        break;
                                    case CHALLENGE:
                                        translationKey = "chat.type.advancement.challenge";
                                        break;
                                    default:
                                        translationKey = "chat.type.advancement.task";
                                }
                                
                                Text chatMessage = Text.translatable(translationKey, 
                                    owner.getDisplayName(), 
                                    display.getTitle());
                                
                                // Send to Discord asynchronously
                                java.util.concurrent.CompletableFuture.runAsync(() -> {
                                    try {
                                        EmbedBuilder.createAdvancementEmbed(owner, advancement, chatMessage, AngellaMod.getConfig())
                                                .sendToGame();
                                        AngellaMod.LOGGER.info("Successfully sent advancement to Discord: {}", advancement.id());
                                    } catch (Exception e) {
                                        AngellaMod.LOGGER.error("Failed to send advancement to Discord: {}", advancement.id(), e);
                                    }
                                });
                            }
                        }
                    }
                }
            } catch (Exception e) {
                AngellaMod.LOGGER.error("Failed to process advancement completion for {}: {}", advancement.id(), e.getMessage(), e);
            }
        }
    }
}


```

–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å FancyToasts.

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. –ü—Ä—è–º–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `ServerAdvancementTrackerMixin`:
   - –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–µ–∫–µ—Ä–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π, –∞ –Ω–µ —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
   - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ FancyToasts –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

2. –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Set –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥

3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
   - TASK (–æ–±—ã—á–Ω–æ–µ) ‚Äî –∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç
   - GOAL (—Ü–µ–ª—å) ‚Äî –≥–æ–ª—É–±–æ–π —Ü–≤–µ—Ç
   - CHALLENGE (–≤—ã–∑–æ–≤) ‚Äî –∑–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç

4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - –í–∏–¥–Ω–æ, –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `grantCriterion` –≤ `ServerAdvancementTracker`
2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω–æ –ª–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ (`progress.isDone()`)
3. –ï—Å–ª–∏ –¥–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Discord —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ü–≤–µ—Ç–æ–º –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
4. FancyToasts –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —ç—Ç–æ, —Ç–∞–∫ –∫–∞–∫ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–µ–∫–µ—Ä–∞

–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª: `build\libs\angella-1.0.0.jar`

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–æ–¥ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ: –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –≤ Discord —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏, –¥–∞–∂–µ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º FancyToasts.

---

**User**

–°–ª—É—à–∞–π –≤–æ–ø—Ä–æ—Å - –ø—Ä–æ—Å—Ç–æ –æ—Ç–≤–µ—Ç—å –Ω–∞ –Ω–µ–≥–æ , –Ω–µ —Ä–µ–∞–ª–∏–∑—É–π –ø–æ–∫–∞

–í–æ—Ç —É –Ω–∞—Å –≤ Embed –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≥–æ–ª–æ–≤–∞ —Å–∫–∏–Ω–∞ 

–ê –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∏–≥—Ä–æ–∫ —Å–ø–∞–≤–Ω–∏—Ç—Å—è - –¥–µ–ª–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä —Ç–æ–≥–æ —á—Ç–æ –Ω–∞ –Ω–µ–º –æ–¥–µ—Ç–æ - –±—Ä–æ–Ω—è —Ç–∞–º —á—Ç–æ –≤ —Ä—É–∫–∞—Ö –∏ —ç—Ç–æ —Ç–æ–∂–µ –±—É–¥–µ—Ç –ø—Ä–∏–ª–∞–≥–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–µ —Å –≥–æ–ª–æ–≤–æ–π? –¢–∏–ø–æ —Ç–∞–∫

---

**Cursor**

–î–∞, —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ:

1. –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ 3D –º–æ–¥–µ–ª–∏ –∏–≥—Ä–æ–∫–∞:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Minecraft –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
   - –£—á–µ—Å—Ç—å –±—Ä–æ–Ω—é, –ø—Ä–µ–¥–º–µ—Ç—ã –≤ —Ä—É–∫–∞—Ö, –ø–æ–∑—É

2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–Ω–¥–µ—Ä –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª (PNG/JPG)
   - –†–∞–∑–º–µ—Ä—ã: –Ω–∞–ø—Ä–∏–º–µ—Ä, 128x128 –∏–ª–∏ 256x256

3. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Discord:
   - –í–∞—Ä–∏–∞–Ω—Ç 1: –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –∫–∞–∫ attachment –∫ —Å–æ–æ–±—â–µ–Ω–∏—é (–Ω–µ –≤ Embed, –æ—Ç–¥–µ–ª—å–Ω–æ–µ –≤–ª–æ–∂–µ–Ω–∏–µ)
   - –í–∞—Ä–∏–∞–Ω—Ç 2: –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Ö–æ—Å—Ç–∏–Ω–≥ (imgur, discord CDN) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å URL –≤ Embed
   - –í–∞—Ä–∏–∞–Ω—Ç 3: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Discord CDN —á–µ—Ä–µ–∑ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ –±–æ—Ç–∞

## –°–ª–æ–∂–Ω–æ—Å—Ç–∏:

1. –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   - –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å)
   - –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è headless rendering –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å

2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
   - –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è
   - –ù—É–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑

3. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏:
   - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –±—Ä–æ–Ω—é, –ø—Ä–µ–¥–º–µ—Ç—ã –≤ —Ä—É–∫–∞—Ö, –ø–æ–∑—É –∏–≥—Ä–æ–∫–∞

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API:
   - mc-heads.net –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–Ω–¥–µ—Ä—ã —Å –±—Ä–æ–Ω–µ–π —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `https://mc-heads.net/body/{uuid}`

2. –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Ä–µ–Ω–¥–µ—Ä-—Å–µ—Ä–≤–∏—Å:
   - –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å/–º–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Ö –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥

3. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
   - –ì–æ–ª–æ–≤–∞ –≤ thumbnail (–∫–∞–∫ —Å–µ–π—á–∞—Å)
   - –ü–æ–ª–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Embed (—á–µ—Ä–µ–∑ `setImage()`)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API mc-heads.net —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–ª—è –±—Ä–æ–Ω–∏, –µ—Å–ª–∏ –æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥.

–ú–æ–≥—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.

---

**User**

index.html:79 Unrecognized feature: 'webgl2'.
index.html:79 Allow attribute will take precedence over 'allowfullscreen'.
renderer.js:27 –ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
node:electron/js2c/renderer_init:2 Electron Security Warning (Disabled webSecurity) This renderer process has "webSecurity" disabled. This
  exposes users of this app to severe security risks.

For more information and help, consult
https://electronjs.org/docs/tutorial/security.
This warning will not show up
once the app is packaged.
(anonymous) @ node:electron/js2c/renderer_init:2
node:electron/js2c/renderer_init:2 Electron Security Warning (Insecure Resources) This renderer process loads resources using insecure
  protocols. This exposes users of this app to unnecessary security risks.
  Consider loading the following resources over HTTPS or FTPS. 
- http://213.171.18.211:30031/
  

For more information and help, consult
https://electronjs.org/docs/tutorial/security.
This warning will not show up
once the app is packaged.
(anonymous) @ node:electron/js2c/renderer_init:2
node:electron/js2c/renderer_init:2 Electron Security Warning (allowRunningInsecureContent) This renderer process has "allowRunningInsecureContent"
  enabled. This exposes users of this app to severe security risks.

  
For more information and help, consult
https://electronjs.org/docs/tutorial/security.
This warning will not show up
once the app is packaged.
(anonymous) @ node:electron/js2c/renderer_init:2
node:electron/js2c/renderer_init:2 Electron Security Warning (experimentalFeatures) This renderer process has "experimentalFeatures" enabled.
  This exposes users of this app to some security risk. If you do not need
  this feature, you should disable it.

For more information and help, consult
https://electronjs.org/docs/tutorial/security.
This warning will not show up
once the app is packaged.
(anonymous) @ node:electron/js2c/renderer_init:2
node:electron/js2c/renderer_init:2 Electron Security Warning (Insecure Content-Security-Policy) This renderer process has either no Content Security
  Policy set or a policy with "unsafe-eval" enabled. This exposes users of
  this app to unnecessary security risks.

For more information and help, consult
https://electronjs.org/docs/tutorial/security.
This warning will not show up
once the app is packaged.
warnAboutInsecureCSP @ node:electron/js2c/renderer_init:2
VM168:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM169:5 WebGL2 –¥–æ—Å—Ç—É–ø–µ–Ω: true
213.171.18.211/:1 [.WebGL-0000581C0023A900]GL Driver Message (OpenGL, Performance, GL_CLOSE_PATH_NV, High): GPU stall due to ReadPixels
213.171.18.211/:1 [.WebGL-0000581C0023A900]GL Driver Message (OpenGL, Performance, GL_CLOSE_PATH_NV, High): GPU stall due to ReadPixels
213.171.18.211/:1 [.WebGL-0000581C0023A900]GL Driver Message (OpenGL, Performance, GL_CLOSE_PATH_NV, High): GPU stall due to ReadPixels
213.171.18.211/:1 [.WebGL-0000581C0023A900]GL Driver Message (OpenGL, Performance, GL_CLOSE_PATH_NV, High): GPU stall due to ReadPixels (this message will no longer repeat)
VM170:1 [IPC] API Response status: 200
renderer.js:491 Received players data: Object
renderer.js:506 Displaying players: Array(1)
VM171:1 [IPC] API Response: Object
VM172:1 [IPC] Final players: Array(1)
Utils.js:134 [BlueMap/info] Settings loaded!
Utils.js:134 [BlueMap/info] Settings saved!
VM173:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM174:1 [IPC] API Response status: 200
renderer.js:491 Received players data: {players: Array(1), playersWithHeads: Array(1), online: 1, max: 20}
renderer.js:506 Displaying players: [{‚Ä¶}]
VM175:1 [IPC] API Response: {success: true, online: 0, max: 20, players: Array(0)}
VM176:1 [IPC] Final players: ['Angella']
VM177:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM178:1 [IPC] API Response status: 200
renderer.js:491 Received players data: {players: Array(1), playersWithHeads: Array(1), online: 1, max: 20}
renderer.js:506 Displaying players: [{‚Ä¶}]
VM179:1 [IPC] API Response: {success: true, online: 0, max: 20, players: Array(0)}
VM180:1 [IPC] Final players: ['Angella']
VM181:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM182:1 [IPC] API Response status: 200
renderer.js:491 Received players data: {players: Array(1), playersWithHeads: Array(1), online: 1, max: 20}
renderer.js:506 Displaying players: [{‚Ä¶}]
VM183:1 [IPC] API Response: {success: true, online: 0, max: 20, players: Array(0)}
VM184:1 [IPC] Final players: ['Angella']
VM185:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM186:1 [IPC] API Response status: 200
renderer.js:491 Received players data: {players: Array(1), playersWithHeads: Array(1), online: 1, max: 20}
renderer.js:506 Displaying players: [{‚Ä¶}]
VM187:1 [IPC] API Response: {success: true, online: 0, max: 20, players: Array(0)}
VM188:1 [IPC] Final players: ['Angella']
VM189:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM190:1 [IPC] API Response status: 200
renderer.js:491 Received players data: {players: Array(1), playersWithHeads: Array(1), online: 1, max: 20}
renderer.js:506 Displaying players: [{‚Ä¶}]
VM191:1 [IPC] API Response: {success: true, online: 0, max: 20, players: Array(0)}
VM192:1 [IPC] Final players: ['Angella']
VM193:1 [IPC] Requesting API: http://213.171.18.211:30761/api/players
VM194:1 [IPC] API Response status: 200
renderer.js:491 Received players data: {players: Array(1), playersWithHeads: Array(1), online: 1, max: 20}
renderer.js:506 Displaying players: [{‚Ä¶}]
VM195:1 [IPC] API Response: {success: true, online: 0, max: 20, players: Array(0)}
VM196:1 [IPC] Final players: ['Angella']



---

**Cursor**

–≠—Ç–æ –ª–æ–≥–∏ –∏–∑ Electron-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã (BlueMap) –Ω–∞ `http://213.171.18.211:30031/`.

## –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤:

1. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è Electron –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
   - `webSecurity` –æ—Ç–∫–ª—é—á–µ–Ω
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ HTTP (–Ω–µ HTTPS)
   - `allowRunningInsecureContent` –≤–∫–ª—é—á–µ–Ω
   - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã
   - –ù–µ—Ç –∏–ª–∏ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è Content Security Policy
   - –≠—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

2. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è WebGL:
   - `GPU stall due to ReadPixels` ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –ø–∏–∫—Å–µ–ª–µ–π –∏–∑ GPU
   - –û–±—ã—á–Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

3. API –∑–∞–ø—Ä–æ—Å—ã:
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/players` –Ω–∞ –ø–æ—Ä—Ç—É `30761`
   - –û—Ç–≤–µ—Ç—ã —É—Å–ø–µ—à–Ω—ã–µ (status 200)
   - –î–∞–Ω–Ω—ã–µ –æ–± –∏–≥—Ä–æ–∫–∞—Ö –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –í–æ–ø—Ä–æ—Å:

–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è Electron?
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å WebGL?
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –∫–∞—Ä—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–≥—Ä–æ–∫–∞—Ö –≤ Discord-–º–æ–¥–µ?
- –ò–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞?

–£—Ç–æ—á–Ω–∏—Ç–µ –∑–∞–¥–∞—á—É ‚Äî –ø–æ–¥—Å–∫–∞–∂—É, —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ.

---

**User**

–û–¢–ö–ê–¢ –Ø –°–õ–£–ß–ê–ô–ù–æ

---

**Cursor**

–ü—Ä–æ–≤–µ—Ä—è—é —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã, —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.


–≠—Ç–æ –Ω–µ git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –ü—Ä–æ–≤–µ—Ä—è—é, —á—Ç–æ –º–æ–≥–ª–æ –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω–æ. –°–º–æ—Ç—Ä—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:


